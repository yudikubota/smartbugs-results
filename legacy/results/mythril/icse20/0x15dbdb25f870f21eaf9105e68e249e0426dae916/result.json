{
  "contract": "0x15dbdb25f870f21eaf9105e68e249e0426dae916",
  "tool": "mythril",
  "start": 1563535062.6075745,
  "end": 1563535620.437607,
  "duration": 557.8300325870514,
  "analysis": {
    "error": null,
    "issues": [
      {
        "address": 815,
        "code": "   {\n        chargeForImagePlacement();\n        numImages++;\n        for (uint8 ix=fromX; ix<=toX; ix++) {\n            for (uint8 iy=fromY; iy<=toY; iy++) {\n                assignImageID (ix, iy, numImages);\n            }\n        }\n        images[numImages].fromX = fromX;\n        images[numImages].fromY = fromY;\n        images[numImages].toX = toX;\n        images[numImages].toY = toY;\n        images[numImages].imageSourceUrl = imageSourceUrl;\n        images[numImages].adUrl = adUrl;\n        images[numImages].adText = adText;\n        NewImage(numImages, fromX, fromY, toX, toY, imageSourceUrl, adUrl, adText);\n        return numImages;\n    }\n\n\n\n\n\n// ** PAYOUTS ** //\n\n    // reward the chain of referrals, admin and charity\n    function payOut (uint _amount, address referal) private {\n        address iUser = referal;\n        address nextUser;\n        uint totalPayed = 0;\n        for (uint8 i = 1; i < 7; i++) {                 // maximum 6 handshak",
        "debug": "calldata_MillionEther_32 + 100: 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc\ncalldata_MillionEther_0: 0x59ae6e3400000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\n",
        "description": "A possible integer overflow exists in the function `_function_0x59ae6e34`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x59ae6e34",
        "lineno": 294,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 2927,
        "code": "sg.sender].investments;\n            uint availa",
        "debug": "storage_1 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\nUDiv(256*\n_____Concat(0,\n____________Extract(159,_0,_calldata_MillionEther_32_+_4))_|\n_____Concat(Extract(255,_168,_storage_30612),\n____________0,\n____________Extract(7,_0,_storage_30612)),\n_____256): 0xa8795cd3fffffffffffffffffffffffffffffffffffffffffffffffffffffffe\nstorage_30611: 0x57f25cd000000000000000000000000000000000000000000000000000000000\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_32_+_4: 0xffffffffffffffffffffffffffffffffffffffff00\ncalldata_MillionEther_32 + 4: 0xffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_4: 0xffffffff\nstorage_0: 0x0\ncaller: 0x0\ncalldata_MillionEther_0: 0xe6b0afc00000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A possible integer overflow exists in the function `_function_0x0e6b0afc`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x0e6b0afc",
        "lineno": 488,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 3167,
        "debug": "storage_5 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x72a020b5ffffefc9d2ffffffffffff7f7dffb113b13ac2ea6c284ae6add8669c\nstorage_30612: 0x6c00\nstorage_4 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_30614: 0xff00\ncalldata_MillionEther_0: 0x16bfe25c00000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A possible integer overflow exists in the function `_function_0x16bfe25c`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x16bfe25c",
        "lineno": 503,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 3398,
        "debug": "",
        "description": "A possible transaction order independence vulnerability exists in function _function_0x16bfe25c. The value or direction of the call statement is determined from a tainted storage location",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x16bfe25c",
        "lineno": 503,
        "title": "Transaction order dependence",
        "type": "Warning"
      },
      {
        "address": 3858,
        "code": "   if (users[msg.",
        "debug": "calldata_MillionEther_32 + 68: 0x62\nstorage_5: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_32 + 36: 0x2\ncalldata_MillionEther_32 + 100: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_32 + 4: 0x80\ncalldata_MillionEther_4: 0x1\nstorage_30614: 0x0\nstorage_0: 0x0\ncaller: 0xffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_0: 0x35e49e5f00000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A possible integer overflow exists in the function `_function_0x35e49e5f`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x35e49e5f",
        "lineno": 270,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 4385,
        "code": "<=toX; ix",
        "debug": "The exception is triggered under the following conditions:\n\ncalldata_MillionEther_4: 0x65\ncalldata_MillionEther_0: 0x4abfbbe300000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A reachable exception (opcode 0xfe) has been detected. This can be caused by type errors, division by zero, out-of-bounds array access, or assert violations. This is acceptable in most situations. Note however that `assert()` should only be used to check invariants. Use `require()` for regular input checking. ",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "getBlockInfo(uint8,uint8)",
        "lineno": 408,
        "title": "Exception state",
        "type": "Informational"
      },
      {
        "address": 4406,
        "code": "<=toX; ix++)",
        "debug": "The exception is triggered under the following conditions:\n\ncalldata_MillionEther_32 + 4: 0x65\ncalldata_MillionEther_4: 0x64\ncalldata_MillionEther_0: 0x4abfbbe300000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A reachable exception (opcode 0xfe) has been detected. This can be caused by type errors, division by zero, out-of-bounds array access, or assert violations. This is acceptable in most situations. Note however that `assert()` should only be used to check invariants. Use `require()` for regular input checking. ",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "getBlockInfo(uint8,uint8)",
        "lineno": 408,
        "title": "Exception state",
        "type": "Informational"
      },
      {
        "address": 4855,
        "code": " = toX;\n   ",
        "debug": "storage_30609: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_32 + 36: 0x0\ncalldata_MillionEther_32 + 68: 0x0\nstorage_1 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\nstorage_30615: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\ncallvalue: 0x0\ncalldata_MillionEther_32 + 4: 0x1\ncalldata_MillionEther_4: 0x1\nstorage_2 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_30614: 0x0\nstorage_0: 0x0\ncaller: 0xffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_0: 0x59ae6e3400000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\n",
        "description": "A possible integer overflow exists in the function `_function_0x59ae6e34`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x59ae6e34",
        "lineno": 304,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 8113,
        "code": "ool banned,\n        uint userID",
        "debug": "",
        "description": "A possible transaction order independence vulnerability exists in function _function_0x853828b6. The value or direction of the call statement is determined from a tainted storage location",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x853828b6",
        "lineno": 365,
        "title": "Transaction order dependence",
        "type": "Warning"
      },
      {
        "address": 8744,
        "code": "er].refera",
        "debug": "storage_1: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\ntimestamp: 0x0\nstorage_2 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0x0\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0xffffffffffffffffffffffffffffffffffffffff00\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_30614: 0x0\nstorage_0: 0x0\ncaller: 0xffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_0: 0x8fa9e55c00000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A possible integer overflow exists in the function `_function_0x8fa9e55c`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x8fa9e55c",
        "lineno": 160,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 11600,
        "code": "    {\n        blocks[x][y].imageID = _imageID;\n    }\n\n  ",
        "debug": "storage_1 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\nUDiv(storage_0,_256): 0xbebe78fe7648b7ffc4a08494327bfbf891858078f4851252ad436efb6a7ebbdb\nstorage_30615: 0xb0a178818202c80020218108453f173b55860d7e5c0d54542c6740424440a21b\ncalldata_MillionEther_32 + 36: 0xc\ncalldata_MillionEther_32 + 68: 0x4\nstorage_1 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0xe3e07e8f9fe1c82013f1cf071cfbff403f30e7efeda64dfcf5efafd7ec0e3f7e\ncallvalue: 0x0\ncalldata_MillionEther_32 + 4: 0x1\ncalldata_MillionEther_4: 0x1\nstorage_2 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_30614: 0x0\nstorage_0: 0x0\ncaller: 0xffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_0: 0x59ae6e3400000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\n",
        "description": "A possible integer overflow exists in the function `_function_0x59ae6e34`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x59ae6e34",
        "lineno": 282,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 13066,
        "code": "       returns ",
        "debug": "storage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0xff00\ntimestamp: 0x0\nstorage_2 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0x0\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_0: 0x0\ncaller: 0x0\ncalldata_MillionEther_0: 0x8fa9e55c00000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A possible integer underflow exists in the function `_function_0x8fa9e55c`.\nThe subtraction may result in a value < 0.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x8fa9e55c",
        "lineno": 155,
        "title": "Integer Underflow",
        "type": "Warning"
      },
      {
        "address": 13071,
        "code": "InvitedBy (referal) \n        returns (u",
        "debug": "2_EXP_115792089237316195423570985008687907853269984665640564039457584007913129639935 +\nConcat(0,\n       1 +\n       Extract(15,\n               8,\n               storage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4)): 0xf7741b28df9b526f248aa8fd66a7ff9ffffcffa7d1ffffe7ff51d1e9f271dfe7\nstorage_30614: 0xcbdc943000\ntimestamp: 0x0\nstorage_2 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0x0\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0xffffffffffffffffffffffffffffffffffffffff00\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_0: 0x0\ncaller: 0x0\ncalldata_MillionEther_0: 0x8fa9e55c00000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A possible integer overflow exists in the function `_function_0x8fa9e55c`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x8fa9e55c",
        "lineno": 154,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 13073,
        "code": "lyWhenInvitedBy (referal) \n        returns (u",
        "debug": "timestamp: 0x55393d322ce3e50bf375faee084b03eb10a00c0080022c0004efe782640e3f70\n2_EXP_115792089237316195423570985008687907853269984665640564039457584007913129639935 +\nConcat(0,\n       1 +\n       Extract(15,\n               8,\n               storage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4)): 0xa93a6d2ba6b280d74d960243e4cec1e65b568a9a250cf72beff9007b38020f4f\nstorage_30614: 0x864b8a6300\nstorage_2 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0x8512509100\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncalldata_MillionEther_4: 0xffffffffffffffffffffffffffffffffffffffff00\nstorage_0 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_0: 0x0\ncaller: 0x0\ncalldata_MillionEther_0: 0x8fa9e55c00000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\ncallvalue: 0x0\n",
        "description": "A possible integer overflow exists in the function `_function_0x8fa9e55c`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x8fa9e55c",
        "lineno": 154,
        "title": "Integer Overflow ",
        "type": "Warning"
      },
      {
        "address": 13378,
        "code": "er {\n\n    address private admin;\n\n    // Users\n    uint private numUsers = 0;\n    struct User {\n        address referal;\n        uint8 handshakes;\n        uint balance;\n        uint32 activationTime;\n        bool banned;\n        uint userID;\n        bool refunded;\n        uint investments;\n    }\n    mapping(address => User) private users;\n    mapping(uint => address) private userAddrs;\n\n    // Blocks. Blocks are 10x10 pixel areas. There are 10 000 blocks.\n    uint16 private blocksSold = 0;\n    uint private numNewStatus = 0;\n    struct Block {\n        address landlord;\n        uint imageID;\n        uint sellPrice;\n    }\n    Block[101][101] private blocks; \n\n    // Images\n    uint private numImages = 0;\n    struct Image {\n        uint8 fromX;\n        uint8 fromY;\n        uint8 toX;\n        uint8 toY;\n        string imageSourceUrl;\n        string adUrl;\n        string adText;\n    }\n    mapping(uint => Image) private images;\n\n    // Contract settings and security\n    uint public charityBalance = 0;\n    address public charityAddress;\n    uint8 private refund_percent = 0;\n    uint private totalWeiInvested = 0; //1 024 000 Ether max\n    bool private setting_stopped = false;\n    bool private setting_refundMode = false;\n    uint32 private setting_delay = 3600;\n    uint private setting_imagePlacementPriceInWei = 0;\n\n    // Events\n    event NewUser(uint ID, address newUser, address invitedBy, uint32 activationTime);\n    event NewAreaStatus (uint ID, uint8 fromX, uint8 fromY, uint8 toX, uint8 toY, uint price);\n    event NewImage(uint ID, uint8 fromX, uint8 fromY, uint8 toX, uint8 toY, string imageSourceUrl, string adUrl, string adText);\n\n\n// ** INITIALIZE ** //\n\n    function MillionEther () {\n        admin = msg.sender;\n        users[admin].referal = admin;\n        users[admin].handshakes = 0;\n        users[admin].activationTime = uint32(now);\n        users[admin].userID = 0;\n        userAddrs[0] = admin;\n        userAddrs[numUsers] = admin;\n    }\n\n\n// ** FUNCTION MODIFIERS (PERMISSIONS) ** //\n\n    modifier onlyAdmin {\n        if (msg.sender != admin) throw;\n        _;\n    }\n\n    modifier onlyWhenInvitedBy (address someUser) {\n        if (users[msg.sender].referal != address(0x0)) throw;   //user already exists\n        if (users[someUser].referal == address(0x0)) throw;     //referral does not exist\n        if (now < users[someUser].activationTime) throw;        //referral is not active yet\n        _;\n    }\n\n    modifier onlySignedIn {\n        if (users[msg.sender].referal == address(0x0)) throw;   //user does not exist\n        _;\n    }\n\n    modifier onlyForSale (uint8 _x, uint8 _y) {\n        if (blocks[_x][_y].landlord != address(0x0) && blocks[_x][_y].sellPrice == 0) throw;\n        _;\n    }\n\n    modifier onlyWithin100x100Area (uint8 _fromX, uint8 _fromY, uint8 _toX, uint8 _toY) {\n        if ((_fromX < 1) || (_fromY < 1)  || (_toX > 100) || (_toY > 100)) throw;\n        _;\n    }    \n\n    modifier onlyByLandlord (uint8 _x, uint8 _y) {\n        if (msg.sender != admin) {\n            if (blocks[_x][_y].landlord != msg.sender) throw;\n        }\n        _;\n    }\n\n    modifier noBannedUsers {\n        if (users[msg.sender].banned == true) throw;\n        _;\n    }\n\n    modifier stopInEmergency { \n        if (msg.sender != admin) {\n            if (setting_stopped) throw; \n        }\n        _;\n    }\n\n    modifier onlyInRefundMode { \n        if (!setting_refundMode) throw;\n        _;\n    }\n\n\n// ** USER SIGN IN ** //\n\n    function getActivationTime (uint _currentLevel, uint _setting_delay) private constant returns (uint32) {\n        return uint32(now + _setting_delay * (2**(_currentLevel-1)));\n    }\n\n    function signIn (address referal) \n        public \n        stopInEmergency ()\n        onlyWhenInvitedBy (referal) \n        returns (uint) \n    {\n        numUsers++;\n        // get user's referral handshakes and increase by one\n        uint8 currentLevel = users[referal].handshakes + 1;\n        users[msg.sender].referal = referal;\n        users[msg.sender].handshakes = currentLevel;\n        // 1,2,4,8,16,32,64 hours for activation depending on number of handshakes (if setting delay = 1 hour)\n        users[msg.sender].activationTime = getActivationTime (currentLevel, setting_delay); \n        users[msg.sender].refunded = false;\n        users[msg.sender].userID = numUsers;\n        userAddrs[numUsers] = msg.sender;\n        NewUser(numUsers, msg.sender, referal, users[msg.sender].activationTime);\n        return numUsers;\n    }\n\n\n // ** BUY AND SELL BLOCKS ** //\n\n    function getBlockPrice (uint8 fromX, uint8 fromY, uint blocksSold) private constant returns (uint) {\n        if (blocks[fromX][fromY].landlord == address(0x0)) { \n                // when buying at initial sale price doubles every 1000 blocks sold\n                return 1 ether * (2 ** (blocksSold/1000));\n            } else {\n                // when the block is already bought and landlord have set a sell price\n                return blocks[fromX][fromY].sellPrice;\n            }\n        }\n\n    function buyBlock (uint8 x, uint8 y) \n        private  \n        onlyForSale (x, y) \n        returns (uint)\n    {\n        uint blockPrice;\n        blockPrice = getBlockPrice(x, y, blocksSold);\n        // Buy at initial sale\n        if (blocks[x][y].landlord == address(0x0)) {\n            blocksSold += 1;  \n            totalWeiInvested += blockPrice;\n        // Buy from current landlord and pay him or her the blockPrice\n        } else {\n            users[blocks[x][y].landlord].balance += blockPrice;  \n        }\n        blocks[x][y].landlord = msg.sender;\n        return blockPrice;\n    }\n\n    // buy an area of blocks at coordinates [fromX, fromY, toX, toY]\n    function buyBlocks (uint8 fromX, uint8 fromY, uint8 toX, uint8 toY) \n        public\n        payable\n        stopInEmergency ()\n        onlySignedIn () \n        onlyWithin100x100Area (fromX, fromY, toX, toY)\n        returns (uint) \n    {   \n        // Put funds to buyerBalance\n        if (users[msg.sender].balance + msg.value < users[msg.sender].balance) throw; //checking for overflow\n        uint previousWeiInvested = totalWeiInvested;\n        uint buyerBalance = users[msg.sender].balance + msg.value;\n\n        // perform buyBlock for coordinates [fromX, fromY, toX, toY] and withdraw funds\n        uint purchasePrice;\n        for (uint8 ix=fromX; ix<=toX; ix++) {\n            for (uint8 iy=fromY; iy<=toY; iy++) {\n                purchasePrice = buyBlock (ix,iy);\n                if (buyerBalance < purchasePrice) throw;\n                buyerBalance -= purchasePrice;\n            }\n        }\n        // update user balance\n        users[msg.sender].balance = buyerBalance;\n        // user's total investments are used for refunds calculations in emergency\n        users[msg.sender].investments += totalWeiInvested - previousWeiInvested;\n        // pay rewards to the referral chain starting from the current user referral\n        payOut (totalWeiInvested - previousWeiInvested, users[msg.sender].referal);\n        numNewStatus += 1;\n        // fire new area status event (0 sell price means the area is not for sale)\n        NewAreaStatus (numNewStatus, fromX, fromY, toX, toY, 0);\n        return purchasePrice;\n    }\n\n\n    //Mark block for sale (set a sell price)\n    function sellBlock (uint8 x, uint8 y, uint sellPrice) \n        private\n        onlyByLandlord (x, y) \n    {\n        blocks[x][y].sellPrice = sellPrice;\n    }\n\n    // sell an area of blocks at coordinates [fromX, fromY, toX, toY]\n    function sellBlocks (uint8 fromX, uint8 fromY, uint8 toX, uint8 toY, uint priceForEachBlockInWei) \n        public \n        stopInEmergency ()\n        onlyWithin100x100Area (fromX, fromY, toX, toY) \n        returns (bool) \n    {\n        if (priceForEachBlockInWei == 0) throw;\n        for (uint8 ix=fromX; ix<=toX; ix++) {\n            for (uint8 iy=fromY; iy<=toY; iy++) {\n                sellBlock (ix, iy, priceForEachBlockInWei);\n            }\n        }\n        numNewStatus += 1;\n        // fire NewAreaStatus event\n        NewAreaStatus (numNewStatus, fromX, fromY, toX, toY, priceForEachBlockInWei);\n        return true;\n    }\n\n\n// ** ASSIGNING IMAGES ** //\n    \n    function chargeForImagePlacement () private {\n        if (users[msg.sender].balance + msg.value < users[msg.sender].balance) throw; //check for overflow`\n        uint buyerBalance = users[msg.sender].balance + msg.value;\n        if (buyerBalance < setting_imagePlacementPriceInWei) throw;\n        buyerBalance -= setting_imagePlacementPriceInWei;\n        users[admin].balance += setting_imagePlacementPriceInWei;\n        users[msg.sender].balance = buyerBalance;\n    }\n\n    // every block has its own image id assigned\n    function assignImageID (uint8 x, uint8 y, uint _imageID) \n        private\n        onlyByLandlord (x, y) \n    {\n        blocks[x][y].imageID = _imageID;\n    }\n\n    // place new ad to user owned area\n    function placeImage (uint8 fromX, uint8 fromY, uint8 toX, uint8 toY, string imageSourceUrl, string adUrl, string adText) \n        public \n        payable\n        stopInEmergency ()\n        noBannedUsers ()\n        onlyWithin100x100Area (fromX, fromY, toX, toY)\n        returns (uint) \n    {\n        chargeForImagePlacement();\n        numImages++;\n        for (uint8 ix=fromX; ix<=toX; ix++) {\n            for (uint8 iy=fromY; iy<=toY; iy++) {\n                assignImageID (ix, iy, numImages);\n            }\n        }\n        images[numImages].fromX = fromX;\n        images[numImages].fromY = fromY;\n        images[numImages].toX = toX;\n        images[numImages].toY = toY;\n        images[numImages].imageSourceUrl = imageSourceUrl;\n        images[numImages].adUrl = adUrl;\n        images[numImages].adText = adText;\n        NewImage(numImages, fromX, fromY, toX, toY, imageSourceUrl, adUrl, adText);\n        return numImages;\n    }\n\n\n\n\n\n// ** PAYOUTS ** //\n\n    // reward the chain of referrals, admin and charity\n    function payOut (uint _amount, address referal) private {\n        address iUser = referal;\n        address nextUser;\n        uint totalPayed = 0;\n        for (uint8 i = 1; i < 7; i++) {                 // maximum 6 handshakes from the buyer \n            users[iUser].balance += _amount / (2**i);   // with every handshake far from the buyer reward halves:\n            totalPayed += _amount / (2**i);             // 50%, 25%, 12.5%, 6.25%, 3.125%, 1.5625%\n            if (iUser == admin) { break; }              // breaks at admin\n            nextUser = users[iUser].referal;\n            iUser = nextUser;\n        }\n        goesToCharity(_amount - totalPayed);            // the rest goes to charity\n    }\n\n    // charity is the same type of user as everyone else\n    function goesToCharity (uint amount) private {\n        // if no charityAddress is set yet funds go to charityBalance (see further)\n        if (charityAddress == address(0x0)) {\n            charityBalance += amount;\n        } else {\n            users[charityAddress].balance += amount;\n        }\n    }\n\n    // withdraw funds (no external calls for safety)\n    function withdrawAll () \n        public\n        stopInEmergency () \n    {\n        uint withdrawAmount = users[msg.sender].balance;\n        users[msg.sender].balance = 0;\n        if (!msg.sender.send(withdrawAmount)) {\n            users[msg.sender].balance = withdrawAmount;\n        }\n    }\n\n\n // ** GET INFO (CONSTANT FUNCTIONS)** //\n\n    //USERS\n    function getUserInfo (address userAddress) public constant returns (\n        address referal,\n        uint8 handshakes,\n        uint balance,\n        uint32 activationTime,\n        bool banned,\n        uint userID,\n        bool refunded,\n        uint investments\n    ) {\n        referal = users[userAddress].referal; \n        handshakes = users[userAddress].handshakes; \n        balance = users[userAddress].balance; \n        activationTime = users[userAddress].activationTime; \n        banned = users[userAddress].banned; \n        userID = users[userAddress].userID;\n        refunded = users[userAddress].refunded; \n        investments = users[userAddress].investments;\n    }\n\n    function getUserAddressByID (uint userID) \n        public constant returns (address userAddress) \n    {\n        return userAddrs[userID];\n    }\n    \n    function getMyInfo() \n        public constant returns(uint balance, uint32 activationTime) \n    {   \n        return (users[msg.sender].balance, users[msg.sender].activationTime);\n    }\n\n    //BLOCKS\n    function getBlockInfo(uint8 x, uint8 y) \n        public constant returns (address landlord, uint imageID, uint sellPrice) \n    {\n        return (blocks[x][y].landlord, blocks[x][y].imageID, blocks[x][y].sellPrice);\n    }\n\n    function getAreaPrice (uint8 fromX, uint8 fromY, uint8 toX, uint8 toY)\n        public\n        constant\n        onlyWithin100x100Area (fromX, fromY, toX, toY)\n        returns (uint) \n    {\n        uint blockPrice;\n        uint totalPrice = 0;\n        uint16 iblocksSold = blocksSold;\n        for (uint8 ix=fromX; ix<=toX; ix++) {\n            for (uint8 iy=fromY; iy<=toY; iy++) {\n                blockPrice = getBlockPrice(ix,iy,iblocksSold);\n                if (blocks[ix][iy].landlord == address(0x0)) { \n                        iblocksSold += 1; \n                    }\n                if (blockPrice == 0) { \n                    return 0; // not for sale\n                    } \n                totalPrice += blockPrice;\n            }\n        }\n        return totalPrice;\n    }\n\n    //IMAGES\n    function getImageInfo(uint imageID) \n        public constant returns (uint8 fromX, uint8 fromY, uint8 toX, uint8 toY, string imageSourceUrl, string adUrl, string adText)\n    {\n        Image i = images[imageID];\n        return (i.fromX, i.fromY, i.toX, i.toY, i.imageSourceUrl, i.adUrl, i.adText);\n    }\n\n    //CONTRACT STATE\n    function getStateInfo () public constant returns (\n        uint _numUsers, \n        uint16 _blocksSold, \n        uint _totalWeiInvested, \n        uint _numImages, \n        uint _setting_imagePlacementPriceInWei,\n        uint _numNewStatus,\n        uint32 _setting_delay\n    ){\n        return (numUsers, blocksSold, totalWeiInvested, numImages, setting_imagePlacementPriceInWei, numNewStatus, setting_delay);\n    }\n\n\n// ** ADMIN ** //\n\n    function adminContractSecurity (address violator, bool banViolator, bool pauseContract, bool refundInvestments)\n        public \n        onlyAdmin () \n    {\n        //freeze/unfreeze user\n        if (violator != address(0x0)) {\n            users[violator].banned = banViolator;\n        }\n        //pause/resume contract \n        setting_stopped = pauseContract;\n\n        //terminate contract, refund investments\n        if (refundInvestments) {\n            setting_refundMode = refundInvestments;\n            refund_percent = uint8((this.balance*100)/totalWeiInvested);\n        }\n    }\n\n    function adminContractSettings (uint32 newDelayInSeconds, address newCharityAddress, uint newImagePlacementPriceInWei)\n        public \n        onlyAdmin () \n    {   \n        // setting_delay affects user activation time.\n        if (newDelayInSeconds > 0) setting_delay = newDelayInSeconds;\n        // when the charityAddress is set charityBalance immediately transfered to it's balance \n        if (newCharityAddress != address(0x0)) {\n            if (users[newCharityAddress].referal == address(0x0)) throw;\n            charityAddress = newCharityAddress;\n            users[charityAddress].balance += charityBalance;\n            charityBalance = 0;\n        }\n        // at deploy is set to 0, but may be needed to support off-chain infrastructure\n        setting_imagePlacementPriceInWei = newImagePlacementPriceInWei;\n    }\n\n    // escape path - withdraw funds at emergency.\n    function emergencyRefund () \n        public\n        onlyInRefundMode () \n    {\n        if (!users[msg.sender].refunded) {\n            uint totalInvested = users[msg.sender].investments;\n            uint availableForRefund = (totalInvested*refund_percent)/100;\n            users[msg.sender].investments -= availableForRefund;\n            users[msg.sender].refunded = true;\n            if (!msg.sender.send(availableForRefund)) {\n                users[msg.sender].investments = totalInvested;\n                users[msg.sender].refunded = false;\n            }\n        }\n    }\n\n    function () {\n        throw;\n    }\n\n}",
        "debug": "calldata_MillionEther_4 + calldata_MillionEther_32 + 100: 0x8000000000000000000000000000000000000000000000000000000000000000\ncalldata_MillionEther_32 + 36: 0x0\ncalldata_MillionEther_32 + 68: 0x0\nstorage_1 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\nstorage_30615: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\ncallvalue: 0x0\ncalldata_MillionEther_32 + 4: 0x1\ncalldata_MillionEther_4: 0x1\nstorage_2 +\nkeccac_1461501637330902918203684832716283019655932542975_&\n1461501637330902918203684832716283019655932542975_&\ncaller: 0x0\nstorage_30614: 0x0\nstorage_0: 0x0\ncaller: 0xffffffffffffffffffffffffffffffffffffffff\ncalldata_MillionEther_0: 0x59ae6e3400000000000000000000000000000000000000000000000000000000\ncalldatasize_MillionEther: 0x4\n",
        "description": "A possible integer overflow exists in the function `_function_0x59ae6e34`.\nThe addition or multiplication may result in a value higher than the maximum representable integer.",
        "filename": "/unique_chucks/10/0x15dbdb25f870f21eaf9105e68e249e0426dae916.sol",
        "function": "_function_0x59ae6e34",
        "lineno": 20,
        "title": "Integer Overflow ",
        "type": "Warning"
      }
    ],
    "success": true
  }
}