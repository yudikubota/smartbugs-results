/unique_chucks/2/0xa5cc679a3528956e8032df4f03756c077c1ee3f4.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 183
column: 43
content: referrerAddress=address(0)

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 202
column: 43
content: referrerAddress=address(0)

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 214
column: 8
content: tokens[address(0)]

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 214
column: 49
content: tokens[address(0)]

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 239
column: 8
content: tokens[address(0)]

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 241
column: 8
content: tokens[address(0)]

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 241
column: 49
content: tokens[address(0)]

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 548
column: 8
content: tokens[address(0)]

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 548
column: 57
content: tokens[address(0)]

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 184
column: 44
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 185
column: 43
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 203
column: 44
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 204
column: 43
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 239
column: 58
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 365
column: 36
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 367
column: 36
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 383
column: 40
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 384
column: 40
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 389
column: 39
content: 0x0

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 41
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 75
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 134
column: 30
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 173
column: 56
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 178
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 197
column: 66
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 220
column: 96
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 221
column: 48
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 224
column: 42
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 226
column: 60
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 233
column: 29
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 235
column: 93
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 237
column: 42
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 245
column: 36
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 247
column: 54
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 35
column: 4
content: functionisTokenInList(addresstokenAddress)publicconstantreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 253
column: 4
content: functionbalanceOf(addresstoken,addressuser)constantreturns(uint256){returntokens[token][user];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 482
column: 8
content: for(uinti=0;i<tradeAddresses.length;i++){trade(v[i],rs[i],tradeValues[i],tradeAddresses[i]);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 219
column: 4
content: functionwithdraw(addresstoken,uint256amount)returns(boolsuccess){if(safeSub(block.number,lastActiveTransaction[msg.sender])<inactivityReleasePeriod)throw;if(tokens[token][msg.sender]<amount)throw;tokens[token][msg.sender]=safeSub(tokens[token][msg.sender],amount);if(token==address(0)){if(!msg.sender.send(amount))throw;}else{if(!Token(token).transfer(msg.sender,amount))throw;}Withdraw(token,msg.sender,amount,tokens[token][msg.sender],0);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 231
column: 4
content: functionadminWithdraw(addresstoken,uint256amount,addressuser,uint256nonce,uint8v,bytes32r,bytes32s,uint256feeWithdrawal)onlyAdminreturns(boolsuccess){bytes32hash=keccak256(this,token,amount,user,nonce);if(withdrawn[hash])throw;withdrawn[hash]=true;if(ecrecover(keccak256("\x19Ethereum Signed Message:\n32",hash),v,r,s)!=user)throw;if(feeWithdrawal>50finney)feeWithdrawal=50finney;if(tokens[token][user]<amount)throw;tokens[token][user]=safeSub(tokens[token][user],amount);tokens[address(0)][user]=safeSub(tokens[address(0x0)][user],feeWithdrawal);tokens[address(0)][feeAccount]=safeAdd(tokens[address(0)][feeAccount],feeWithdrawal);if(token==address(0)){if(!user.send(amount))throw;}else{if(!Token(token).transfer(user,amount))throw;}lastActiveTransaction[user]=block.number;Withdraw(token,user,amount,tokens[token][user],feeWithdrawal);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 482
column: 8
content: for(uinti=0;i<tradeAddresses.length;i++){trade(v[i],rs[i],tradeValues[i],tradeAddresses[i]);}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 67
column: 4
content: functionsetOwner(addressnewOwner)onlyOwner{SetOwner(owner,newOwner);owner=newOwner;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 156
column: 4
content: functionsetFees(uint256makerFee_,uint256takerFee_,uint256affiliateFee_)onlyOwner{require(makerFee_<10finney&&takerFee_<10finney);require(affiliateFee_>affiliateFee);makerFee=makerFee_;takerFee=takerFee_;affiliateFee=affiliateFee_;makerAffiliateFee=safeMul(makerFee,affiliateFee_)/(1ether);takerAffiliateFee=safeMul(takerFee,affiliateFee_)/(1ether);FeeChange(makerFee,takerFee,affiliateFee_);}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 168
column: 4
content: functionsetAdmin(addressadmin,boolisAdmin)onlyOwner{admins[admin]=isAdmin;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 177
column: 24
content: {throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 41
column: 8
content: if(!assertion)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 75
column: 8
content: if(nonce<invalidOrder[user])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 134
column: 8
content: if(expiry>1000000)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 173
column: 8
content: if(msg.sender!=owner&&!admins[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 197
column: 8
content: if(!Token(token).transferFrom(msg.sender,this,amount))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 220
column: 8
content: if(safeSub(block.number,lastActiveTransaction[msg.sender])<inactivityReleasePeriod)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 221
column: 8
content: if(tokens[token][msg.sender]<amount)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 224
column: 12
content: if(!msg.sender.send(amount))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 226
column: 12
content: if(!Token(token).transfer(msg.sender,amount))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 233
column: 8
content: if(withdrawn[hash])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 235
column: 8
content: if(ecrecover(keccak256("\x19Ethereum Signed Message:\n32",hash),v,r,s)!=user)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 237
column: 8
content: if(tokens[token][user]<amount)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 245
column: 12
content: if(!user.send(amount))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 247
column: 12
content: if(!Token(token).transfer(user,amount))throw;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 232
column: 23
content: keccak256(this,token,amount,user,nonce)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 235
column: 22
content: keccak256("\x19Ethereum Signed Message:\n32",hash)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 331
column: 30
content: keccak256(this,tradeAddresses[0],tradeValues[0],tradeAddresses[1],tradeValues[1],tradeValues[2],tradeAddresses[2])

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 332
column: 30
content: keccak256(this,tradeAddresses[3],tradeValues[3],tradeAddresses[4],tradeValues[4],tradeValues[5],tradeAddresses[5])

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 337
column: 22
content: keccak256("\x19Ethereum Signed Message:\n32",t.makerOrderHash)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 344
column: 22
content: keccak256("\x19Ethereum Signed Message:\n32",t.takerOrderHash)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 525
column: 28
content: keccak256(this,cancelAddresses[0],cancelValues[0],cancelAddresses[1],cancelValues[1],cancelValues[2],cancelAddresses[2])

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 529
column: 26
content: keccak256("\x19Ethereum Signed Message:\n32",orderHash)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 532
column: 29
content: keccak256(this,orderHash,cancelAddresses[3],cancelValues[3])

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 533
column: 26
content: keccak256("\x19Ethereum Signed Message:\n32",cancelHash)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 31
column: 61
content: address[]

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 12
column: 4
content: functiontransfer(address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 13
column: 4
content: functionapproveAndCall(address_spender,uint256_value,bytes_extraData)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 14
column: 4
content: functionapprove(address_spender,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 15
column: 4
content: functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 25
column: 4
content: functionsetOwner(addressnewOwner);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 29
column: 4
content: functiongetAffiliateCount()returns(uint);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 40
column: 4
content: functionassert(boolassertion){if(!assertion)throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 43
column: 4
content: functionsafeMul(uinta,uintb)returns(uint){uintc=a*b;assert(a==0||c/a==b);returnc;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 49
column: 4
content: functionsafeSub(uinta,uintb)returns(uint){assert(b<=a);returna-b;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 54
column: 4
content: functionsafeAdd(uinta,uintb)returns(uint){uintc=a+b;assert(c>=a&&c>=b);returnc;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 67
column: 4
content: functionsetOwner(addressnewOwner)onlyOwner{SetOwner(owner,newOwner);owner=newOwner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 71
column: 4
content: functiongetOwner()returns(addressout){returnowner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 74
column: 4
content: functioninvalidateOrdersBefore(addressuser,uint256nonce)onlyAdmin{if(nonce<invalidOrder[user])throw;invalidOrder[user]=nonce;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 133
column: 4
content: functionsetInactivityReleasePeriod(uint256expiry)onlyAdminreturns(boolsuccess){if(expiry>1000000)throw;inactivityReleasePeriod=expiry;returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 139
column: 4
content: functionExchange(addressfeeAccount_,uint256makerFee_,uint256takerFee_,uint256affiliateFee_,addressaffiliateContract_,addresstokenListContract_){owner=msg.sender;feeAccount=feeAccount_;inactivityReleasePeriod=100000;makerFee=makerFee_;takerFee=takerFee_;affiliateFee=affiliateFee_;makerAffiliateFee=safeMul(makerFee,affiliateFee_)/(1ether);takerAffiliateFee=safeMul(takerFee,affiliateFee_)/(1ether);affiliateContract=affiliateContract_;tokenListContract=tokenListContract_;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 156
column: 4
content: functionsetFees(uint256makerFee_,uint256takerFee_,uint256affiliateFee_)onlyOwner{require(makerFee_<10finney&&takerFee_<10finney);require(affiliateFee_>affiliateFee);makerFee=makerFee_;takerFee=takerFee_;affiliateFee=affiliateFee_;makerAffiliateFee=safeMul(makerFee,affiliateFee_)/(1ether);takerAffiliateFee=safeMul(takerFee,affiliateFee_)/(1ether);FeeChange(makerFee,takerFee,affiliateFee_);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 168
column: 4
content: functionsetAdmin(addressadmin,boolisAdmin)onlyOwner{admins[admin]=isAdmin;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 181
column: 4
content: functiondepositToken(addresstoken,uint256amount,addressreferrerAddress){if(referrerAddress==msg.sender)referrerAddress=address(0);if(referrer[msg.sender]==address(0x0)){if(referrerAddress!=address(0x0)&&EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender)==address(0)){referrer[msg.sender]=referrerAddress;EthermiumAffiliates(affiliateContract).assignReferral(referrerAddress,msg.sender);}else{referrer[msg.sender]=EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender);}}tokens[token][msg.sender]=safeAdd(tokens[token][msg.sender],amount);lastActiveTransaction[msg.sender]=block.number;if(!Token(token).transferFrom(msg.sender,this,amount))throw;Deposit(token,msg.sender,amount,tokens[token][msg.sender],referrer[msg.sender]);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 201
column: 4
content: functiondeposit(addressreferrerAddress)payable{if(referrerAddress==msg.sender)referrerAddress=address(0);if(referrer[msg.sender]==address(0x0)){if(referrerAddress!=address(0x0)&&EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender)==address(0)){referrer[msg.sender]=referrerAddress;EthermiumAffiliates(affiliateContract).assignReferral(referrerAddress,msg.sender);}else{referrer[msg.sender]=EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender);}}tokens[address(0)][msg.sender]=safeAdd(tokens[address(0)][msg.sender],msg.value);lastActiveTransaction[msg.sender]=block.number;Deposit(address(0),msg.sender,msg.value,tokens[address(0)][msg.sender],referrer[msg.sender]);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 219
column: 4
content: functionwithdraw(addresstoken,uint256amount)returns(boolsuccess){if(safeSub(block.number,lastActiveTransaction[msg.sender])<inactivityReleasePeriod)throw;if(tokens[token][msg.sender]<amount)throw;tokens[token][msg.sender]=safeSub(tokens[token][msg.sender],amount);if(token==address(0)){if(!msg.sender.send(amount))throw;}else{if(!Token(token).transfer(msg.sender,amount))throw;}Withdraw(token,msg.sender,amount,tokens[token][msg.sender],0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 231
column: 4
content: functionadminWithdraw(addresstoken,uint256amount,addressuser,uint256nonce,uint8v,bytes32r,bytes32s,uint256feeWithdrawal)onlyAdminreturns(boolsuccess){bytes32hash=keccak256(this,token,amount,user,nonce);if(withdrawn[hash])throw;withdrawn[hash]=true;if(ecrecover(keccak256("\x19Ethereum Signed Message:\n32",hash),v,r,s)!=user)throw;if(feeWithdrawal>50finney)feeWithdrawal=50finney;if(tokens[token][user]<amount)throw;tokens[token][user]=safeSub(tokens[token][user],amount);tokens[address(0)][user]=safeSub(tokens[address(0x0)][user],feeWithdrawal);tokens[address(0)][feeAccount]=safeAdd(tokens[address(0)][feeAccount],feeWithdrawal);if(token==address(0)){if(!user.send(amount))throw;}else{if(!Token(token).transfer(user,amount))throw;}lastActiveTransaction[user]=block.number;Withdraw(token,user,amount,tokens[token][user],feeWithdrawal);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 253
column: 4
content: functionbalanceOf(addresstoken,addressuser)constantreturns(uint256){returntokens[token][user];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 289
column: 4
content: functiontrade(uint8[2]v,bytes32[4]rs,uint256[7]tradeValues,address[6]tradeAddresses)onlyAdminreturns(uintfilledTakerTokenAmount){OrderPairmemoryt=OrderPair({makerAmountBuy:tradeValues[0],makerAmountSell:tradeValues[1],makerNonce:tradeValues[2],takerAmountBuy:tradeValues[3],takerAmountSell:tradeValues[4],takerNonce:tradeValues[5],takerGasFee:tradeValues[6],makerTokenBuy:tradeAddresses[0],makerTokenSell:tradeAddresses[1],maker:tradeAddresses[2],takerTokenBuy:tradeAddresses[3],takerTokenSell:tradeAddresses[4],taker:tradeAddresses[5],makerOrderHash:keccak256(this,tradeAddresses[0],tradeValues[0],tradeAddresses[1],tradeValues[1],tradeValues[2],tradeAddresses[2]),takerOrderHash:keccak256(this,tradeAddresses[3],tradeValues[3],tradeAddresses[4],tradeValues[4],tradeValues[5],tradeAddresses[5])});if(ecrecover(keccak256("\x19Ethereum Signed Message:\n32",t.makerOrderHash),v[0],rs[0],rs[1])!=t.maker){LogError(uint8(Errors.INVLID_SIGNATURE),t.makerOrderHash,t.takerOrderHash);return0;}if(ecrecover(keccak256("\x19Ethereum Signed Message:\n32",t.takerOrderHash),v[1],rs[2],rs[3])!=t.taker){LogError(uint8(Errors.INVLID_SIGNATURE),t.makerOrderHash,t.takerOrderHash);return0;}if(t.makerTokenBuy!=t.takerTokenSell||t.makerTokenSell!=t.takerTokenBuy){LogError(uint8(Errors.TOKENS_DONT_MATCH),t.makerOrderHash,t.takerOrderHash);return0;}if(t.takerGasFee>100finney){LogError(uint8(Errors.GAS_TOO_HIGH),t.makerOrderHash,t.takerOrderHash);return0;}if(!((t.makerTokenBuy!=address(0x0)&&safeMul(t.makerAmountSell,1ether)/t.makerAmountBuy>=safeMul(t.takerAmountBuy,1ether)/t.takerAmountSell)||(t.makerTokenBuy==address(0x0)&&safeMul(t.makerAmountBuy,1ether)/t.makerAmountSell<=safeMul(t.takerAmountSell,1ether)/t.takerAmountBuy))){LogError(uint8(Errors.INVLID_PRICE),t.makerOrderHash,t.takerOrderHash);return0;}TradeValuesmemorytv=TradeValues({qty:0,invQty:0,makerAmountTaken:0,takerAmountTaken:0,makerReferrer:referrer[t.maker],takerReferrer:referrer[t.taker]});if(tv.makerReferrer==address(0x0))tv.makerReferrer=feeAccount;if(tv.takerReferrer==address(0x0))tv.takerReferrer=feeAccount;if(t.makerTokenBuy!=address(0x0)){tv.qty=min(safeSub(t.makerAmountBuy,orderFills[t.makerOrderHash]),safeSub(t.takerAmountSell,safeMul(orderFills[t.takerOrderHash],t.takerAmountSell)/t.takerAmountBuy));if(tv.qty==0){LogError(uint8(Errors.ORDER_ALREADY_FILLED),t.makerOrderHash,t.takerOrderHash);return0;}tv.invQty=safeMul(tv.qty,t.makerAmountSell)/t.makerAmountBuy;tokens[t.makerTokenSell][t.maker]=safeSub(tokens[t.makerTokenSell][t.maker],tv.invQty);tv.makerAmountTaken=safeSub(tv.qty,safeMul(tv.qty,makerFee)/(1ether));tokens[t.makerTokenBuy][t.maker]=safeAdd(tokens[t.makerTokenBuy][t.maker],tv.makerAmountTaken);tokens[t.makerTokenBuy][tv.makerReferrer]=safeAdd(tokens[t.makerTokenBuy][tv.makerReferrer],safeMul(tv.qty,makerAffiliateFee)/(1ether));tokens[t.takerTokenSell][t.taker]=safeSub(tokens[t.takerTokenSell][t.taker],tv.qty);tv.takerAmountTaken=safeSub(safeSub(tv.invQty,safeMul(tv.invQty,takerFee)/(1ether)),safeMul(tv.invQty,t.takerGasFee)/(1ether));tokens[t.takerTokenBuy][t.taker]=safeAdd(tokens[t.takerTokenBuy][t.taker],tv.takerAmountTaken);tokens[t.takerTokenBuy][tv.takerReferrer]=safeAdd(tokens[t.takerTokenBuy][tv.takerReferrer],safeMul(tv.invQty,takerAffiliateFee)/(1ether));tokens[t.makerTokenBuy][feeAccount]=safeAdd(tokens[t.makerTokenBuy][feeAccount],safeMul(tv.qty,safeSub(makerFee,makerAffiliateFee))/(1ether));tokens[t.takerTokenBuy][feeAccount]=safeAdd(tokens[t.takerTokenBuy][feeAccount],safeAdd(safeMul(tv.invQty,safeSub(takerFee,takerAffiliateFee))/(1ether),safeMul(tv.invQty,t.takerGasFee)/(1ether)));orderFills[t.makerOrderHash]=safeAdd(orderFills[t.makerOrderHash],tv.qty);orderFills[t.takerOrderHash]=safeAdd(orderFills[t.takerOrderHash],safeMul(tv.qty,t.takerAmountBuy)/t.takerAmountSell);lastActiveTransaction[t.maker]=block.number;lastActiveTransaction[t.taker]=block.number;Trade(t.takerTokenBuy,tv.qty,t.takerTokenSell,tv.invQty,t.maker,t.taker,makerFee,takerFee,tv.makerAmountTaken,tv.takerAmountTaken,t.makerOrderHash,t.takerOrderHash);returntv.qty;}else{tv.qty=min(safeSub(t.makerAmountSell,safeMul(orderFills[t.makerOrderHash],t.makerAmountSell)/t.makerAmountBuy),safeSub(t.takerAmountBuy,orderFills[t.takerOrderHash]));if(tv.qty==0){LogError(uint8(Errors.ORDER_ALREADY_FILLED),t.makerOrderHash,t.takerOrderHash);return0;}tv.invQty=safeMul(tv.qty,t.makerAmountBuy)/t.makerAmountSell;tokens[t.makerTokenSell][t.maker]=safeSub(tokens[t.makerTokenSell][t.maker],tv.qty);tv.makerAmountTaken=safeSub(tv.invQty,safeMul(tv.invQty,makerFee)/(1ether));tokens[t.makerTokenBuy][t.maker]=safeAdd(tokens[t.makerTokenBuy][t.maker],tv.makerAmountTaken);tokens[t.makerTokenBuy][tv.makerReferrer]=safeAdd(tokens[t.makerTokenBuy][tv.makerReferrer],safeMul(tv.invQty,makerAffiliateFee)/(1ether));tokens[t.takerTokenSell][t.taker]=safeSub(tokens[t.takerTokenSell][t.taker],tv.invQty);tv.takerAmountTaken=safeSub(safeSub(tv.qty,safeMul(tv.qty,takerFee)/(1ether)),safeMul(tv.qty,t.takerGasFee)/(1ether));tokens[t.takerTokenBuy][t.taker]=safeAdd(tokens[t.takerTokenBuy][t.taker],tv.takerAmountTaken);tokens[t.takerTokenBuy][tv.takerReferrer]=safeAdd(tokens[t.takerTokenBuy][tv.takerReferrer],safeMul(tv.qty,takerAffiliateFee)/(1ether));tokens[t.makerTokenBuy][feeAccount]=safeAdd(tokens[t.makerTokenBuy][feeAccount],safeMul(tv.invQty,safeSub(makerFee,makerAffiliateFee))/(1ether));tokens[t.takerTokenBuy][feeAccount]=safeAdd(tokens[t.takerTokenBuy][feeAccount],safeAdd(safeMul(tv.qty,safeSub(takerFee,takerAffiliateFee))/(1ether),safeMul(tv.qty,t.takerGasFee)/(1ether)));orderFills[t.makerOrderHash]=safeAdd(orderFills[t.makerOrderHash],tv.invQty);orderFills[t.takerOrderHash]=safeAdd(orderFills[t.takerOrderHash],tv.qty);lastActiveTransaction[t.maker]=block.number;lastActiveTransaction[t.taker]=block.number;Trade(t.takerTokenBuy,tv.qty,t.takerTokenSell,tv.invQty,t.maker,t.taker,makerFee,takerFee,tv.makerAmountTaken,tv.takerAmountTaken,t.makerOrderHash,t.takerOrderHash);returntv.qty;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 475
column: 4
content: functionbatchOrderTrade(uint8[2][]v,bytes32[4][]rs,uint256[7][]tradeValues,address[6][]tradeAddresses){for(uinti=0;i<tradeAddresses.length;i++){trade(v[i],rs[i],tradeValues[i],tradeAddresses[i]);}}

SOLIDITY_VISIBILITY :24
SOLIDITY_OVERPOWERED_ROLE :3
SOLIDITY_DEPRECATED_CONSTRUCTIONS :17
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_REVERT_REQUIRE :14
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :2
SOLIDITY_EXTRA_GAS_IN_LOOPS :1
SOLIDITY_ADDRESS_HARDCODED :19
SOLIDITY_UPGRADE_TO_050 :11
SOLIDITY_GAS_LIMIT_IN_LOOPS :1
SOLIDITY_REDUNDANT_FALLBACK_REJECT :1