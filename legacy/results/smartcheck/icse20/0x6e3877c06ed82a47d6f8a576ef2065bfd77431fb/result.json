{
  "contract": "0x6e3877c06ed82a47d6f8a576ef2065bfd77431fb",
  "tool": "smartcheck",
  "start": 1563281056.7435064,
  "end": 1563281072.3440084,
  "duration": 15.600502014160156,
  "analysis": [
    {
      "name": "SOLIDITY_LOCKED_MONEY",
      "patternId": "30281d",
      "severity": 3,
      "line": 2,
      "column": 0,
      "content": "contractPasswordEncrypter{structKeyMakers{addresspayablemaker;uint256LockPrice;}mapping(address=>KeyMakers)getKM;address[]privatelistofkeymakers;mapping(address=>bool)privateCheckKM;structencryptedMessages{uinttime;addresssaver;stringencryptedMessage;stringprimaryKey;}structgetIndex{stringprimaryKey;}mapping(string=>encryptedMessages)NewEncryptedMessage;mapping(string=>bool)privateWlist;mapping(address=>getIndex)OurlastIndex;functionWallettoString(addressx)internalpurereturns(stringmemory){bytesmemoryb=newbytes(20);for(uinti=0;i<20;i++)b[i]=byte(uint8(uint(x)/(2**(8*(19-i)))));returnstring(b);}functionappendString(stringmemorya,stringmemoryb)internalpurereturns(stringmemory){returnstring(abi.encodePacked(a,b));}functionuint2str(uint_i)internalpurereturns(stringmemory_uintAsString){if(_i==0){return\"0\";}uintj=_i;uintlen;while(j!=0){len++;j/=10;}bytesmemorybstr=newbytes(len);uintk=len-1;while(_i!=0){bstr[k--]=byte(uint8(48+_i%10));_i/=10;}returnstring(bstr);}functioncexist(stringmemory_walletandid)viewprivatereturns(bool){returnWlist[_walletandid];}functioncheckIndex(stringmemory_primaryKey)viewpublicreturns(bool){stringmemorysid=appendString(WallettoString(msg.sender),_primaryKey);boolcwallet=cexist(sid);returncwallet;}functionsavenewEM(addresspayablekeyMaker,addresspayablekeyHelper,stringmemory_encryptedMessage,stringmemory_primaryKey)publicpayable{stringmemorysid=appendString(WallettoString(msg.sender),_primaryKey);require(ckmexist(keyMaker),\"406\");require(!cexist<missing ';'>(sid),\"407\");if(keyHelper==keyHelper){require(msg.value>=getKM[keyMaker].LockPrice,\"402\");keyMaker.transfer(msg.value);NewEncryptedMessage[sid].time=now;NewEncryptedMessage[sid].saver=msg.sender;NewEncryptedMessage[sid].encryptedMessage=_encryptedMessage;NewEncryptedMessage[sid].primaryKey=_primaryKey;OurlastIndex[msg.sender].primaryKey=_primaryKey;Wlist[sid]=true;}"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 12,
      "column": 14,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 13,
      "column": 30,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 28,
      "column": 29,
      "content": "private"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 76,
      "column": 4,
      "content": "functionsavenewEM(addresspayable"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 11,
      "column": 4,
      "content": "mapping(address=>KeyMakers)getKM;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 27,
      "column": 4,
      "content": "mapping(string=>encryptedMessages)NewEncryptedMessage;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 29,
      "column": 4,
      "content": "mapping(address=>getIndex)OurlastIndex;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 76,
      "column": 39,
      "content": "keyMaker,"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 76,
      "column": 49,
      "content": "addresspayablekeyHelper,"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 76,
      "column": 76,
      "content": "stringmemory_encryptedMessage,"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 76,
      "column": 109,
      "content": "stringmemory_primaryKey)publicpayable{"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 77,
      "column": 8,
      "content": "stringmemorysid=appendString(WallettoString(msg.sender),_primaryKey);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 78,
      "column": 8,
      "content": "require(ckmexist"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 78,
      "column": 24,
      "content": "(keyMaker),\"406\");"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 79,
      "column": 8,
      "content": "require"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 79,
      "column": 15,
      "content": "(!cexist<missing ';'>"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 79,
      "column": 23,
      "content": "(sid),\"407\");if"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 81,
      "column": 10,
      "content": "(keyHelper==keyHelper){"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 82,
      "column": 12,
      "content": "require(msg."
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 82,
      "column": 24,
      "content": "value>=getKM["
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 82,
      "column": 39,
      "content": "keyMaker]."
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 82,
      "column": 49,
      "content": "LockPrice,\"402\");"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 83,
      "column": 12,
      "content": "keyMaker.transfer(msg."
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 83,
      "column": 34,
      "content": "value);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 84,
      "column": 12,
      "content": "NewEncryptedMessage[sid].time=now;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 85,
      "column": 12,
      "content": "NewEncryptedMessage[sid].saver=msg.sender;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 86,
      "column": 12,
      "content": "NewEncryptedMessage[sid].encryptedMessage=_encryptedMessage;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 87,
      "column": 12,
      "content": "NewEncryptedMessage[sid].primaryKey=_primaryKey;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 88,
      "column": 12,
      "content": "OurlastIndex[msg.sender].primaryKey=_primaryKey;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 89,
      "column": 12,
      "content": "Wlist[sid]=true;"
    }
  ]
}