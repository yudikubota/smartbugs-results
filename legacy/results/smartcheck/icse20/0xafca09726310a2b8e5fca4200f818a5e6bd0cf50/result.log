/unique_chucks/16/0xafca09726310a2b8e5fca4200f818a5e6bd0cf50.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 588
column: 42
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 608
column: 46
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 622
column: 43
content: 0x0

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 547
column: 4
content: functiontoUnixtime(bytes32_dayMonthYear)constantreturns(uintunixtime){bytesmemorybDmy=bytes(b32toString(_dayMonthYear));bytesmemorytemp2=bytes(newstring(2));bytesmemorytemp4=bytes(newstring(4));temp4[0]=bDmy[5];temp4[1]=bDmy[6];temp4[2]=bDmy[7];temp4[3]=bDmy[8];uintyear=parseInt(string(temp4));temp2[0]=bDmy[10];temp2[1]=bDmy[11];uintmonth=parseInt(string(temp2));temp2[0]=bDmy[13];temp2[1]=bDmy[14];uintday=parseInt(string(temp2));unixtime=((year-1970)*365+days_since[month-1]+day)*86400;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 524
column: 8
content: for(uinti=0;i<bresult.length;i++){if((bresult[i]>=48)&&(bresult[i]<=57)){if(decimals){if(_b==0){break;}else{_b--;}}mint*=10;mint+=uint(bresult[i])-48;}elseif(bresult[i]==46){decimals=true;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 524
column: 8
content: for(uinti=0;i<bresult.length;i++){if((bresult[i]>=48)&&(bresult[i]<=57)){if(decimals){if(_b==0){break;}else{_b--;}}mint*=10;mint+=uint(bresult[i])-48;}elseif(bresult[i]==46){decimals=true;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 442
column: 0
content: contractFlightDelayLedgerInterfaceisFlightDelayDatabaseModel{functionreceiveFunds(Acc_to)payable;functionsendFunds(address_recipient,Acc_from,uint_amount)returns(bool_success);functionbookkeeping(Acc_from,Acc_to,uintamount);}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 474
column: 54
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 515
column: 22
content: string_a

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 520
column: 22
content: string_a

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 6
column: 4
content: functionisOwner(address_addr)returns(bool_isOwner);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 8
column: 4
content: functionselfRegister(bytes32_id)returns(boolresult);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 10
column: 4
content: functiongetContract(bytes32_id)returns(address_addr);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 152
column: 4
content: functiondestruct()onlyController{selfdestruct(controller);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 156
column: 4
content: functionsetContracts()onlyController{}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 362
column: 4
content: functionsetAccessControl(address_contract,address_caller,uint8_perm);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 364
column: 4
content: functionsetAccessControl(address_contract,address_caller,uint8_perm,bool_access);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 371
column: 4
content: functiongetAccessControl(address_contract,address_caller,uint8_perm)returns(bool_allowed);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 373
column: 4
content: functionsetLedger(uint8_index,int_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 375
column: 4
content: functiongetLedger(uint8_index)returns(int_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 377
column: 4
content: functiongetCustomerPremium(uint_policyId)returns(address_customer,uint_premium);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 379
column: 4
content: functiongetPolicyData(uint_policyId)returns(address_customer,uint_premium,uint_weight);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 381
column: 4
content: functiongetPolicyState(uint_policyId)returns(policyState_state);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 383
column: 4
content: functiongetRiskId(uint_policyId)returns(bytes32_riskId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 385
column: 4
content: functioncreatePolicy(address_customer,uint_premium,Currency_currency,bytes32_customerExternalId,bytes32_riskId)returns(uint_policyId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 387
column: 4
content: functionsetState(uint_policyId,policyState_state,uint_stateTime,bytes32_stateMessage);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 394
column: 4
content: functionsetWeight(uint_policyId,uint_weight,bytes_proof);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 396
column: 4
content: functionsetPayouts(uint_policyId,uint_calculatedPayout,uint_actualPayout);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 398
column: 4
content: functionsetDelay(uint_policyId,uint8_delay,uint_delayInMinutes);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 400
column: 4
content: functiongetRiskParameters(bytes32_riskId)returns(bytes32_carrierFlightNumber,bytes32_departureYearMonthDay,uint_arrivalTime);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 403
column: 4
content: functiongetPremiumFactors(bytes32_riskId)returns(uint_cumulatedWeightedPremium,uint_premiumMultiplier);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 406
column: 4
content: functioncreateUpdateRisk(bytes32_carrierFlightNumber,bytes32_departureYearMonthDay,uint_arrivalTime)returns(bytes32_riskId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 409
column: 4
content: functionsetPremiumFactors(bytes32_riskId,uint_cumulatedWeightedPremium,uint_premiumMultiplier);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 411
column: 4
content: functiongetOraclizeCallback(bytes32_queryId)returns(uint_policyId,uint_arrivalTime);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 414
column: 4
content: functiongetOraclizePolicyId(bytes32_queryId)returns(uint_policyId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 417
column: 4
content: functioncreateOraclizeCallback(bytes32_queryId,uint_policyId,oraclizeState_oraclizeState,uint_oraclizeTime);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 424
column: 4
content: functioncheckTime(bytes32_queryId,bytes32_riskId,uint_offset)returns(bool_result);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 430
column: 4
content: functionsetPermissionById(uint8_perm,bytes32_id);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 432
column: 4
content: functionsetPermissionById(uint8_perm,bytes32_id,bool_access);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 434
column: 4
content: functionsetPermissionByAddress(uint8_perm,address_addr);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 436
column: 4
content: functionsetPermissionByAddress(uint8_perm,address_addr,bool_access);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 438
column: 4
content: functioncheckPermission(uint8_perm,address_addr)returns(bool_success);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 444
column: 4
content: functionreceiveFunds(Acc_to)payable;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 446
column: 4
content: functionsendFunds(address_recipient,Acc_from,uint_amount)returns(bool_success);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 448
column: 4
content: functionbookkeeping(Acc_from,Acc_to,uintamount);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 453
column: 4
content: functionscheduleUnderwriteOraclizeCall(uint_policyId,bytes32_carrierFlightNumber);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 496
column: 4
content: functionb32toHexString(bytes32x)returns(string){bytesmemoryb=newbytes(64);for(uinti=0;i<32;i++){uint8by=uint8(uint(x)/(2**(8*(31-i))));uint8high=by/16;uint8low=by-16*high;if(high>9){high+=39;}if(low>9){low+=39;}b[2*i]=byte(high+48);b[2*i+1]=byte(low+48);}returnstring(b);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 547
column: 4
content: functiontoUnixtime(bytes32_dayMonthYear)constantreturns(uintunixtime){bytesmemorybDmy=bytes(b32toString(_dayMonthYear));bytesmemorytemp2=bytes(newstring(2));bytesmemorytemp4=bytes(newstring(4));temp4[0]=bDmy[5];temp4[1]=bDmy[6];temp4[2]=bDmy[7];temp4[3]=bDmy[8];uintyear=parseInt(string(temp4));temp2[0]=bDmy[10];temp2[1]=bDmy[11];uintmonth=parseInt(string(temp2));temp2[0]=bDmy[13];temp2[1]=bDmy[14];uintday=parseInt(string(temp2));unixtime=((year-1970)*365+days_since[month-1]+day)*86400;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 578
column: 4
content: functionFlightDelayNewPolicy(address_controller){setController(_controller);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 582
column: 4
content: functionsetContracts()onlyController{FD_AC=FlightDelayAccessControllerInterface(getContract("FD.AccessController"));FD_DB=FlightDelayDatabaseInterface(getContract("FD.Database"));FD_LG=FlightDelayLedgerInterface(getContract("FD.Ledger"));FD_UW=FlightDelayUnderwriteInterface(getContract("FD.Underwrite"));FD_AC.setPermissionByAddress(101,0x0);FD_AC.setPermissionById(102,"FD.Controller");FD_AC.setPermissionById(103,"FD.Owner");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 606
column: 4
content: functionmaintenanceMode(bool_on){if(FD_AC.checkPermission(103,msg.sender)){FD_AC.setPermissionByAddress(101,0x0,!_on);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 613
column: 4
content: functionnewPolicy(bytes32_carrierFlightNumber,bytes32_departureYearMonthDay,uint256_departureTime,uint256_arrivalTime,Currency_currency,bytes32_customerExternalId)payable{require(FD_AC.checkPermission(101,0x0));require(uint256(_currency)<=3);uint8paymentType=uint8(_currency);if(paymentType==0){if(msg.value<MIN_PREMIUM||msg.value>MAX_PREMIUM){LogPolicyDeclined(0,"Invalid premium value");FD_LG.sendFunds(msg.sender,Acc.Premium,msg.value);return;}}else{require(msg.sender==FD_CI.getContract("FD.CustomersAdmin"));if(paymentType==1){if(msg.value<MIN_PREMIUM_EUR||msg.value>MAX_PREMIUM_EUR){LogPolicyDeclined(0,"Invalid premium value");FD_LG.sendFunds(msg.sender,Acc.Premium,msg.value);return;}}if(paymentType==2){if(msg.value<MIN_PREMIUM_USD||msg.value>MAX_PREMIUM_USD){LogPolicyDeclined(0,"Invalid premium value");FD_LG.sendFunds(msg.sender,Acc.Premium,msg.value);return;}}if(paymentType==3){if(msg.value<MIN_PREMIUM_GBP||msg.value>MAX_PREMIUM_GBP){LogPolicyDeclined(0,"Invalid premium value");FD_LG.sendFunds(msg.sender,Acc.Premium,msg.value);return;}}}FD_LG.receiveFunds.value(msg.value)(Acc.Premium);uintdmy=toUnixtime(_departureYearMonthDay);if(_arrivalTime<_departureTime||_arrivalTime>_departureTime+MAX_FLIGHT_DURATION||_departureTime<now+MIN_TIME_BEFORE_DEPARTURE||_departureTime>CONTRACT_DEAD_LINE||_departureTime<dmy||_departureTime>dmy+24hours||_departureTime<MIN_DEPARTURE_LIM||_departureTime>MAX_DEPARTURE_LIM){LogPolicyDeclined(0,"Invalid arrival/departure time");FD_LG.sendFunds(msg.sender,Acc.Premium,msg.value);return;}bytes32riskId=FD_DB.createUpdateRisk(_carrierFlightNumber,_departureYearMonthDay,_arrivalTime);var(cumulatedWeightedPremium,premiumMultiplier)=FD_DB.getPremiumFactors(riskId);if(msg.value*premiumMultiplier+cumulatedWeightedPremium>=MAX_CUMULATED_WEIGHTED_PREMIUM){}elseif(cumulatedWeightedPremium==0){FD_DB.setPremiumFactors(riskId,MAX_CUMULATED_WEIGHTED_PREMIUM,premiumMultiplier);}uintpremium=bookAndCalcRemainingPremium();uintpolicyId=FD_DB.createPolicy(msg.sender,premium,_currency,_customerExternalId,riskId);if(premiumMultiplier>0){FD_DB.setPremiumFactors(riskId,cumulatedWeightedPremium+premium*premiumMultiplier,premiumMultiplier);}FD_DB.setState(policyId,policyState.Applied,now,"Policy applied by customer");LogPolicyApplied(policyId,msg.sender,_carrierFlightNumber,premium);LogExternal(policyId,msg.sender,_customerExternalId);FD_UW.scheduleUnderwriteOraclizeCall(policyId,_carrierFlightNumber);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 139
column: 4
content: FlightDelayControllerInterfaceFD_CI;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 257
column: 4
content: uintconstantMIN_OBSERVATIONS=10;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 259
column: 4
content: uintconstantMIN_PREMIUM=50finney;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 261
column: 4
content: uintconstantMAX_PREMIUM=1ether;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 263
column: 4
content: uintconstantMAX_PAYOUT=1100finney;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 265
column: 4
content: uintconstantMIN_PREMIUM_EUR=1500wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 266
column: 4
content: uintconstantMAX_PREMIUM_EUR=29000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 267
column: 4
content: uintconstantMAX_PAYOUT_EUR=30000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 269
column: 4
content: uintconstantMIN_PREMIUM_USD=1700wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 270
column: 4
content: uintconstantMAX_PREMIUM_USD=34000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 271
column: 4
content: uintconstantMAX_PAYOUT_USD=35000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 273
column: 4
content: uintconstantMIN_PREMIUM_GBP=1300wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 274
column: 4
content: uintconstantMAX_PREMIUM_GBP=25000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 275
column: 4
content: uintconstantMAX_PAYOUT_GBP=270wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 278
column: 4
content: uintconstantMAX_CUMULATED_WEIGHTED_PREMIUM=300ether;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 280
column: 4
content: uint8constantREWARD_PERCENT=2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 282
column: 4
content: uint8constantRESERVE_PERCENT=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 286
column: 4
content: uint8[6]WEIGHT_PATTERN=[0,10,20,30,50,50];

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 298
column: 4
content: uintconstantMIN_TIME_BEFORE_DEPARTURE=24hours;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 300
column: 4
content: uintconstantCHECK_PAYOUT_OFFSET=15minutes;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 312
column: 4
content: uintconstantMAX_FLIGHT_DURATION=2days;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 314
column: 4
content: uintconstantCONTRACT_DEAD_LINE=1922396399;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 316
column: 4
content: uintconstantMIN_DEPARTURE_LIM=1508198400;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 318
column: 4
content: uintconstantMAX_DEPARTURE_LIM=1509494400;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 321
column: 4
content: uintconstantORACLIZE_GAS=1000000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 330
column: 4
content: stringconstantORACLIZE_RATINGS_BASE_URL="[URL] json(https://api.flightstats.com/flex/ratings/rest/v1/json/flight/";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 333
column: 4
content: stringconstantORACLIZE_RATINGS_QUERY="?${[decrypt] BDuCYocRMLSG1ps6CPtaKal1sRS+duDdEFlNoIro+789kuuKLR4nsoYqELn+G6OIGEY722F6PFw9Y5YW/NWLnOLYFdzSh+ulIZ7Uum736YAa6CuYSFZ/EQem6s1y8t+HKg4zfhVw84tY09xIFAM1+MywYvbg8lbm80bPjbWKvmDdx230oAbu}).ratings[0]['observations','late15','late30','late45','cancelled','diverted','arrivalAirportFsCode']";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 335
column: 4
content: stringconstantORACLIZE_STATUS_BASE_URL="[URL] json(https://api.flightstats.com/flex/flightstatus/rest/v2/json/flight/status/";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 338
column: 4
content: stringconstantORACLIZE_STATUS_QUERY="?${[decrypt] BHAF1MKJcAev0j66Q9G2s/HrMJdmq8io30+miL89TSfv6GH+vtfMYudd34mLjVCJaORzHpB+WOQgN19maTA0Rza4aSpN4TxV7v+eATjUiXWp/VL/GNMu+ACE9OseA2QA+HNhrviWAQPzkmKEVJfKd9l/5p5TN0b93whYFL9KiTn1eO0m61Wi}&utc=true).flightStatuses[0]['status','delays','operationalTimes']";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 459
column: 4
content: uint16[12]days_since=[11,42,70,101,131,162,192,223,254,284,315,345];

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 573
column: 4
content: FlightDelayAccessControllerInterfaceFD_AC;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 574
column: 4
content: FlightDelayDatabaseInterfaceFD_DB;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 575
column: 4
content: FlightDelayLedgerInterfaceFD_LG;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 576
column: 4
content: FlightDelayUnderwriteInterfaceFD_UW;

SOLIDITY_VISIBILITY :76
SOLIDITY_DEPRECATED_CONSTRUCTIONS :1
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :1
SOLIDITY_ADDRESS_HARDCODED :3
SOLIDITY_UPGRADE_TO_050 :3
SOLIDITY_GAS_LIMIT_IN_LOOPS :1