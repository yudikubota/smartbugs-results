/unique_chucks/15/0x842182360dfae06c6a84e8a47d37aeeadb115694.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 94
column: 40
content: 0x800000001

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 101
column: 44
content: 0x800000002

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 107
column: 40
content: 0x800000003

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 112
column: 40
content: 0x800000004

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 124
column: 36
content: 0x800000005

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 132
column: 40
content: 0x800000006

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 139
column: 40
content: 0x800000007

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 148
column: 40
content: 0x800000008

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 157
column: 40
content: 0x800000009

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 164
column: 40
content: 0x80000000a

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 189
column: 36
content: 0x810000000

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 198
column: 36
content: 0x810000001

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 208
column: 36
content: 0x810000002

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 232
column: 36
content: 0x820000000

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 241
column: 40
content: 0x820000001

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 264
column: 36
content: 0x830000000

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 298
column: 36
content: 0x850000001

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 304
column: 36
content: 0x850000002

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 324
column: 36
content: 0x860000000

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 333
column: 36
content: 0x860000001

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 522
column: 36
content: 0x85000000

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 527
column: 36
content: 0x85000001

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 533
column: 40
content: 0x85000002

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 599
column: 36
content: 0x86000000

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 616
column: 40
content: 0x86000001

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 640
column: 40
content: 0x86000002

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 680
column: 37
content: 0x87000000

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 714
column: 37
content: 0x88000000

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 693
column: 43
content: --reserves.length

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 51
column: 60
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 63
column: 60
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 248
column: 31
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 356
column: 60
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 718
column: 41
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 191
column: 51
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 200
column: 51
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 210
column: 51
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 329
column: 45
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 342
column: 39
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 498
column: 52
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 501
column: 60
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 601
column: 51
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 603
column: 33
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 650
column: 33
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 652
column: 51
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 660
column: 72
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 729
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 5
column: 4
content: functiontotalSupply()constantreturns(uinttotalSupply);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 6
column: 4
content: functionbalanceOf(address_owner)constantreturns(uintbalance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 10
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uintremaining);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 11
column: 4
content: functiondecimals()constantreturns(uintdigits);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 50
column: 4
content: functionisPairListed(ERC20source,ERC20dest,uintblockNumber)internalconstantreturns(bool){ConversionRatememoryrateInfo=pairConversionRate[sha3(source,dest)];if(rateInfo.rate==0)returnfalse;returnrateInfo.expirationBlock>=blockNumber;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 62
column: 4
content: functiongetConversionRate(ERC20source,ERC20dest,uintblockNumber)internalconstantreturns(uint){ConversionRatememoryrateInfo=pairConversionRate[sha3(source,dest)];if(rateInfo.rate==0)return0;if(rateInfo.expirationBlock<blockNumber)return0;returnrateInfo.rate*(10**getDecimals(dest))/(10**getDecimals(source));}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 72
column: 4
content: functiongetDecimals(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)return18;returntoken.decimals();}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 355
column: 4
content: functiongetPairInfo(ERC20source,ERC20dest)constantreturns(uintrate,uintexpBlock,uintbalance){ConversionRatememoryrateInfo=pairConversionRate[sha3(source,dest)];balance=0;if(dest==ETH_TOKEN_ADDRESS)balance=this.balance;elsebalance=dest.balanceOf(this);expBlock=rateInfo.expirationBlock;rate=rateInfo.rate;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 369
column: 4
content: functiongetBalance(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)returnthis.balance;elsereturntoken.balanceOf(this);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 408
column: 4
content: functiongetNumReserves()constantreturns(uint){returnreserves.length;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 417
column: 4
content: functiongetRate(ERC20source,ERC20dest,uintreserveIndex)constantreturns(uintrate,uintexpBlock,uintbalance){(rate,expBlock,balance)=reserves[reserveIndex].getPairInfo(source,dest);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 427
column: 4
content: functiongetPrice(ERC20source,ERC20dest)constantreturns(uint){uintrate;uintexpBlock;uintbalance;(rate,expBlock,balance)=getRate(source,dest,0);if(expBlock<=block.number)return0;if(balance==0)return0;returnrate;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 435
column: 4
content: functiongetDecimals(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)return18;returntoken.decimals();}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 445
column: 4
content: functionfindBestRate(ERC20source,ERC20dest)internalconstantreturns(KyberReservePairInfo){uintbestRate;uintbestReserveBalance=0;uintnumReserves=reserves.length;KyberReservePairInfomemoryoutput;KyberReservebestReserve=KyberReserve(0);for(uinti=0;i<numReserves;i++){var(rate,expBlock,balance)=reserves[i].getPairInfo(source,dest);if((expBlock>=block.number)&&(balance>0)&&(rate>bestRate)){bestRate=rate;bestReserveBalance=balance;bestReserve=reserves[i];}}output.rate=bestRate;output.reserveBalance=bestReserveBalance;output.reserve=bestReserve;returnoutput;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 519
column: 4
content: functionvalidateTradeInput(ERC20source,uintsrcAmount)constantinternalreturns(bool){if(source!=ETH_TOKEN_ADDRESS&&msg.value>0){ErrorReport(tx.origin,0x85000000,0);returnfalse;}elseif(source==ETH_TOKEN_ADDRESS&&msg.value!=srcAmount){ErrorReport(tx.origin,0x85000001,msg.value);returnfalse;}elseif(source!=ETH_TOKEN_ADDRESS){if(source.allowance(msg.sender,this)<srcAmount){ErrorReport(tx.origin,0x85000002,msg.value);returnfalse;}}returntrue;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 579
column: 4
content: functionisNegligable(uintcurrentValue,uintoriginalValue)constantreturns(bool){return(currentValue<(originalValue/1000))||(currentValue==0);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 735
column: 4
content: functiongetReserves()constantreturns(KyberReserve[]){returnreserves;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 744
column: 4
content: functiongetBalance(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)returnthis.balance;elsereturntoken.balanceOf(this);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 246
column: 8
content: for(uinti=0;i<sources.length;i++){SetRate(sources[i],dests[i],conversionRates[i],expiryBlocks[i]);pairConversionRate[sha3(sources[i],dests[i])]=ConversionRate(conversionRates[i],expiryBlocks[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 690
column: 12
content: for(uinti=0;i<reserves.length;i++){if(reserves[i]==reserve){if(reserves.length==0)return;reserves[i]=reserves[--reserves.length];AddReserve(reserve,false);break;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 246
column: 8
content: for(uinti=0;i<sources.length;i++){SetRate(sources[i],dests[i],conversionRates[i],expiryBlocks[i]);pairConversionRate[sha3(sources[i],dests[i])]=ConversionRate(conversionRates[i],expiryBlocks[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 453
column: 8
content: for(uinti=0;i<numReserves;i++){var(rate,expBlock,balance)=reserves[i].getPairInfo(source,dest);if((expBlock>=block.number)&&(balance>0)&&(rate>bestRate)){bestRate=rate;bestReserveBalance=balance;bestReserve=reserves[i];}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 690
column: 12
content: for(uinti=0;i<reserves.length;i++){if(reserves[i]==reserve){if(reserves.length==0)return;reserves[i]=reserves[--reserves.length];AddReserve(reserve,false);break;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 38f6c7
severity: 2
line: 609
column: 8
content: while(!isNegligable(maxDestAmount-tradeInfo.convertedDestAmount,maxDestAmount)&&!isNegligable(tradeInfo.remainedSourceAmount,srcAmount)){KyberReservePairInfomemoryreserveInfo=findBestRate(source,dest);if(reserveInfo.rate==0||reserveInfo.rate<minConversionRate){tradeInfo.tradeFailed=true;ErrorReport(tx.origin,0x86000001,tradeInfo.remainedSourceAmount);break;}reserveInfo.rate=(reserveInfo.rate*(10**getDecimals(dest)))/(10**getDecimals(source));uintactualSrcAmount=tradeInfo.remainedSourceAmount;uintactualDestAmount=(actualSrcAmount*reserveInfo.rate)/PRECISION;if(actualDestAmount>reserveInfo.reserveBalance){actualDestAmount=reserveInfo.reserveBalance;}if(actualDestAmount+tradeInfo.convertedDestAmount>maxDestAmount){actualDestAmount=maxDestAmount-tradeInfo.convertedDestAmount;}actualSrcAmount=(actualDestAmount*PRECISION)/reserveInfo.rate;if(!doSingleTrade(source,actualSrcAmount,dest,destAddress,reserveInfo.reserve,true)){tradeInfo.tradeFailed=true;ErrorReport(tx.origin,0x86000002,tradeInfo.remainedSourceAmount);break;}tradeInfo.remainedSourceAmount-=actualSrcAmount;tradeInfo.convertedDestAmount+=actualDestAmount;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 191
column: 16
content: if(!msg.sender.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 200
column: 16
content: if(!msg.sender.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 210
column: 16
content: if(!msg.sender.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 329
column: 12
content: if(!destination.send(amount))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 342
column: 6
content: if(msg.sender!=reserveOwner)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 498
column: 16
content: if(!source.approve(reserve,0))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 501
column: 16
content: if(!source.transfer(msg.sender,amount))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 601
column: 16
content: if(!msg.sender.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 603
column: 12
content: if(throwOnFailure)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 650
column: 12
content: if(throwOnFailure)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 652
column: 16
content: if(!msg.sender.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 660
column: 16
content: if(!msg.sender.send(tradeInfo.remainedSourceAmount))throw;

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 94
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 101
column: 33
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 107
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 112
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 124
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 132
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 139
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 148
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 157
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 164
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 169
column: 17
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 189
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 198
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 208
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 215
column: 21
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 232
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 241
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 251
column: 21
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 264
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 269
column: 21
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 284
column: 21
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 298
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 304
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 324
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 333
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 337
column: 21
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 522
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 527
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 533
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 599
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 616
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 640
column: 29
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 658
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 665
column: 25
content: tx.origin

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 720
column: 21
content: tx.origin

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 445
column: 80
content: KyberReservePairInfo

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 5
column: 4
content: functiontotalSupply()constantreturns(uinttotalSupply);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 6
column: 4
content: functionbalanceOf(address_owner)constantreturns(uintbalance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 7
column: 4
content: functiontransfer(address_to,uint_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 8
column: 4
content: functiontransferFrom(address_from,address_to,uint_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 9
column: 4
content: functionapprove(address_spender,uint_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 10
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uintremaining);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 11
column: 4
content: functiondecimals()constantreturns(uintdigits);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 38
column: 4
content: functionKyberReserve(address_kyberNetwork,address_reserveOwner){kyberNetwork=_kyberNetwork;reserveOwner=_reserveOwner;tradeEnabled=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 72
column: 4
content: functiongetDecimals(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)return18;returntoken.decimals();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 181
column: 4
content: functiontrade(ERC20sourceToken,uintsourceAmount,ERC20destToken,addressdestAddress,boolvalidate)payablereturns(bool){if(!tradeEnabled){ErrorReport(tx.origin,0x810000000,0);if(msg.value>0){if(!msg.sender.send(msg.value))throw;}returnfalse;}if(msg.sender!=kyberNetwork){ErrorReport(tx.origin,0x810000001,uint(msg.sender));if(msg.value>0){if(!msg.sender.send(msg.value))throw;}returnfalse;}if(!doTrade(sourceToken,sourceAmount,destToken,destAddress,validate)){ErrorReport(tx.origin,0x810000002,0);if(msg.value>0){if(!msg.sender.send(msg.value))throw;}returnfalse;}ErrorReport(tx.origin,0,0);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 229
column: 4
content: functionsetRate(ERC20[]sources,ERC20[]dests,uint[]conversionRates,uint[]expiryBlocks,boolvalidate)returns(bool){if(msg.sender!=reserveOwner){ErrorReport(tx.origin,0x820000000,uint(msg.sender));returnfalse;}if(validate){if((sources.length!=dests.length)||(sources.length!=conversionRates.length)||(sources.length!=expiryBlocks.length)){ErrorReport(tx.origin,0x820000001,0);returnfalse;}}for(uinti=0;i<sources.length;i++){SetRate(sources[i],dests[i],conversionRates[i],expiryBlocks[i]);pairConversionRate[sha3(sources[i],dests[i])]=ConversionRate(conversionRates[i],expiryBlocks[i]);}ErrorReport(tx.origin,0,0);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 261
column: 4
content: functionenableTrade(boolenable)returns(bool){if(msg.sender!=reserveOwner){ErrorReport(tx.origin,0x830000000,uint(msg.sender));returnfalse;}tradeEnabled=enable;ErrorReport(tx.origin,0,0);EnableTrade(enable);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 276
column: 4
content: function()payable{DepositToken(ETH_TOKEN_ADDRESS,msg.value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 283
column: 4
content: functiondepositEther()payablereturns(bool){ErrorReport(tx.origin,0,0);DepositToken(ETH_TOKEN_ADDRESS,msg.value);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 295
column: 4
content: functiondepositToken(ERC20token,uintamount)returns(bool){if(token.allowance(msg.sender,this)<amount){ErrorReport(tx.origin,0x850000001,token.allowance(msg.sender,this));returnfalse;}if(!token.transferFrom(msg.sender,this,amount)){ErrorReport(tx.origin,0x850000002,uint(token));returnfalse;}DepositToken(token,amount);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 321
column: 4
content: functionwithdraw(ERC20token,uintamount,addressdestination)returns(bool){if(msg.sender!=reserveOwner){ErrorReport(tx.origin,0x860000000,uint(msg.sender));returnfalse;}if(token==ETH_TOKEN_ADDRESS){if(!destination.send(amount))throw;}elseif(!token.transfer(destination,amount)){ErrorReport(tx.origin,0x860000001,uint(token));returnfalse;}ErrorReport(tx.origin,0,0);Withdraw(token,amount,destination);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 341
column: 4
content: functionchangeOwner(addressnewOwner){if(msg.sender!=reserveOwner)throw;reserveOwner=newOwner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 355
column: 4
content: functiongetPairInfo(ERC20source,ERC20dest)constantreturns(uintrate,uintexpBlock,uintbalance){ConversionRatememoryrateInfo=pairConversionRate[sha3(source,dest)];balance=0;if(dest==ETH_TOKEN_ADDRESS)balance=this.balance;elsebalance=dest.balanceOf(this);expBlock=rateInfo.expirationBlock;rate=rateInfo.rate;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 369
column: 4
content: functiongetBalance(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)returnthis.balance;elsereturntoken.balanceOf(this);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 394
column: 4
content: functionKyberNetwork(address_admin){admin=_admin;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 408
column: 4
content: functiongetNumReserves()constantreturns(uint){returnreserves.length;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 417
column: 4
content: functiongetRate(ERC20source,ERC20dest,uintreserveIndex)constantreturns(uintrate,uintexpBlock,uintbalance){(rate,expBlock,balance)=reserves[reserveIndex].getPairInfo(source,dest);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 427
column: 4
content: functiongetPrice(ERC20source,ERC20dest)constantreturns(uint){uintrate;uintexpBlock;uintbalance;(rate,expBlock,balance)=getRate(source,dest,0);if(expBlock<=block.number)return0;if(balance==0)return0;returnrate;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 435
column: 4
content: functiongetDecimals(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)return18;returntoken.decimals();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 568
column: 4
content: functionwalletTrade(ERC20source,uintsrcAmount,ERC20dest,addressdestAddress,uintmaxDestAmount,uintminConversionRate,boolthrowOnFailure,bytes32walletId)payablereturns(uint){returntrade(source,srcAmount,dest,destAddress,maxDestAmount,minConversionRate,throwOnFailure);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 579
column: 4
content: functionisNegligable(uintcurrentValue,uintoriginalValue)constantreturns(bool){return(currentValue<(originalValue/1000))||(currentValue==0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 592
column: 4
content: functiontrade(ERC20source,uintsrcAmount,ERC20dest,addressdestAddress,uintmaxDestAmount,uintminConversionRate,boolthrowOnFailure)payablereturns(uint){if(!validateTradeInput(source,srcAmount)){ErrorReport(tx.origin,0x86000000,0);if(msg.value>0){if(!msg.sender.send(msg.value))throw;}if(throwOnFailure)throw;return0;}TradeInfomemorytradeInfo=TradeInfo(0,srcAmount,false);while(!isNegligable(maxDestAmount-tradeInfo.convertedDestAmount,maxDestAmount)&&!isNegligable(tradeInfo.remainedSourceAmount,srcAmount)){KyberReservePairInfomemoryreserveInfo=findBestRate(source,dest);if(reserveInfo.rate==0||reserveInfo.rate<minConversionRate){tradeInfo.tradeFailed=true;ErrorReport(tx.origin,0x86000001,tradeInfo.remainedSourceAmount);break;}reserveInfo.rate=(reserveInfo.rate*(10**getDecimals(dest)))/(10**getDecimals(source));uintactualSrcAmount=tradeInfo.remainedSourceAmount;uintactualDestAmount=(actualSrcAmount*reserveInfo.rate)/PRECISION;if(actualDestAmount>reserveInfo.reserveBalance){actualDestAmount=reserveInfo.reserveBalance;}if(actualDestAmount+tradeInfo.convertedDestAmount>maxDestAmount){actualDestAmount=maxDestAmount-tradeInfo.convertedDestAmount;}actualSrcAmount=(actualDestAmount*PRECISION)/reserveInfo.rate;if(!doSingleTrade(source,actualSrcAmount,dest,destAddress,reserveInfo.reserve,true)){tradeInfo.tradeFailed=true;ErrorReport(tx.origin,0x86000002,tradeInfo.remainedSourceAmount);break;}tradeInfo.remainedSourceAmount-=actualSrcAmount;tradeInfo.convertedDestAmount+=actualDestAmount;}if(tradeInfo.tradeFailed){if(throwOnFailure)throw;if(msg.value>0){if(!msg.sender.send(msg.value))throw;}return0;}else{ErrorReport(tx.origin,0,0);if(tradeInfo.remainedSourceAmount>0&&source==ETH_TOKEN_ADDRESS){if(!msg.sender.send(tradeInfo.remainedSourceAmount))throw;}ErrorReport(tx.origin,0,0);Trade(msg.sender,source,dest,srcAmount-tradeInfo.remainedSourceAmount,tradeInfo.convertedDestAmount);returntradeInfo.convertedDestAmount;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 677
column: 4
content: functionaddReserve(KyberReservereserve,booladd){if(msg.sender!=admin){ErrorReport(msg.sender,0x87000000,0);return;}if(add){reserves.push(reserve);AddReserve(reserve,true);}else{for(uinti=0;i<reserves.length;i++){if(reserves[i]==reserve){if(reserves.length==0)return;reserves[i]=reserves[--reserves.length];AddReserve(reserve,false);break;}}}ErrorReport(msg.sender,0,0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 711
column: 4
content: functionlistPairForReserve(addressreserve,ERC20source,ERC20dest,booladd){if(msg.sender!=admin){ErrorReport(msg.sender,0x88000000,0);return;}(perReserveListedPairs[reserve])[sha3(source,dest)]=add;ListPairsForReserve(reserve,source,dest,add);ErrorReport(tx.origin,0,0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 726
column: 4
content: functionupgrade(addressnewAddress){newAddress;throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 735
column: 4
content: functiongetReserves()constantreturns(KyberReserve[]){returnreserves;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 744
column: 4
content: functiongetBalance(ERC20token)constantreturns(uint){if(token==ETH_TOKEN_ADDRESS)returnthis.balance;elsereturntoken.balanceOf(this);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 25
column: 4
content: uintconstantPRECISION=(10**18);

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 33
column: 4
content: mapping(bytes32=>ConversionRate)pairConversionRate;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 382
column: 4
content: addressadmin;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 384
column: 4
content: uintconstantPRECISION=(10**18);

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 385
column: 4
content: uintconstantEPSILON=(10);

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 388
column: 4
content: mapping(address=>mapping(bytes32=>bool))perReserveListedPairs;

SOLIDITY_VISIBILITY :38
SOLIDITY_DEPRECATED_CONSTRUCTIONS :36
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :1
SOLIDITY_REVERT_REQUIRE :12
SOLIDITY_EXTRA_GAS_IN_LOOPS :2
SOLIDITY_ADDRESS_HARDCODED :28
SOLIDITY_UPGRADE_TO_050 :1
SOLIDITY_GAS_LIMIT_IN_LOOPS :4
SOLIDITY_TX_ORIGIN :35