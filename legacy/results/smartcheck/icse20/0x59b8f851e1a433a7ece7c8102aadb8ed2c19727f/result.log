/unique_chucks/29/0x59b8f851e1a433a7ece7c8102aadb8ed2c19727f.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 96
column: 2
content: games.length=2

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 43ba1c
severity: 1
line: 229
column: 3
content: investors.length++

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 43ba1c
severity: 1
line: 366
column: 2
content: games.length++

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 27cb59
severity: 1
line: 338
column: 4
content: suicide

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 133
column: 57
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 135
column: 57
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 136
column: 58
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 137
column: 58
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 148
column: 35
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 162
column: 18
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 163
column: 18
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 164
column: 18
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 165
column: 18
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 195
column: 60
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 197
column: 60
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 198
column: 61
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 199
column: 61
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 289
column: 11
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 293
column: 44
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 294
column: 44
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 295
column: 44
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 296
column: 44
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 385
column: 12
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 154
column: 36
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 156
column: 33
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 157
column: 86
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 158
column: 29
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 159
column: 47
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 213
column: 20
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 214
column: 54
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 219
column: 29
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 221
column: 52
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 224
column: 32
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 227
column: 46
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 246
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 247
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 249
column: 23
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 251
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 255
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 256
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 258
column: 63
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 259
column: 65
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 272
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 276
column: 87
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 281
column: 96
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 331
column: 27
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 332
column: 43
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 452
column: 55
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 453
column: 43
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 454
column: 51
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 455
column: 52
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 10
column: 1
content: functiongetDraw(uintid)constantreturns(uintdate,uint8[3]numbers,uinthit3Count,uinthit3Value,uinthit2Count,uinthit2Value);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 101
column: 1
content: functionVisit()constantreturns(string){return"http://wlb.ethereumlottery.net";}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 102
column: 1
content: functionDraws(uintid)constantreturns(uintdate,uint8[3]Numbers,uinthit3Count,uinthit3Value,uinthit2Count,uinthit2Value){returnWLBdrawsDBInterface(WLBdrawsDB).getDraw(id);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 105
column: 1
content: functionCurrentGame()constantreturns(uintGameID,uintJackpot,uintStart,uintEnd,uintTickets){return(currentGame,currentJackpot,games[currentGame].startTimestamp,games[currentGame].endTimestamp,games[currentGame].ticketsCount);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 108
column: 1
content: functionPlayerTickets(addressPlayer,uintGameID,uintTicketID)constantreturns(uint8[3]numbers,boolChecked){return(getNumbersFromBytes(players[Player].games[GameID].numbersBytes[TicketID]),players[Player].games[GameID].checked);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 111
column: 1
content: functionInvestors(addressAddress)constantreturns(uintInvestment,uintBalance,boolLive){var(found,InvestorID)=getInvestorByAddress(Address);if(found==false||!investors[InvestorID].valid){return(0,0,false);}return(investors[InvestorID].value,investors[InvestorID].balance,investors[InvestorID].live);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 118
column: 1
content: functionCheckPrize(addressAddress)constantreturns(uintvalue){uintgameID;uintgameLowID;uint8[3]memorynumbers;uinthit3Count;uinthit2Count;if(currentGame<prizeDismissDelay){gameLowID=1;}else{gameLowID=currentGame-prizeDismissDelay;}for(gameID=currentGame;gameID>=gameLowID;gameID--){if(!players[Address].games[gameID].checked){if(games[gameID].drawDone){numbers=getNumbersFromBytes(games[gameID].winningNumbersBytes);hit3Count=players[Address].games[gameID].hit3Hash[sha3(numbers[0],numbers[1],numbers[2])];value+=hit3Count*games[gameID].hit3Value;hit2Count=players[Address].games[gameID].hit2Hash[sha3(numbers[0],numbers[1])];hit2Count+=players[Address].games[gameID].hit2Hash[sha3(numbers[0],numbers[2])];hit2Count+=players[Address].games[gameID].hit2Hash[sha3(numbers[1],numbers[2])];hit2Count-=hit3Count*3;value+=hit2Count*games[gameID].hit2Value;}elseif(!contractEnabled&&gameID==currentGame){value+=players[Address].games[gameID].numbersBytes.length*ticketPrice;}}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 288
column: 2
content: for(a=1;a<=drawBlockDelay;a++){_hash=sha3(_hash,block.blockhash(games[currentGame].prepareBlock-drawBlockDelay+a));}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 311
column: 3
content: for(a=0;a<investors.length;a++){deleteinvestors[a].live;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 353
column: 2
content: for(a=0;a<investors.length;a++){if(investors[a].live&&investors[a].valid){investors[a].balance+=value*investors[a].value/investmentsValue;done=true;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 380
column: 2
content: for(a=0;a<numbers.length;a++){while(true){ok=true;if(hashpos==32){hashpos=0;hash=sha3(hash);}num=getPart(hash,hashpos);num=num%uint8(drawMaxNumber)+1;hashpos+=1;for(b=0;b<numbers.length;b++){if(numbers[b]==num){ok=false;break;}}if(ok==true){numbers[a]=num;break;}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 390
column: 4
content: for(b=0;b<numbers.length;b++){if(numbers[b]==num){ok=false;break;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 409
column: 2
content: for(id=0;id<investors.length;id++){if(investors[id].owner==Address){return(true,id);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 417
column: 2
content: for(uinta=0;a<Numbers.length;a++){if(Numbers[a]>drawMaxNumber||Numbers[a]==0){return;}for(uintb=0;a<Numbers.length;a++){if(a!=b&&Numbers[a]==Numbers[b]){return;}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 419
column: 3
content: for(uintb=0;a<Numbers.length;a++){if(a!=b&&Numbers[a]==Numbers[b]){return;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 433
column: 2
content: for(uint8i=0;i<numbers.length;i++){for(uint8j=i+1;j<numbers.length;j++){if(sNumbers[i]>sNumbers[j]){uint8t=sNumbers[i];sNumbers[i]=sNumbers[j];sNumbers[j]=t;}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 434
column: 3
content: for(uint8j=i+1;j<numbers.length;j++){if(sNumbers[i]>sNumbers[j]){uint8t=sNumbers[i];sNumbers[i]=sNumbers[j];sNumbers[j]=t;}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 118
column: 1
content: functionCheckPrize(addressAddress)constantreturns(uintvalue){uintgameID;uintgameLowID;uint8[3]memorynumbers;uinthit3Count;uinthit2Count;if(currentGame<prizeDismissDelay){gameLowID=1;}else{gameLowID=currentGame-prizeDismissDelay;}for(gameID=currentGame;gameID>=gameLowID;gameID--){if(!players[Address].games[gameID].checked){if(games[gameID].drawDone){numbers=getNumbersFromBytes(games[gameID].winningNumbersBytes);hit3Count=players[Address].games[gameID].hit3Hash[sha3(numbers[0],numbers[1],numbers[2])];value+=hit3Count*games[gameID].hit3Value;hit2Count=players[Address].games[gameID].hit2Hash[sha3(numbers[0],numbers[1])];hit2Count+=players[Address].games[gameID].hit2Hash[sha3(numbers[0],numbers[2])];hit2Count+=players[Address].games[gameID].hit2Hash[sha3(numbers[1],numbers[2])];hit2Count-=hit3Count*3;value+=hit2Count*games[gameID].hit2Value;}elseif(!contractEnabled&&gameID==currentGame){value+=players[Address].games[gameID].numbersBytes.length*ticketPrice;}}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 311
column: 3
content: for(a=0;a<investors.length;a++){deleteinvestors[a].live;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 353
column: 2
content: for(a=0;a<investors.length;a++){if(investors[a].live&&investors[a].valid){investors[a].balance+=value*investors[a].value/investmentsValue;done=true;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 380
column: 2
content: for(a=0;a<numbers.length;a++){while(true){ok=true;if(hashpos==32){hashpos=0;hash=sha3(hash);}num=getPart(hash,hashpos);num=num%uint8(drawMaxNumber)+1;hashpos+=1;for(b=0;b<numbers.length;b++){if(numbers[b]==num){ok=false;break;}}if(ok==true){numbers[a]=num;break;}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 390
column: 4
content: for(b=0;b<numbers.length;b++){if(numbers[b]==num){ok=false;break;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 409
column: 2
content: for(id=0;id<investors.length;id++){if(investors[id].owner==Address){return(true,id);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 417
column: 2
content: for(uinta=0;a<Numbers.length;a++){if(Numbers[a]>drawMaxNumber||Numbers[a]==0){return;}for(uintb=0;a<Numbers.length;a++){if(a!=b&&Numbers[a]==Numbers[b]){return;}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 419
column: 3
content: for(uintb=0;a<Numbers.length;a++){if(a!=b&&Numbers[a]==Numbers[b]){return;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 433
column: 2
content: for(uint8i=0;i<numbers.length;i++){for(uint8j=i+1;j<numbers.length;j++){if(sNumbers[i]>sNumbers[j]){uint8t=sNumbers[i];sNumbers[i]=sNumbers[j];sNumbers[j]=t;}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 381
column: 10
content: true

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 427
column: 9
content: ret<now

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 58
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 59
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 60
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 61
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 62
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 63
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 64
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 65
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 66
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 67
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 68
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 69
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 71
column: 9
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 72
column: 9
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 73
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 74
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 75
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 76
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 77
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 78
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 80
column: 6
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 81
column: 31
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 82
column: 11
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 83
column: 15
content: private

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 154
column: 2
content: if(!checkNumbers(Numbers)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 156
column: 2
content: if(msg.value<ticketPrice){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 157
column: 35
content: if(!msg.sender.send(msg.value-ticketPrice)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 158
column: 2
content: if(currentJackpot==0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 159
column: 2
content: if(games[currentGame].endTimestamp<now){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 213
column: 2
content: if(!changed){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 214
column: 20
content: if(!msg.sender.send(_value)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 219
column: 2
content: if(value_<investUnit){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 221
column: 3
content: if(!msg.sender.send(value_%investUnit)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 224
column: 2
content: if(value_<investMinimum){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 227
column: 3
content: if(investors.length==investUserLimit){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 246
column: 2
content: if(found==false){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 247
column: 2
content: if(!investors[InvestorID].valid){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 249
column: 2
content: if(_balance==0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 251
column: 2
content: if(!msg.sender.send(_balance)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 255
column: 2
content: if(found==false){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 256
column: 2
content: if(!investors[InvestorID].valid){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 258
column: 3
content: if(investors[InvestorID].begins+investMinDuration>now){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 259
column: 3
content: if(games[currentGame].startTimestamp+investIdleTime>now){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 272
column: 2
content: if(!msg.sender.send(balance_)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 276
column: 2
content: if(games[currentGame].endTimestamp>now||games[currentGame].prepareBlock!=0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 281
column: 2
content: if(games[currentGame].prepareBlock==0||games[currentGame].prepareBlock>block.number){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 331
column: 2
content: if(ownerBalance==0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 332
column: 2
content: if(owner.send(ownerBalance)==false){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 452
column: 24
content: if(tx.origin!=msg.sender){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 453
column: 22
content: if(msg.value>0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 454
column: 24
content: if(owner!=msg.sender){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 455
column: 26
content: if(!contractEnabled){throw;}

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 157
column: 53
content: send(msg.value-ticketPrice)

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 214
column: 38
content: send(_value)

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 221
column: 21
content: send(value_%investUnit)

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 251
column: 20
content: send(_balance)

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 272
column: 20
content: send(balance_)

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 332
column: 12
content: send(ownerBalance)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 408
column: 64
content: (boolfound,uintid)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 9
column: 1
content: functionnewDraw(uintdate,uint8[3]numbers,uinthit3Count,uinthit3Value,uinthit2Count,uinthit2Value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 10
column: 1
content: functiongetDraw(uintid)constantreturns(uintdate,uint8[3]numbers,uinthit3Count,uinthit3Value,uinthit2Count,uinthit2Value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 92
column: 1
content: functionWeeklyLotteryB(address_WLBdrawsDB){WLBdrawsDB=_WLBdrawsDB;owner=msg.sender;currentGame=1;games.length=2;games[1].startTimestamp=now;games[1].endTimestamp=calcNextDrawTime();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 101
column: 1
content: functionVisit()constantreturns(string){return"http://wlb.ethereumlottery.net";}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 102
column: 1
content: functionDraws(uintid)constantreturns(uintdate,uint8[3]Numbers,uinthit3Count,uinthit3Value,uinthit2Count,uinthit2Value){returnWLBdrawsDBInterface(WLBdrawsDB).getDraw(id);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 105
column: 1
content: functionCurrentGame()constantreturns(uintGameID,uintJackpot,uintStart,uintEnd,uintTickets){return(currentGame,currentJackpot,games[currentGame].startTimestamp,games[currentGame].endTimestamp,games[currentGame].ticketsCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 108
column: 1
content: functionPlayerTickets(addressPlayer,uintGameID,uintTicketID)constantreturns(uint8[3]numbers,boolChecked){return(getNumbersFromBytes(players[Player].games[GameID].numbersBytes[TicketID]),players[Player].games[GameID].checked);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 111
column: 1
content: functionInvestors(addressAddress)constantreturns(uintInvestment,uintBalance,boolLive){var(found,InvestorID)=getInvestorByAddress(Address);if(found==false||!investors[InvestorID].valid){return(0,0,false);}return(investors[InvestorID].value,investors[InvestorID].balance,investors[InvestorID].live);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 118
column: 1
content: functionCheckPrize(addressAddress)constantreturns(uintvalue){uintgameID;uintgameLowID;uint8[3]memorynumbers;uinthit3Count;uinthit2Count;if(currentGame<prizeDismissDelay){gameLowID=1;}else{gameLowID=currentGame-prizeDismissDelay;}for(gameID=currentGame;gameID>=gameLowID;gameID--){if(!players[Address].games[gameID].checked){if(games[gameID].drawDone){numbers=getNumbersFromBytes(games[gameID].winningNumbersBytes);hit3Count=players[Address].games[gameID].hit3Hash[sha3(numbers[0],numbers[1],numbers[2])];value+=hit3Count*games[gameID].hit3Value;hit2Count=players[Address].games[gameID].hit2Hash[sha3(numbers[0],numbers[1])];hit2Count+=players[Address].games[gameID].hit2Hash[sha3(numbers[0],numbers[2])];hit2Count+=players[Address].games[gameID].hit2Hash[sha3(numbers[1],numbers[2])];hit2Count-=hit3Count*3;value+=hit2Count*games[gameID].hit2Value;}elseif(!contractEnabled&&gameID==currentGame){value+=players[Address].games[gameID].numbersBytes.length*ticketPrice;}}}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 147
column: 1
content: function(){varNumbers=getNumbersFromHash(sha3(block.coinbase,now,ticketCounter));BuyTicket(Numbers[0],Numbers[1],Numbers[2]);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 152
column: 1
content: functionBuyTicket(uint8Number1,uint8Number2,uint8Number3)noContractOnlyEnabled{varNumbers=[Number1,Number2,Number3];if(!checkNumbers(Numbers)){throw;}Numbers=sortNumbers(Numbers);if(msg.value<ticketPrice){throw;}if(msg.value-ticketPrice>0){if(!msg.sender.send(msg.value-ticketPrice)){throw;}}if(currentJackpot==0){throw;}if(games[currentGame].endTimestamp<now){throw;}ticketCounter++;games[currentGame].ticketsCount++;bytes32hash0=sha3(Numbers[0],Numbers[1],Numbers[2]);bytes32hash1=sha3(Numbers[0],Numbers[1]);bytes32hash2=sha3(Numbers[0],Numbers[2]);bytes32hash3=sha3(Numbers[1],Numbers[2]);games[currentGame].hit3Hash[hash0]++;games[currentGame].hit2Hash[hash1]++;games[currentGame].hit2Hash[hash2]++;games[currentGame].hit2Hash[hash3]++;players[msg.sender].games[currentGame].numbersBytes.push(getBytesFromNumbers(Numbers));players[msg.sender].games[currentGame].hit3Hash[hash0]++;players[msg.sender].games[currentGame].hit2Hash[hash1]++;players[msg.sender].games[currentGame].hit2Hash[hash2]++;players[msg.sender].games[currentGame].hit2Hash[hash3]++;NewTicketEvent(msg.sender,Numbers[0],Numbers[1],Numbers[2]);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 275
column: 1
content: functionDrawPrepare()noContractOnlyEnablednoEther{if(games[currentGame].endTimestamp>now||games[currentGame].prepareBlock!=0){throw;}games[currentGame].prepareBlock=block.number+drawBlockDelay;DrawPrepareEvent(games[currentGame].prepareBlock);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 280
column: 1
content: functionDraw()noContractOnlyEnablednoEther{if(games[currentGame].prepareBlock==0||games[currentGame].prepareBlock>block.number){throw;}bytes32_hash;uinthit3Value;uinthit3Count;uinthit2Value;uinthit2Count;uinta;for(a=1;a<=drawBlockDelay;a++){_hash=sha3(_hash,block.blockhash(games[currentGame].prepareBlock-drawBlockDelay+a));}varnumbers=getNumbersFromHash(_hash);games[currentGame].winningNumbersBytes=getBytesFromNumbers(numbers);hit3Count+=games[currentGame].hit3Hash[sha3(numbers[0],numbers[1],numbers[2])];hit2Count+=games[currentGame].hit2Hash[sha3(numbers[0],numbers[1])];hit2Count+=games[currentGame].hit2Hash[sha3(numbers[0],numbers[2])];hit2Count+=games[currentGame].hit2Hash[sha3(numbers[1],numbers[2])];hit2Count-=hit3Count*3;uinttotalPot=games[currentGame].ticketsCount*ticketPrice;hit2Value=(totalPot*forHit2/100);games[currentGame].prizePot=hit2Value;hit2Value=hit2Value/hit2Count;totalPot-=hit2Value;uint_ownerBalance=totalPot*forHit2/100;totalPot-=_ownerBalance;ownerBalance+=_ownerBalance;uint_addInvestorsValue=totalPot*forInvestors/100;addInvestorsValue(_addInvestorsValue);totalPot-=_addInvestorsValue;if(hit3Count>0){games[currentGame].prizePot+=currentJackpot;for(a=0;a<investors.length;a++){deleteinvestors[a].live;}hit3Value=currentJackpot/hit3Count;extraJackpot=0;investmentsValue=0;}extraJackpot+=totalPot;setJackpot();DrawEvent(currentGame,numbers[0],numbers[1],numbers[2],hit3Count,hit3Value,hit2Count,hit2Value);WLBdrawsDBInterface(WLBdrawsDB).newDraw(now,numbers,hit3Count,hit3Value,hit2Count,hit2Value);games[currentGame].hit3Count=hit3Count;games[currentGame].hit3Value=hit3Value;games[currentGame].hit2Count=hit2Count;games[currentGame].hit2Value=hit2Value;games[currentGame].drawDone=true;newGame();}

SOLIDITY_VISIBILITY :13
SOLIDITY_DEPRECATED_CONSTRUCTIONS :55
SOLIDITY_ARRAY_LENGTH_MANIPULATION :3
SOLIDITY_REVERT_REQUIRE :28
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :24
SOLIDITY_SEND :6
SOLIDITY_EXTRA_GAS_IN_LOOPS :10
SOLIDITY_GAS_LIMIT_IN_LOOPS :10
SOLIDITY_SHOULD_RETURN_STRUCT :1