/unique_chucks/28/0x7c3090e68f9653f91eec674f738957ee6c9e128a.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 75
column: 55
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 108
column: 58
content: 0x0

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 191
column: 41
content: 0x0

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 217
column: 45
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 72
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 216
column: 4
content: functioncheckHash(addressa,stringpassword)constantreturns(bool){returnhashes[a]!=""&&hashes[a]==sha3(password);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 74
column: 8
content: for(uint256i=0;i<noOfreservations[requester]&&resetOwn;i++){ticketsOwned[reservations[requester][i]]=0x0;noOfTicketsOwned[msg.sender]--;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 87
column: 8
content: for(uint256i=lowestAddressReserving;i<highestAddressReserving&&!stop;i++){if(timeOfreservations[addressesReserving[i]]!=0){pastTheLowest=true;if(now-timeOfreservations[addressesReserving[i]]>secondsToHold){resetReservations(addressesReserving[i],true);}else{stop=true;}}if(timeOfreservations[addressesReserving[i]]==0&&!pastTheLowest){lowestAddressReserving=i;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 107
column: 12
content: for(uint256i=0;i<noOfTicketsOwned[revokee];i++){ticketsOwned[ticketsOwners[revokee][i]]=0x0;price+=ticketPrices[ticketsOwners[revokee][i]];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 136
column: 8
content: for(uint256i=0;i<ticketTransferersAmount[msg.sender]&&!transferer;i++){if(ticketTransferers[msg.sender][i]==transferID){transferer=true;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 150
column: 8
content: for(uint256j=0;j<ticketTransfereesAmount[msg.sender]&&!transferee;j++){if(ticketTransferees[msg.sender][j]==transferID){transferee=true;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 159
column: 8
content: for(uint256i=0;i<ticketTransfersPerAmount[transferID];i++){price+=ticketPrices[ticketTransfers[transferID][i]];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 163
column: 12
content: for(i=0;i<ticketTransfersPerAmount[transferID];i++){ticketsOwned[ticketTransfers[transferID][i]]=msg.sender;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 173
column: 8
content: for(uint256i=0;i<ticketTransferersAmount[transferer];i++){for(uint256j=0;j<ticketTransfereesAmount[transferee];j++){if(ticketTransferers[transferer][i]==ticketTransferees[transferee][j]){returnticketTransferees[transferee][j];}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 174
column: 12
content: for(uint256j=0;j<ticketTransfereesAmount[transferee];j++){if(ticketTransferers[transferer][i]==ticketTransferees[transferee][j]){returnticketTransferees[transferee][j];}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 186
column: 16
content: for(uint256i=0;i<noOfTicketsOwned[msg.sender];i++){if(ticketsOwners[msg.sender][i]==ticketID){ticketsOwners[msg.sender][i]=100000000000000000;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 204
column: 12
content: for(uint256i=0;i<noOfSeats;i++){ticketPrices[i]=seats[i];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 232
column: 12
content: for(uint256i=0;i<noOfreservations[msg.sender];i++){ticketsOwners[msg.sender].push(reservations[msg.sender][i]);}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 49
column: 8
content: if(noOfreservations[msg.sender]!=0&&!banned[msg.sender]){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 55
column: 12
content: if(ticketsOwned[seats[i]]!=0x0){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 71
column: 8
content: if(noOfreservations[requester]==0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 121
column: 8
content: if(amount>0&&getTransfer(msg.sender,transferee)!=100000000000000000){for(uint256i=0;i<amount;i++){ticketTransfers[ticketTransfersAmount].push(ticks[i]);}ticketTransferers[msg.sender][ticketTransferersAmount[msg.sender]++]=ticketTransfersAmount;ticketTransferees[transferee][ticketTransfereesAmount[transferee]++]=ticketTransfersAmount;ticketTransfersPerAmount[ticketTransfersAmount]=amount;TransferStarted(msg.sender,transferee,ticks,ticketTransfersAmount++);}else{revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 141
column: 8
content: if(transferer){ticketTransfers[transferID]=newuint256[](0);}else{revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 155
column: 8
content: if(!transferee){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 162
column: 8
content: if(msg.value==price){for(i=0;i<ticketTransfersPerAmount[transferID];i++){ticketsOwned[ticketTransfers[transferID][i]]=msg.sender;}Transferred(transferID);}else{revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 184
column: 8
content: if(now<eventDate){if(ticketsOwned[ticketID]==msg.sender){for(uint256i=0;i<noOfTicketsOwned[msg.sender];i++){if(ticketsOwners[msg.sender][i]==ticketID){ticketsOwners[msg.sender][i]=100000000000000000;}}ticketsOwned[ticketID]=0x0;noOfTicketsOwned[msg.sender]--;msg.sender.send(ticketPrices[ticketID]);}else{revert();}}else{revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 185
column: 12
content: if(ticketsOwned[ticketID]==msg.sender){for(uint256i=0;i<noOfTicketsOwned[msg.sender];i++){if(ticketsOwners[msg.sender][i]==ticketID){ticketsOwners[msg.sender][i]=100000000000000000;}}ticketsOwned[ticketID]=0x0;noOfTicketsOwned[msg.sender]--;msg.sender.send(ticketPrices[ticketID]);}else{revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 203
column: 8
content: if(nOfSeats==noOfSeats){for(uint256i=0;i<noOfSeats;i++){ticketPrices[i]=seats[i];}}else{revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 221
column: 8
content: if(msg.sender==owner){if(now>eventDate){owner.send(this.balance);}}else{revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 231
column: 8
content: if(msg.value==priceOfreservations[msg.sender]&&!banned[msg.sender]){for(uint256i=0;i<noOfreservations[msg.sender];i++){ticketsOwners[msg.sender].push(reservations[msg.sender][i]);}resetReservations(msg.sender,false);Confirmed(msg.sender);}else{revert();}

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 193
column: 27
content: send(ticketPrices[ticketID])

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 223
column: 22
content: send(this.balance)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 38
column: 4
content: functiontickets(uint256[]ticks,uint256nOfSeats,stringn,uint256eD){for(uint256i=0;i<nOfSeats;i++){ticketPrices[i]=ticks[i];}noOfSeats=nOfSeats;name=n;owner=msg.sender;eventDate=eD;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 48
column: 4
content: functionreserveSeats(uint256[]seats,uint256nOfSeats){if(noOfreservations[msg.sender]!=0&&!banned[msg.sender]){revert();}resetReservationsInternal();uint256price=0;for(uint256i=0;i<nOfSeats;i++){if(ticketsOwned[seats[i]]!=0x0){revert();}reservations[msg.sender].push(seats[i]);price+=ticketPrices[seats[i]];ticketsOwned[seats[i]]=msg.sender;}noOfreservations[msg.sender]=nOfSeats;timeOfreservations[msg.sender]=now;priceOfreservations[msg.sender]=price;noOfTicketsOwned[msg.sender]++;highestAddressReserving++;Reserved(msg.sender,seats);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 70
column: 4
content: functionresetReservations(addressrequester,boolresetOwn){if(noOfreservations[requester]==0){throw;}for(uint256i=0;i<noOfreservations[requester]&&resetOwn;i++){ticketsOwned[reservations[requester][i]]=0x0;noOfTicketsOwned[msg.sender]--;}reservations[requester]=newuint256[](0);noOfreservations[requester]=0;timeOfreservations[requester]=0;priceOfreservations[requester]=0;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 103
column: 4
content: functionrevokeTickets(addressrevokee,boolpayback)payable{if(msg.sender==owner){banned[revokee]=true;uint256price=0;for(uint256i=0;i<noOfTicketsOwned[revokee];i++){ticketsOwned[ticketsOwners[revokee][i]]=0x0;price+=ticketPrices[ticketsOwners[revokee][i]];}ticketsOwners[revokee]=newuint256[](0);noOfTicketsOwned[revokee]=0;if(payback){revokee.send(price);}Banned(revokee,payback);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 120
column: 4
content: functionInvokeTransfer(addresstransferee,uint256[]ticks,uint256amount){if(amount>0&&getTransfer(msg.sender,transferee)!=100000000000000000){for(uint256i=0;i<amount;i++){ticketTransfers[ticketTransfersAmount].push(ticks[i]);}ticketTransferers[msg.sender][ticketTransferersAmount[msg.sender]++]=ticketTransfersAmount;ticketTransferees[transferee][ticketTransfereesAmount[transferee]++]=ticketTransfersAmount;ticketTransfersPerAmount[ticketTransfersAmount]=amount;TransferStarted(msg.sender,transferee,ticks,ticketTransfersAmount++);}else{revert();}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 134
column: 4
content: functionremoveTransfer(uint256transferID){booltransferer=false;for(uint256i=0;i<ticketTransferersAmount[msg.sender]&&!transferer;i++){if(ticketTransferers[msg.sender][i]==transferID){transferer=true;}}if(transferer){ticketTransfers[transferID]=newuint256[](0);}else{revert();}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 148
column: 4
content: functionfinishTransfer(uint256transferID)payable{booltransferee=false;for(uint256j=0;j<ticketTransfereesAmount[msg.sender]&&!transferee;j++){if(ticketTransferees[msg.sender][j]==transferID){transferee=true;}}if(!transferee){revert();}uint256price=0;for(uint256i=0;i<ticketTransfersPerAmount[transferID];i++){price+=ticketPrices[ticketTransfers[transferID][i]];}if(msg.value==price){for(i=0;i<ticketTransfersPerAmount[transferID];i++){ticketsOwned[ticketTransfers[transferID][i]]=msg.sender;}Transferred(transferID);}else{revert();}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 172
column: 4
content: functiongetTransfer(addresstransferer,addresstransferee)returns(uint256){for(uint256i=0;i<ticketTransferersAmount[transferer];i++){for(uint256j=0;j<ticketTransfereesAmount[transferee];j++){if(ticketTransferers[transferer][i]==ticketTransferees[transferee][j]){returnticketTransferees[transferee][j];}}}return100000000000000000;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 183
column: 4
content: functionreturnTickets(uint256ticketID){if(now<eventDate){if(ticketsOwned[ticketID]==msg.sender){for(uint256i=0;i<noOfTicketsOwned[msg.sender];i++){if(ticketsOwners[msg.sender][i]==ticketID){ticketsOwners[msg.sender][i]=100000000000000000;}}ticketsOwned[ticketID]=0x0;noOfTicketsOwned[msg.sender]--;msg.sender.send(ticketPrices[ticketID]);}else{revert();}}else{revert();}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 202
column: 4
content: functionchangePrice(uint256[]seats,uint256nOfSeats){if(nOfSeats==noOfSeats){for(uint256i=0;i<noOfSeats;i++){ticketPrices[i]=seats[i];}}else{revert();}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 212
column: 4
content: functionsetHash(bytes32hash){hashes[msg.sender]=hash;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 216
column: 4
content: functioncheckHash(addressa,stringpassword)constantreturns(bool){returnhashes[a]!=""&&hashes[a]==sha3(password);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 220
column: 4
content: functionend(){if(msg.sender==owner){if(now>eventDate){owner.send(this.balance);}}else{revert();}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 230
column: 4
content: function()payable{if(msg.value==priceOfreservations[msg.sender]&&!banned[msg.sender]){for(uint256i=0;i<noOfreservations[msg.sender];i++){ticketsOwners[msg.sender].push(reservations[msg.sender][i]);}resetReservations(msg.sender,false);Confirmed(msg.sender);}else{revert();}}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 36
column: 4
content: uint256eventDate;

SOLIDITY_VISIBILITY :15
SOLIDITY_DEPRECATED_CONSTRUCTIONS :3
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_REVERT_REQUIRE :12
SOLIDITY_SEND :2
SOLIDITY_EXTRA_GAS_IN_LOOPS :12
SOLIDITY_ADDRESS_HARDCODED :3