{
  "contract": "0xb891c4d89c1bf012f0014f56ce523f248a07f714",
  "tool": "smartcheck",
  "start": 1563623962.2733295,
  "end": 1563623976.0062556,
  "duration": 13.7329261302948,
  "analysis": [
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 293,
      "column": 46,
      "content": "0x01ffc9a7"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 331,
      "column": 28,
      "content": "0xffffffff"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 547,
      "column": 36,
      "content": "0x89885a59"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 548,
      "column": 36,
      "content": "0xeadb80b8"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 565,
      "column": 40,
      "content": "0xf0b9e5ba"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 567,
      "column": 40,
      "content": "0x150b7a02"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 574,
      "column": 40,
      "content": "0x520bdcbe"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 612,
      "column": 53,
      "content": "0xeadb80b8"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 652,
      "column": 44,
      "content": "0x89885a59"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 664,
      "column": 46,
      "content": "0x6352211e"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 750,
      "column": 53,
      "content": "0x0da719ec"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 909,
      "column": 51,
      "content": "0x095ea7b3"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 1079,
      "column": 53,
      "content": "0xdd62ed3e"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 1144,
      "column": 57,
      "content": "0x780e9d63"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 1151,
      "column": 55,
      "content": "0x5b5e139f"
    },
    {
      "name": "SOLIDITY_ARRAY_LENGTH_MANIPULATION",
      "patternId": "872bdd",
      "severity": 1,
      "line": 444,
      "column": 4,
      "content": "operators.length-=1"
    },
    {
      "name": "SOLIDITY_ARRAY_LENGTH_MANIPULATION",
      "patternId": "872bdd",
      "severity": 1,
      "line": 455,
      "column": 4,
      "content": "operators.length=0"
    },
    {
      "name": "SOLIDITY_ARRAY_LENGTH_MANIPULATION",
      "patternId": "872bdd",
      "severity": 1,
      "line": 957,
      "column": 4,
      "content": "childTokens[_tokenId][_childContract].length--"
    },
    {
      "name": "SOLIDITY_ARRAY_LENGTH_MANIPULATION",
      "patternId": "872bdd",
      "severity": 1,
      "line": 971,
      "column": 6,
      "content": "childContracts[_tokenId].length--"
    },
    {
      "name": "SOLIDITY_ARRAY_LENGTH_MANIPULATION",
      "patternId": "872bdd",
      "severity": 1,
      "line": 1040,
      "column": 6,
      "content": "erc223Contracts[_tokenId].length--"
    },
    {
      "name": "SOLIDITY_ARRAY_LENGTH_MANIPULATION",
      "patternId": "872bdd",
      "severity": 1,
      "line": 1284,
      "column": 4,
      "content": "ownedTokens[_from].length--"
    },
    {
      "name": "SOLIDITY_ERC20_APPROVE",
      "patternId": "af782c",
      "severity": 2,
      "line": 689,
      "column": 2,
      "content": "functionapprove(address_approved,uint256_tokenId)externalwhenNotPaused{addresstokenOwner=tokenIdToTokenOwner[_tokenId];addressrootOwner=_ownerOf(_tokenId);require(tokenOwner!=address(0));require(rootOwner==msg.sender||tokenOwnerToOperators[rootOwner][msg.sender]||tokenOwner==msg.sender||tokenOwnerToOperators[tokenOwner][msg.sender]);rootOwnerAndTokenIdToApprovedAddress[rootOwner][_tokenId]=_approved;emitApproval(rootOwner,_approved,_tokenId);}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 439,
      "column": 4,
      "content": "for(uinti=0;i<operators.length;i++){if(operators[i]==_operator){operators[i]=lastOperator;}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 452,
      "column": 4,
      "content": "for(uinti=0;i<operators.length;i++){isOperator[operators[i]]=false;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 1406,
      "column": 4,
      "content": "for(uint256i=0;i<tokens.length;++i){if(AvatarChildService(_childContract).compareItemSlots(tokens[i],_childTokenId)){_transferChild(_owner,_childContract,tokens[i]);}}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 439,
      "column": 4,
      "content": "for(uinti=0;i<operators.length;i++){if(operators[i]==_operator){operators[i]=lastOperator;}}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 452,
      "column": 4,
      "content": "for(uinti=0;i<operators.length;i++){isOperator[operators[i]]=false;}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 1376,
      "column": 4,
      "content": "for(uint8i=0;i<_len;++i){uint256childTokenId=_childTokenIds[i];require(ERC721(_childContract).ownerOf(childTokenId)==tokenOwner);_getChild(msg.sender,_tokenId,_childContract,childTokenId);}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 1389,
      "column": 4,
      "content": "for(uint8i=0;i<len;++i){uint256childTokenId=_childTokenIds[i];_transferChild(msg.sender,_childContract,childTokenId);}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 1406,
      "column": 4,
      "content": "for(uint256i=0;i<tokens.length;++i){if(AvatarChildService(_childContract).compareItemSlots(tokens[i],_childTokenId)){_transferChild(_owner,_childContract,tokens[i]);}}"
    },
    {
      "name": "SOLIDITY_LOCKED_MONEY",
      "patternId": "30281d",
      "severity": 3,
      "line": 1312,
      "column": 0,
      "content": "contractAvatarTokenisERC998TopDownToken,AvatarService{usingUrlStrforstring;eventBatchMount(addressindexedfrom,uint256parent,addressindexedchildAddr,uint256[]children);eventBatchUnmount(addressindexedfrom,uint256parent,addressindexedchildAddr,uint256[]children);structAvatar{stringname;uint256dna;}stringinternalBASE_URL=\"https://www.bitguild.com/bitizens/api/avatar/getAvatar/00000000\";Avatar[]avatars;functioncreateAvatar(address_owner,string_name,uint256_dna)externalonlyOperatorreturns(uint256){return_createAvatar(_owner,_name,_dna);}functiongetMountTokenIds(address_owner,uint256_tokenId,address_avatarItemAddress)externalviewonlyOperatorexistsToken(_tokenId)returns(uint256[]){require(tokenIdToTokenOwner[_tokenId]==_owner);returnchildTokens[_tokenId][_avatarItemAddress];}functionupdateAvatarInfo(address_owner,uint256_tokenId,string_name,uint256_dna)externalonlyOperatorexistsToken(_tokenId){require(_owner!=address(0),\"Invalid address\");require(_owner==tokenIdToTokenOwner[_tokenId]||msg.sender==owner);Avatarstorageavatar=avatars[allTokensIndex[_tokenId]];avatar.name=_name;avatar.dna=_dna;}functionupdateBaseURI(string_url)externalonlyOperator{BASE_URL=_url;}functiontokenURI(uint256_tokenId)externalviewexistsToken(_tokenId)returns(string){returnBASE_URL.generateUrl(_tokenId);}functiongetOwnedTokenIds(address_owner)externalviewreturns(uint256[]_tokenIds){_tokenIds=ownedTokens[_owner];}functiongetAvatarInfo(uint256_tokenId)externalviewexistsToken(_tokenId)returns(string_name,uint256_dna){Avatarstorageavatar=avatars[allTokensIndex[_tokenId]];_name=avatar.name;_dna=avatar.dna;}functionbatchMount(address_childContract,uint256[]_childTokenIds,uint256_tokenId)external{uint256_len=_childTokenIds.length;require(_len>0,\"No token need to mount\");addresstokenOwner=_ownerOf(_tokenId);require(tokenOwner==msg.sender);for(uint8i=0;i<_len;++i){uint256childTokenId=_childTokenIds[i];require(ERC721(_childContract).ownerOf(childTokenId)==tokenOwner);_getChild(msg.sender,_tokenId,_childContract,childTokenId);}emitBatchMount(msg.sender,_tokenId,_childContract,_childTokenIds);}functionbatchUnmount(address_childContract,uint256[]_childTokenIds,uint256_tokenId)external{uint256len=_childTokenIds.length;require(len>0,\"No token need to unmount\");addresstokenOwner=_ownerOf(_tokenId);require(tokenOwner==msg.sender);for(uint8i=0;i<len;++i){uint256childTokenId=_childTokenIds[i];_transferChild(msg.sender,_childContract,childTokenId);}emitBatchUnmount(msg.sender,_tokenId,_childContract,_childTokenIds);}function_createAvatar(address_owner,string_name,uint256_dna)privatereturns(uint256_tokenId){require(_owner!=address(0));Avatarmemoryavatar=Avatar(_name,_dna);_tokenId=avatars.push(avatar);_mint(_owner,_tokenId);}function_unmountSameSocketItem(address_owner,uint256_tokenId,address_childContract,uint256_childTokenId)internal{uint256[]storagetokens=childTokens[_tokenId][_childContract];for(uint256i=0;i<tokens.length;++i){if(AvatarChildService(_childContract).compareItemSlots(tokens[i],_childTokenId)){_transferChild(_owner,_childContract,tokens[i]);}}}function_transfer(address_from,address_to,uint256_tokenId)internalwhenNotPaused{require(tokenOwnerToTokenCount[_from]>1);super._transfer(_from,_to,_tokenId);}function_getChild(address_from,uint256_tokenId,address_childContract,uint256_childTokenId)internal{_unmountSameSocketItem(_from,_tokenId,_childContract,_childTokenId);super._getChild(_from,_tokenId,_childContract,_childTokenId);}function()externalpayable{revert();}}"
    },
    {
      "name": "SOLIDITY_PRAGMAS_VERSION",
      "patternId": "23fc32",
      "severity": 1,
      "line": 1,
      "column": 16,
      "content": "^"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 1144,
      "column": 9,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 1151,
      "column": 9,
      "content": "private"
    },
    {
      "name": "SOLIDITY_REDUNDANT_FALLBACK_REJECT",
      "patternId": "b85a32",
      "severity": 1,
      "line": 1428,
      "column": 31,
      "content": "{revert();}"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 1142,
      "column": 2,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 65,
      "column": 2,
      "content": "functionisContract(addressaddr)internalviewreturns(bool){uint256size;assembly{size:=extcodesize(addr)}returnsize>0;}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 597,
      "column": 2,
      "content": "functionisContract(address_addr)internalviewreturns(bool){uint256size;assembly{size:=extcodesize(_addr)}returnsize>0;}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 603,
      "column": 2,
      "content": "functiontokenOwnerOf(uint256_tokenId)externalviewreturns(addresstokenOwner,uint256parentTokenId,uint256isParent){tokenOwner=tokenIdToTokenOwner[_tokenId];require(tokenOwner!=address(0));if(tokenOwner==address(this)){(parentTokenId,isParent)=ownerOfChild(address(this),_tokenId);}else{boolcallSuccess;bytesmemorycalldata=abi.encodeWithSelector(0xeadb80b8,address(this),_tokenId);assembly{callSuccess:=staticcall(gas,tokenOwner,add(calldata,0x20),mload(calldata),calldata,0x40)ifcallSuccess{parentTokenId:=mload(calldata)isParent:=mload(add(calldata,0x20))}}if(callSuccess&&isParent>>8==OWNER_OF_CHILD){isParent=TOKEN_OWNER_OF<<8|uint8(isParent);}else{isParent=TOKEN_OWNER_OF<<8;parentTokenId=0;}}return(tokenOwner,parentTokenId,isParent);}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 636,
      "column": 2,
      "content": "function_ownerOf(uint256_tokenId)internalviewreturns(addressrootOwner){rootOwner=tokenIdToTokenOwner[_tokenId];require(rootOwner!=address(0));uint256isParent=1;boolcallSuccess;bytesmemorycalldata;while(uint8(isParent)>0){if(rootOwner==address(this)){(_tokenId,isParent)=ownerOfChild(address(this),_tokenId);if(uint8(isParent)>0){rootOwner=tokenIdToTokenOwner[_tokenId];}}else{if(isContract(rootOwner)){calldata=abi.encodeWithSelector(0x89885a59,_tokenId);assembly{callSuccess:=staticcall(gas,rootOwner,add(calldata,0x20),mload(calldata),calldata,0x60)ifcallSuccess{rootOwner:=mload(calldata)_tokenId:=mload(add(calldata,0x20))isParent:=mload(add(calldata,0x40))}}if(callSuccess==false||isParent>>8!=TOKEN_OWNER_OF){calldata=abi.encodeWithSelector(0x6352211e,_tokenId);assembly{callSuccess:=staticcall(gas,rootOwner,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}require(callSuccess,\"rootOwnerOf failed\");isParent=0;}}else{isParent=0;}}}returnrootOwner;}"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 84,
      "column": 23,
      "content": "stringurl"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 84,
      "column": 75,
      "content": "string_url"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1253,
      "column": 42,
      "content": "string_uri"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1397,
      "column": 41,
      "content": "string_name"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 613,
      "column": 6,
      "content": "assembly{callSuccess:=staticcall(gas,tokenOwner,add(calldata,0x20),mload(calldata),calldata,0x40)ifcallSuccess{parentTokenId:=mload(calldata)isParent:=mload(add(calldata,0x20))}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 653,
      "column": 10,
      "content": "assembly{callSuccess:=staticcall(gas,rootOwner,add(calldata,0x20),mload(calldata),calldata,0x60)ifcallSuccess{rootOwner:=mload(calldata)_tokenId:=mload(add(calldata,0x20))isParent:=mload(add(calldata,0x40))}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 665,
      "column": 12,
      "content": "assembly{callSuccess:=staticcall(gas,rootOwner,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 751,
      "column": 6,
      "content": "assembly{letsuccess:=call(gas,_from,0,add(calldata,0x20),mload(calldata),calldata,0)}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 849,
      "column": 4,
      "content": "assembly{tokenId:=calldataload(132)}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 876,
      "column": 4,
      "content": "assembly{tokenId:=calldataload(164)}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 910,
      "column": 4,
      "content": "assembly{letsuccess:=call(gas,_childContract,0,add(calldata,0x20),mload(calldata),calldata,0)}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 1081,
      "column": 6,
      "content": "assembly{callSuccess:=staticcall(gas,_erc223Contract,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{remaining:=mload(calldata)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 1119,
      "column": 4,
      "content": "assembly{tokenId:=calldataload(132)}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 467,
      "column": 2,
      "content": "mapping(address=>bool)frozenAccount;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 547,
      "column": 2,
      "content": "uint256constantTOKEN_OWNER_OF=0x89885a59;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 548,
      "column": 2,
      "content": "uint256constantOWNER_OF_CHILD=0xeadb80b8;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 565,
      "column": 2,
      "content": "bytes4constantERC721_RECEIVED_OLD=0xf0b9e5ba;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 567,
      "column": 2,
      "content": "bytes4constantERC721_RECEIVED_NEW=0x150b7a02;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 574,
      "column": 2,
      "content": "bytes4constantInterfaceId_ERC998=0x520bdcbe;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1012,
      "column": 2,
      "content": "mapping(uint256=>address[])erc223Contracts;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1015,
      "column": 2,
      "content": "mapping(uint256=>mapping(address=>uint256))erc223ContractIndex;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1018,
      "column": 2,
      "content": "mapping(uint256=>mapping(address=>uint256))erc223Balances;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1329,
      "column": 2,
      "content": "Avatar[]avatars;"
    }
  ]
}