{
  "contract": "0x957b80e735147696a80e69b61ab70d946e0ddd98",
  "tool": "smartcheck",
  "start": 1563530345.139536,
  "end": 1563530359.9395442,
  "duration": 14.800008296966553,
  "analysis": [
    {
      "name": "SOLIDITY_DIV_MUL",
      "patternId": "09hhh1",
      "severity": 2,
      "line": 529,
      "column": 23,
      "content": "(((price-1)/tick)+1)*tick"
    },
    {
      "name": "SOLIDITY_DIV_MUL",
      "patternId": "09hhh1",
      "severity": 2,
      "line": 531,
      "column": 23,
      "content": "(price/tick)*tick"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 130,
      "column": 8,
      "content": "for(uint32i=1;i<=lastOwnerId;i++){owners[i-1]=id_owner[i];ownerIds[i-1]=i;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 235,
      "column": 8,
      "content": "for(uint32i=1;i<=lastProductId;i++){products[i-1]=prCode_product[i];productIds[i-1]=i;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 1005,
      "column": 8,
      "content": "for(uint32i=0;i<id.length;i++){cancelOrder(id[i]);}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 1078,
      "column": 8,
      "content": "for(uint32i=1;i<=lastAcccountId;i++){if(exId_prCode_AccountId_Balance[exId][prCode][i].available+exId_prCode_AccountId_Balance[exId][prCode][i].reserved>minQty)n++;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 1088,
      "column": 8,
      "content": "for(i=1;i<=lastAcccountId;i++){temp=exId_prCode_AccountId_Balance[exId][prCode][i].available+exId_prCode_AccountId_Balance[exId][prCode][i].reserved;if(temp>=minQty){accountId[n]=i;balanceSum[n++]=temp;}}"
    },
    {
      "name": "SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN",
      "patternId": "47acc2",
      "severity": 1,
      "line": 1052,
      "column": 4,
      "content": "functioncheckAnnounceLV(uint32accountId,uint8LV)privateviewreturns(bool){require(accountId==account_id[msg.sender]||id_announceLV[accountId]>=LV||msg.sender==operator||owner_id[msg.sender]!=0);}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 159,
      "column": 8,
      "content": "for(uint32i=0;i<n;i++){sum+=qtys[i];}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 166,
      "column": 8,
      "content": "for(i=0;i<n;i++){exId_prCode_AccountId_Balance[exId][prCode][accountIds[i]].available+=qtys[i];}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 1005,
      "column": 8,
      "content": "for(uint32i=0;i<id.length;i++){cancelOrder(id[i]);}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 1067,
      "column": 8,
      "content": "for(uint32i=0;i<n;i++){available[i]=exId_prCode_AccountId_Balance[exId][prCode[i]][accountId].available;reserved[i]=exId_prCode_AccountId_Balance[exId][prCode[i]][accountId].reserved;}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 1106,
      "column": 8,
      "content": "for(uint256i=0;i<n;i++){OrderBookmemoryorderBook=basePID_tradePID_orderBook[prBase][prTrade[i]];bestBidPrice[i]=orderBook.bestBidPrice;bestAskPrice[i]=orderBook.bestAskPrice;}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 559,
      "column": 19,
      "content": "priceTenPercent>tick"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 564,
      "column": 19,
      "content": "priceTenPercent<tick"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 655,
      "column": 27,
      "content": "priceNext!=0&&priceNext<price"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 692,
      "column": 27,
      "content": "priceNext!=0&&priceNext>price"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 825,
      "column": 15,
      "content": "tradePrice!=0&&order.qty>0&&((order.isSell&&order.price<=tradePrice)||(!order.isSell&&order.price>=tradePrice))"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 834,
      "column": 19,
      "content": "orderLink.firstId!=0&&orderId!=0&&order.qty!=0"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 1152,
      "column": 19,
      "content": "id!=0&&i<orderN"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 1190,
      "column": 15,
      "content": "id0!=0&&orderN>n"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 1225,
      "column": 19,
      "content": "price!=0&&n<hogaN"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 1247,
      "column": 23,
      "content": "n<hogaN"
    },
    {
      "name": "SOLIDITY_PRAGMAS_VERSION",
      "patternId": "23fc32",
      "severity": 1,
      "line": 1,
      "column": 16,
      "content": "^"
    },
    {
      "name": "SOLIDITY_SEND",
      "patternId": 430636,
      "severity": 1,
      "line": 479,
      "column": 27,
      "content": "send(amount)"
    },
    {
      "name": "SOLIDITY_SEND",
      "patternId": 430636,
      "severity": 1,
      "line": 516,
      "column": 31,
      "content": "send(amount)"
    },
    {
      "name": "SOLIDITY_SHOULD_RETURN_STRUCT",
      "patternId": "7d54ca",
      "severity": 1,
      "line": 1207,
      "column": 91,
      "content": "(uint80[]prices,uint104[]volumes)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 125,
      "column": 49,
      "content": "address[]owners"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 125,
      "column": 67,
      "content": "uint32[]ownerIds"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 151,
      "column": 49,
      "content": "uint32[]accountIds"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 151,
      "column": 70,
      "content": "uint104[]qtys"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 230,
      "column": 51,
      "content": "address[]products"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 230,
      "column": 71,
      "content": "uint32[]productIds"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 440,
      "column": 88,
      "content": "uint32[]prCode"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 440,
      "column": 105,
      "content": "bool[]isDeposit"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 440,
      "column": 123,
      "content": "uint128[]qty"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 440,
      "column": 138,
      "content": "uint64[]timestamp"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 741,
      "column": 44,
      "content": "Orderorder"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 899,
      "column": 36,
      "content": "Orderorder"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 899,
      "column": 49,
      "content": "OrdermatchingOrder"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1003,
      "column": 26,
      "content": "uint32[]id"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1057,
      "column": 37,
      "content": "uint32[]prCode"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1057,
      "column": 93,
      "content": "uint128[]available"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1057,
      "column": 114,
      "content": "uint128[]reserved"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1074,
      "column": 98,
      "content": "uint32[]accountId"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1074,
      "column": 118,
      "content": "uint128[]balanceSum"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1100,
      "column": 30,
      "content": "uint32[]prTrade"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1100,
      "column": 84,
      "content": "uint80[]bestBidPrice"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1100,
      "column": 107,
      "content": "uint80[]bestAskPrice"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1131,
      "column": 92,
      "content": "uint32[]orderId"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1131,
      "column": 110,
      "content": "uint32[]prTrade"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1131,
      "column": 128,
      "content": "uint32[]prBase"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1131,
      "column": 145,
      "content": "bool[]sells"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1131,
      "column": 159,
      "content": "uint80[]prices"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1131,
      "column": 176,
      "content": "uint104[]qtys"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1172,
      "column": 121,
      "content": "uint32[]orderIds"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1198,
      "column": 87,
      "content": "uint80[]priceB"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1198,
      "column": 104,
      "content": "uint104[]volumeB"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1198,
      "column": 123,
      "content": "uint80[]priceA"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1198,
      "column": 140,
      "content": "uint104[]volumeA"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1207,
      "column": 92,
      "content": "uint80[]prices"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 1207,
      "column": 109,
      "content": "uint104[]volumes"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 102,
      "column": 4,
      "content": "mapping(uint32=>address)id_owner;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 103,
      "column": 4,
      "content": "mapping(address=>uint32)owner_id;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 104,
      "column": 4,
      "content": "mapping(uint32=>uint8)ownerId_takerFeeRateLocal;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 105,
      "column": 4,
      "content": "mapping(uint32=>uint32)ownerId_accountId;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 189,
      "column": 4,
      "content": "mapping(uint32=>address)prCode_product;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 190,
      "column": 4,
      "content": "mapping(address=>uint32)product_prCode;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 191,
      "column": 4,
      "content": "mapping(uint32=>ProductInfo)prCode_productInfo;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 256,
      "column": 4,
      "content": "mapping(uint32=>uint8)id_announceLV;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 259,
      "column": 4,
      "content": "mapping(uint32=>address)id_account;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 260,
      "column": 4,
      "content": "mapping(uint32=>bool)accountId_freeze;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 261,
      "column": 4,
      "content": "mapping(address=>uint32)account_id;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 345,
      "column": 4,
      "content": "mapping(uint32=>Order)id_Order;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 358,
      "column": 4,
      "content": "mapping(uint32=>mapping(uint32=>OrderBook))basePID_tradePID_orderBook;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 364,
      "column": 4,
      "content": "mapping(uint32=>mapping(uint32=>mapping(uint32=>Balance)))exId_prCode_AccountId_Balance;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 372,
      "column": 4,
      "content": "mapping(uint32=>OpenOrder)accountId_OpenOrder;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 421,
      "column": 4,
      "content": "mapping(uint32=>mapping(uint32=>DWrecords))exId_AccountId_DWrecords;"
    }
  ]
}