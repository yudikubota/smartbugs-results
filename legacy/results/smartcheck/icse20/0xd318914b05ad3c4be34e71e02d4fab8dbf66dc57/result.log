/unique_chucks/14/0xd318914b05ad3c4be34e71e02d4fab8dbf66dc57.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 222
column: 8
content: assets.length=_assets.length

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 4
column: 2
content: functiongetClosingTime(bytes32id)constantreturns(uint64value);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 11
column: 2
content: functionbalanceOf(addresswho)publicconstantreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 17
column: 2
content: functionallowance(addressowner,addressspender)publicconstantreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 24
column: 2
content: functionmul(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a*b;assert(a==0||c/a==b);returnc;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 30
column: 2
content: functiondiv(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a/b;returnc;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 37
column: 2
content: functionsub(uint256a,uint256b)internalconstantreturns(uint256){assert(b<=a);returna-b;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 42
column: 2
content: functionadd(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a+b;assert(c>=a);returnc;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 209
column: 4
content: functiongetAssets()publicconstantreturns(address[]){returnassets;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 392
column: 4
content: functionbucketExists(bytes32bucketId)publicconstantreturns(bool){returnbuckets[bucketId].exposures.length>0;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 396
column: 4
content: functioncalculateBucketId(bytes32[]exposures)publicconstantreturns(bytes32){returnsha256(this,exposures);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 404
column: 4
content: functionbucketHolding(bytes32_bucketId,address_asset)constantreturns(uint256){Bucketstoragebucket=buckets[_bucketId];returnbucket.holdings[_asset];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 409
column: 4
content: functionbucketValue(bytes32_bucketId)constantreturns(uint256){Bucketstoragebucket=buckets[_bucketId];returnbucket.value;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 414
column: 4
content: functionnumAssets()constantpublicreturns(uint256){returnassets.length;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 436
column: 4
content: functionbucketClosureTime(bytes32bucketId)constantpublicreturns(uint64){returnbuckets[bucketId].maxClosingTime;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 440
column: 4
content: functionisInPortfolioModel(addresstoken)constantprivatereturns(bool){returnmodel[token]!=0;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 584
column: 4
content: functiongetClosingTime(bytes32id)publiconlyPortfolioconstantreturns(uint64){Exposurestorageexposure=exposures[id];returnexposure.closingTime;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 640
column: 4
content: functionstatus(bytes32id)publicconstantreturns(uint8state){Exposurestorageexposure=exposures[id];state=uint8(exposure.state);if(exposure.state==State.Collected&&hasPassed(exposure.closingTime)){state=uint8(State.Closing);}}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 653
column: 4
content: functionexists(bytes32id)publicconstantreturns(bool){returnexposures[id].creationTime>0;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 657
column: 4
content: functioncheckRatio(uint256veriAmount,uint256value)publicconstantreturns(bool){uint256expectedValue=ratio.mul(veriAmount).div(1ether);returnvalue==expectedValue;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 666
column: 4
content: functioncalculateId(uint256veriAmount,uint256value,uint32duration,uint256nonce)publicconstantreturns(bytes32){returnsha256(this,msg.sender,value,veriAmount,duration,nonce);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 699
column: 4
content: functionopenExposure(bytes32id,uint256veriAmount,uint32duration)privateconstant{uint64creationTime=uint64(block.timestamp);uint64closingTime=uint64(block.timestamp.add(duration));exposures[id]=Exposure({account:msg.sender,veriAmount:veriAmount,initialValue:msg.value,finalValue:0,creationTime:creationTime,closingTime:closingTime,state:State.Open});ExposureOpened({id:id,account:msg.sender,creationTime:creationTime,closingTime:closingTime,veriAmount:veriAmount,value:msg.value});}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 725
column: 4
content: functionhasPassed(uint64time)privateconstantreturns(bool){returnblock.timestamp>=time;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 100
column: 4
content: for(uint256i=0;i<tokens.length;i++){ERC20Basictoken=ERC20Basic(tokens[i]);uint256balance=token.balanceOf(this);token.transfer(owner,balance);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 223
column: 8
content: for(uinti=0;i<assets.length;i++){assets[i]=_assets[i];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 240
column: 8
content: for(uint256i=0;i<_assets.length;i++){uint256alloc=_alloc[i];addressasset=_assets[i];total=total.add(alloc);model[asset]=alloc;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 265
column: 8
content: for(uint256i=0;i<exposureIds.length;i++){bytes32exposureId=exposureIds[i];uint64closureTime=collectibleExposure.getClosingTime(exposureId);if(bucket.maxClosingTime<closureTime){bucket.maxClosingTime=closureTime;}uint256value=collectibleExposure.collect(exposureId);bucket.exposures.push(ExposureInfo({exposureId:exposureId,value:value}));bucket.value+=value;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 296
column: 8
content: for(uint256i=0;i<bucket.exposures.length;i++){ExposureInfostorageexposure=bucket.exposures[i];finalValue+=exposure.value;collectibleExposure.close.value(exposure.value)(exposure.exposureId);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 421
column: 8
content: for(uint256i=0;i<assets.length;i++){deletemodel[assets[i]];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 431
column: 8
content: for(uint256i=0;i<assets.length;i++){require(_assets[i]==assets[i]);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 253
column: 4
content: functioncreateBucket(bytes32[]exposureIds)publiconlyBucketManagerreturns(bytes32){require(collectibleExposure!=address(0));require(exposureIds.length>0);bytes32bucketId=calculateBucketId(exposureIds);Bucketstoragebucket=buckets[bucketId];require(bucket.exposures.length==0);for(uint256i=0;i<exposureIds.length;i++){bytes32exposureId=exposureIds[i];uint64closureTime=collectibleExposure.getClosingTime(exposureId);if(bucket.maxClosingTime<closureTime){bucket.maxClosingTime=closureTime;}uint256value=collectibleExposure.collect(exposureId);bucket.exposures.push(ExposureInfo({exposureId:exposureId,value:value}));bucket.value+=value;}BucketCreated(bucketId,bucket.value,bucket.maxClosingTime);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 100
column: 4
content: for(uint256i=0;i<tokens.length;i++){ERC20Basictoken=ERC20Basic(tokens[i]);uint256balance=token.balanceOf(this);token.transfer(owner,balance);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 223
column: 8
content: for(uinti=0;i<assets.length;i++){assets[i]=_assets[i];}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 240
column: 8
content: for(uint256i=0;i<_assets.length;i++){uint256alloc=_alloc[i];addressasset=_assets[i];total=total.add(alloc);model[asset]=alloc;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 265
column: 8
content: for(uint256i=0;i<exposureIds.length;i++){bytes32exposureId=exposureIds[i];uint64closureTime=collectibleExposure.getClosingTime(exposureId);if(bucket.maxClosingTime<closureTime){bucket.maxClosingTime=closureTime;}uint256value=collectibleExposure.collect(exposureId);bucket.exposures.push(ExposureInfo({exposureId:exposureId,value:value}));bucket.value+=value;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 296
column: 8
content: for(uint256i=0;i<bucket.exposures.length;i++){ExposureInfostorageexposure=bucket.exposures[i];finalValue+=exposure.value;collectibleExposure.close.value(exposure.value)(exposure.exposureId);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 421
column: 8
content: for(uint256i=0;i<assets.length;i++){deletemodel[assets[i]];}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 431
column: 8
content: for(uint256i=0;i<assets.length;i++){require(_assets[i]==assets[i]);}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 3
column: 0
content: contractCollectibleExposure{functiongetClosingTime(bytes32id)constantreturns(uint64value);functioncollect(bytes32id)returns(uint256value);functionclose(bytes32id)payable;}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 734
column: 0
content: contractEDExecutor{functionbuyTokens(uint256orderEthAmount,addressorderToken,uint256orderTokenAmount,uint256orderExpires,uint256orderNonce,addressorderUser,uint8v,bytes32r,bytes32s)payablereturns(uint256tradedAmount,uint256leftoverEther);functionsellTokens(uint256orderEthAmount,addressorderToken,uint256orderTokenAmount,uint256orderExpires,uint256orderNonce,addressorderUser,uint8v,bytes32r,bytes32s)returns(uint256tradedValue,uint256leftoverTokens);}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 179
column: 4
content: functionsetCollectibleExposure(CollectibleExposure_collectibleExposure)onlyOwner{require(_collectibleExposure!=address(0));collectibleExposure=_collectibleExposure;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 185
column: 4
content: functionsetEtherDeltaExecutor(EDExecutor_etherDeltaExecutor)publiconlyOwner{require(_etherDeltaExecutor!=address(0));etherDeltaExecutor=_etherDeltaExecutor;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 191
column: 4
content: functionsetBucketManager(address_bucketManager)publiconlyOwner{require(_bucketManager!=address(0));bucketManager=_bucketManager;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 197
column: 4
content: functionsetPortfolioManager(address_portfolioManager)publiconlyOwner{require(_portfolioManager!=address(0));portfolioManager=_portfolioManager;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 203
column: 4
content: functionsetTrader(address_trader)publiconlyOwner{require(_trader!=address(0));trader=_trader;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 505
column: 4
content: functionsetPortfolio(address_portfolio)publiconlyOwner{require(_portfolio!=address(0));portfolio=_portfolio;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 511
column: 4
content: functionsetMinDuration(uint32_minDuration)publiconlyOwner{require(_minDuration>0&&_minDuration<=maxDuration);minDuration=_minDuration;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 517
column: 4
content: functionsetMaxDuration(uint32_maxDuration)publiconlyOwner{require(_maxDuration>=minDuration);maxDuration=_maxDuration;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 523
column: 4
content: functionsetMinVeriAmount(uint32_minVeriAmount)publiconlyOwner{require(_minVeriAmount>0&&_minVeriAmount<=maxVeriAmount);minVeriAmount=_minVeriAmount;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 529
column: 4
content: functionsetMaxVeriAmount(uint32_maxVeriAmount)publiconlyOwner{require(_maxVeriAmount>=minVeriAmount);maxVeriAmount=_maxVeriAmount;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 139
column: 32
content: private

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 115
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 449
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 688
column: 15
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 97
column: 19
content: address[]tokens

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 209
column: 50
content: address[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 219
column: 23
content: address[]_assets

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 233
column: 22
content: address[]_assets

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 233
column: 41
content: uint256[]_alloc

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 253
column: 26
content: bytes32[]exposureIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 396
column: 31
content: bytes32[]exposures

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 428
column: 27
content: address[]_assets

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 4
column: 2
content: functiongetClosingTime(bytes32id)constantreturns(uint64value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 5
column: 2
content: functioncollect(bytes32id)returns(uint256value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 6
column: 2
content: functionclose(bytes32id)payable;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 60
column: 2
content: functionOwnable(){owner=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 88
column: 2
content: functionTokenDestructible()payable{}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 147
column: 4
content: functionVePortfolio(){bucketManager=msg.sender;portfolioManager=msg.sender;trader=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 179
column: 4
content: functionsetCollectibleExposure(CollectibleExposure_collectibleExposure)onlyOwner{require(_collectibleExposure!=address(0));collectibleExposure=_collectibleExposure;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 309
column: 4
content: functionexecuteEtherDeltaBuy(uint256orderEthAmount,addressorderToken,uint256orderTokenAmount,uint256orderExpires,uint256orderNonce,addressorderUser,uint8v,bytes32r,bytes32s,bytes32bucketId,uint256amount)onlyTrader{require(buckets[bucketId].value>=amount);require(isInPortfolioModel(orderToken));uint256tradedAmount;uint256leftoverEther;(tradedAmount,leftoverEther)=etherDeltaExecutor.buyTokens.value(amount)(orderEthAmount,orderToken,orderTokenAmount,orderExpires,orderNonce,orderUser,v,r,s);buckets[bucketId].value-=(amount-leftoverEther);buckets[bucketId].holdings[orderToken]+=tradedAmount;BucketBuy(bucketId,(amount-leftoverEther),orderToken,tradedAmount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 348
column: 4
content: functionexecuteEtherDeltaSell(uint256orderEthAmount,addressorderToken,uint256orderTokenAmount,uint256orderExpires,uint256orderNonce,addressorderUser,uint8v,bytes32r,bytes32s,bytes32bucketId,uint256amount)onlyTrader{require(buckets[bucketId].holdings[orderToken]>=amount);uint256tradedValue;uint256leftoverTokens;ERC20(orderToken).transfer(etherDeltaExecutor,amount);(tradedValue,leftoverTokens)=etherDeltaExecutor.sellTokens(orderEthAmount,orderToken,orderTokenAmount,orderExpires,orderNonce,orderUser,v,r,s);buckets[bucketId].value+=tradedValue;buckets[bucketId].holdings[orderToken]-=(amount-leftoverTokens);BucketSell(bucketId,tradedValue,orderToken,(amount-leftoverTokens));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 386
column: 4
content: function()payable{}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 404
column: 4
content: functionbucketHolding(bytes32_bucketId,address_asset)constantreturns(uint256){Bucketstoragebucket=buckets[_bucketId];returnbucket.holdings[_asset];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 409
column: 4
content: functionbucketValue(bytes32_bucketId)constantreturns(uint256){Bucketstoragebucket=buckets[_bucketId];returnbucket.value;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 477
column: 4
content: functionVeExposure(ERC20_veToken,uint256_ratio,uint32_minDuration,uint32_maxDuration,uint256_minVeriAmount,uint256_maxVeriAmount){require(_veToken!=address(0));require(_minDuration>0&&_minDuration<=_maxDuration);require(_minVeriAmount>0&&_minVeriAmount<=_maxVeriAmount);veToken=_veToken;ratio=_ratio;minDuration=_minDuration;maxDuration=_maxDuration;minVeriAmount=_minVeriAmount;maxVeriAmount=_maxVeriAmount;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 735
column: 4
content: functionbuyTokens(uint256orderEthAmount,addressorderToken,uint256orderTokenAmount,uint256orderExpires,uint256orderNonce,addressorderUser,uint8v,bytes32r,bytes32s)payablereturns(uint256tradedAmount,uint256leftoverEther);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 747
column: 4
content: functionsellTokens(uint256orderEthAmount,addressorderToken,uint256orderTokenAmount,uint256orderExpires,uint256orderNonce,addressorderUser,uint8v,bytes32r,bytes32s)returns(uint256tradedValue,uint256leftoverTokens);

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 132
column: 4
content: CollectibleExposurecollectibleExposure;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 133
column: 4
content: EDExecutoretherDeltaExecutor;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 474
column: 4
content: mapping(bytes32=>Exposure)exposures;

SOLIDITY_VISIBILITY :18
SOLIDITY_SAFEMATH :2
SOLIDITY_OVERPOWERED_ROLE :10
SOLIDITY_DEPRECATED_CONSTRUCTIONS :22
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :1
SOLIDITY_LOCKED_MONEY :2
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :1
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :7
SOLIDITY_UPGRADE_TO_050 :9
SOLIDITY_GAS_LIMIT_IN_LOOPS :7