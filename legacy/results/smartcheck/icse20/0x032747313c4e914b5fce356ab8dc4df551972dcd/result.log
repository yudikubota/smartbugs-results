/unique_chucks/29/0x032747313c4e914b5fce356ab8dc4df551972dcd.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 73
column: 6
content: sellers.length=1

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 74
column: 6
content: transactions.length=1

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 118
column: 6
content: sellers.length+=1

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 141
column: 6
content: transactions.length+=1

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 99
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 114
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 137
column: 26
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 153
column: 70
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 161
column: 36
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 187
column: 70
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 189
column: 70
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 191
column: 46
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 193
column: 46
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 195
column: 48
content: throw

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 114
column: 6
content: if(etherPaid<registrationFee){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 137
column: 6
content: if(sellerId==0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 153
column: 6
content: if(transactionId<1||transactionId>=transactions.length){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 161
column: 6
content: if(etherPaid<etherNeeded){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 187
column: 6
content: if(transactions[transactionId].paidWithAddress!=msg.sender){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 189
column: 6
content: if(transactionId<1||transactionId>=transactions.length){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 191
column: 6
content: if(transactions[transactionId].rated){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 193
column: 6
content: if(!transactions[transactionId].paid){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 195
column: 6
content: if(ratingValue<1||ratingValue>10){throw;}

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 82
column: 12
content: send(this.balance)

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 166
column: 17
content: send(payback)

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 169
column: 65
content: send(etherAskedFor)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 69
column: 4
content: functionTrustEth(){owner=msg.sender;sellers.length=1;transactions.length=1;registrationFee=1ether;transactionFee=50finney;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 81
column: 4
content: functionretrieveFunds()onlyowner{owner.send(this.balance);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 85
column: 4
content: functionadjustRegistrationFee(uintfee)onlyowner{registrationFee=fee;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 89
column: 4
content: functionadjustTransactionFee(uintfee)onlyowner{transactionFee=fee;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 93
column: 4
content: functionsetOwner(address_owner)onlyowner{owner=_owner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 98
column: 4
content: function(){throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 103
column: 4
content: functiondonate(){return;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 110
column: 4
content: functionregister(){uintetherPaid=msg.value;if(etherPaid<registrationFee){throw;}uintsellerId=sellers.length;sellers.length+=1;sellers[sellerId].etherAddress=msg.sender;sellers[sellerId].averageRating=0;sellerLookup[msg.sender]=sellerId;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 132
column: 4
content: functionaskForEther(uintamount){uintsellerId=sellerLookup[msg.sender];if(sellerId==0){throw;}uinttransactionId=transactions.length;transactions.length+=1;transactions[transactionId].sellerId=sellerId;transactions[transactionId].amount=amount;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 151
column: 4
content: functionpayEther(uinttransactionId){if(transactionId<1||transactionId>=transactions.length){throw;}uintetherPaid=msg.value;uintetherAskedFor=transactions[transactionId].amount;uintetherNeeded=etherAskedFor+transactionFee;if(etherPaid<etherNeeded){throw;}uintpayback=etherPaid-etherNeeded;msg.sender.send(payback);sellers[transactions[transactionId].sellerId].etherAddress.send(etherAskedFor);sellers[transactions[transactionId].sellerId].transactionsPaid+=1;transactions[transactionId].paid=true;transactions[transactionId].paidWithAddress=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 185
column: 4
content: functionrate(uinttransactionId,uintratingValue,stringratingComment){if(transactions[transactionId].paidWithAddress!=msg.sender){throw;}if(transactionId<1||transactionId>=transactions.length){throw;}if(transactions[transactionId].rated){throw;}if(!transactions[transactionId].paid){throw;}if(ratingValue<1||ratingValue>10){throw;}transactions[transactionId].ratingValue=ratingValue;transactions[transactionId].ratingComment=ratingComment;transactions[transactionId].rated=true;uintpreviousTransactionCount=sellers[transactions[transactionId].sellerId].transactionsRated;uintpreviousTransactionRatingSum=sellers[transactions[transactionId].sellerId].averageRating*previousTransactionCount;sellers[transactions[transactionId].sellerId].averageRating=(previousTransactionRatingSum+ratingValue)/(previousTransactionCount+1);sellers[transactions[transactionId].sellerId].transactionsRated+=1;}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 56
column: 4
content: mapping(address=>uint)sellerLookup;

SOLIDITY_VISIBILITY :12
SOLIDITY_DEPRECATED_CONSTRUCTIONS :10
SOLIDITY_ARRAY_LENGTH_MANIPULATION :4
SOLIDITY_REVERT_REQUIRE :9
SOLIDITY_UNCHECKED_CALL :3