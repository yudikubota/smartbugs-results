{
  "contract": "0x1ff74c63d13ec97d85a55c672b6fc8a438d63877",
  "tool": "smartcheck",
  "start": 1563560279.5364156,
  "end": 1563560288.5116112,
  "duration": 8.97519564628601,
  "analysis": [
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 50,
      "column": 33,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 58,
      "column": 57,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 206,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 331,
      "column": 33,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 349,
      "column": 8,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 363,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 368,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 373,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 401,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 406,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 411,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 416,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 446,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 488,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 501,
      "column": 16,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 566,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 596,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 8,
      "column": 2,
      "content": "functionmul(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a*b;assert(a==0||c/a==b);returnc;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 14,
      "column": 2,
      "content": "functiondiv(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a/b;returnc;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 21,
      "column": 2,
      "content": "functionsub(uint256a,uint256b)internalconstantreturns(uint256){assert(b<=a);returna-b;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 26,
      "column": 2,
      "content": "functionadd(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a+b;assert(c>=a);returnc;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 80,
      "column": 4,
      "content": "functionbalanceOf(address_owner)constantreturns(uint256balance);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 104,
      "column": 4,
      "content": "functionallowance(address_owner,address_spender)constantreturns(uint256remaining);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 250,
      "column": 4,
      "content": "functiongetUnreadMessageCount(address_userAddress)constantreturns(uint256count){uint256unreadCount;for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==false){unreadCount++;}}returnunreadCount;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 268,
      "column": 4,
      "content": "functiongetUnreadMessages(address_userAddress)constantreturns(uint[]mmessages){for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==false){indexesUnread.push(unreadMessages[_userAddress][i].id);}}returnindexesUnread;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 279,
      "column": 4,
      "content": "functiongetUnreadMessagesArrayContent(uint256_number)publicconstantreturns(uint256,bool,address,uint256,uint256){for(uinta=0;a<unreadMessageCount[msg.sender];++a){if(unreadMessages[msg.sender][a].id==_number){return(unreadMessages[msg.sender][a].id,unreadMessages[msg.sender][a].isOpened,unreadMessages[msg.sender][a].from,unreadMessages[msg.sender][a].time,unreadMessages[msg.sender][a].weight);}}}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 293,
      "column": 4,
      "content": "functiongetReadMessages(address_userAddress)constantreturns(uint[]mmessages){for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==true){indexesRead.push(unreadMessages[_userAddress][i].id);}}returnindexesRead;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 341,
      "column": 4,
      "content": "functionbalanceOf(address_owner)constantreturns(uint256balance){returnbalances[_owner];}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 465,
      "column": 4,
      "content": "functionallowance(address_owner,address_spender)constantreturns(uint256remaining){returnallowed[_owner][_spender];}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 547,
      "column": 4,
      "content": "functiongetUnreadMessage(uint256_number)constantreturns(UnreadMessageunread){for(uinta=0;a<unreadMessages[msg.sender].length;++a){if(unreadMessages[msg.sender][a].id==_number){returnunreadMessages[msg.sender][a];}}}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 593,
      "column": 4,
      "content": "functiongetMail(uint256_number)constantreturns(bytes32message){UnreadMessagememorycurrentUnreadMessage=getUnreadMessage(_number);if(!currentUnreadMessage.isOpened||currentUnreadMessage.weight==0){throw;}returnmessages[_number].content;}"
    },
    {
      "name": "SOLIDITY_ERC20_APPROVE",
      "patternId": "af782c",
      "severity": 2,
      "line": 442,
      "column": 4,
      "content": "functionapprove(address_spender,uint256_value)returns(boolsuccess){if(locked){throw;}allowed[msg.sender][_spender]=_value;Approval(msg.sender,_spender,_value);returntrue;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 218,
      "column": 12,
      "content": "for(uinta=0;a<unreadMessages[recipient].length;++a){if(unreadMessages[recipient][a].id==_number){if(!unreadMessages[recipient][a].isOpened){unreadMessages[recipient][a].weight=0;unreadMessages[recipient][a].time=0;uint256value=messages[_number].weight.div(messages[_number].to.length);unreadMessageCount[recipient]--;balances[recipient]=balances[recipient].sub(value);if(!unreadMessages[recipient][a].free){usableBalances[messages[_number].from]=usableBalances[messages[_number].from].add(value);balances[messages[_number].from]=balances[messages[_number].from].add(value);}}break;}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 252,
      "column": 8,
      "content": "for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==false){unreadCount++;}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 269,
      "column": 8,
      "content": "for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==false){indexesUnread.push(unreadMessages[_userAddress][i].id);}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 280,
      "column": 8,
      "content": "for(uinta=0;a<unreadMessageCount[msg.sender];++a){if(unreadMessages[msg.sender][a].id==_number){return(unreadMessages[msg.sender][a].id,unreadMessages[msg.sender][a].isOpened,unreadMessages[msg.sender][a].from,unreadMessages[msg.sender][a].time,unreadMessages[msg.sender][a].weight);}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 294,
      "column": 8,
      "content": "for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==true){indexesRead.push(unreadMessages[_userAddress][i].id);}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 548,
      "column": 8,
      "content": "for(uinta=0;a<unreadMessages[msg.sender].length;++a){if(unreadMessages[msg.sender][a].id==_number){returnunreadMessages[msg.sender][a];}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 574,
      "column": 8,
      "content": "for(uinta=0;a<unreadMessages[msg.sender].length;++a){if(unreadMessages[msg.sender][a].id==_number){unreadMessages[msg.sender][a].isOpened=true;}}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "k4o1l4",
      "severity": 1,
      "line": 215,
      "column": 8,
      "content": "while(i<messages[_number].to.length){addressrecipient=messages[_number].to[i];for(uinta=0;a<unreadMessages[recipient].length;++a){if(unreadMessages[recipient][a].id==_number){if(!unreadMessages[recipient][a].isOpened){unreadMessages[recipient][a].weight=0;unreadMessages[recipient][a].time=0;uint256value=messages[_number].weight.div(messages[_number].to.length);unreadMessageCount[recipient]--;balances[recipient]=balances[recipient].sub(value);if(!unreadMessages[recipient][a].free){usableBalances[messages[_number].from]=usableBalances[messages[_number].from].add(value);balances[messages[_number].from]=balances[messages[_number].from].add(value);}}break;}}i++;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "k4o1l4",
      "severity": 1,
      "line": 519,
      "column": 8,
      "content": "while(i<_to.length){if(lastReceivedMessage[_to[i]]==currentMessageNumber){i++;duplicateWeight=duplicateWeight.add(_weight.div(_to.length));continue;}lastReceivedMessage[_to[i]]=currentMessageNumber;unreadMessages[_to[i]].push(currentUnreadMessage);unreadMessageCount[_to[i]]++;balances[_to[i]]=balances[_to[i]].add(_weight.div(_to.length));i++;}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 218,
      "column": 12,
      "content": "for(uinta=0;a<unreadMessages[recipient].length;++a){if(unreadMessages[recipient][a].id==_number){if(!unreadMessages[recipient][a].isOpened){unreadMessages[recipient][a].weight=0;unreadMessages[recipient][a].time=0;uint256value=messages[_number].weight.div(messages[_number].to.length);unreadMessageCount[recipient]--;balances[recipient]=balances[recipient].sub(value);if(!unreadMessages[recipient][a].free){usableBalances[messages[_number].from]=usableBalances[messages[_number].from].add(value);balances[messages[_number].from]=balances[messages[_number].from].add(value);}}break;}}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 548,
      "column": 8,
      "content": "for(uinta=0;a<unreadMessages[msg.sender].length;++a){if(unreadMessages[msg.sender][a].id==_number){returnunreadMessages[msg.sender][a];}}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 574,
      "column": 8,
      "content": "for(uinta=0;a<unreadMessages[msg.sender].length;++a){if(unreadMessages[msg.sender][a].id==_number){unreadMessages[msg.sender][a].isOpened=true;}}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 215,
      "column": 15,
      "content": "i<messages[_number].to.length"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 519,
      "column": 15,
      "content": "i<_to.length"
    },
    {
      "name": "SOLIDITY_OVERPOWERED_ROLE",
      "patternId": "j83hf7",
      "severity": 2,
      "line": 185,
      "column": 4,
      "content": "functionsetIssuer(address_issuer)onlyOwner{issuer=_issuer;}"
    },
    {
      "name": "SOLIDITY_PRAGMAS_VERSION",
      "patternId": "23fc32",
      "severity": 1,
      "line": 1,
      "column": 16,
      "content": "^"
    },
    {
      "name": "SOLIDITY_REDUNDANT_FALLBACK_REJECT",
      "patternId": "b85a32",
      "severity": 1,
      "line": 348,
      "column": 16,
      "content": "{throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 50,
      "column": 8,
      "content": "if(msg.sender!=owner)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 58,
      "column": 8,
      "content": "if(msg.sender!=owner&&msg.sender!=issuer)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 205,
      "column": 8,
      "content": "if(messages[_number].validUntil>=now){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 331,
      "column": 8,
      "content": "if(msg.sender!=owner)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 362,
      "column": 8,
      "content": "if(locked){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 367,
      "column": 8,
      "content": "if(balances[msg.sender]<_value||usableBalances[msg.sender]<_value){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 372,
      "column": 8,
      "content": "if(balances[_to]+_value<balances[_to]){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 400,
      "column": 8,
      "content": "if(locked){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 405,
      "column": 8,
      "content": "if(balances[_from]<_value||usableBalances[_from]<_value){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 410,
      "column": 8,
      "content": "if(balances[_to]+_value<balances[_to]){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 415,
      "column": 8,
      "content": "if(_value>allowed[_from][msg.sender]){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 445,
      "column": 8,
      "content": "if(locked){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 487,
      "column": 8,
      "content": "if((!useFreeTokens&&usableBalances[msg.sender]<_weight)||_weight<_to.length){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 500,
      "column": 12,
      "content": "if(!token.transferFrom(msg.sender,address(this),_attachmentAmount)){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 565,
      "column": 8,
      "content": "if(currentUnreadMessage.isOpened||currentUnreadMessage.weight==0){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 595,
      "column": 8,
      "content": "if(!currentUnreadMessage.isOpened||currentUnreadMessage.weight==0){throw;}"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 119,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 42,
      "column": 4,
      "content": "functionOwned(){owner=msg.sender;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 67,
      "column": 4,
      "content": "functiontransferOwnership(address_newOwner)onlyOwner{owner=_newOwner;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 80,
      "column": 4,
      "content": "functionbalanceOf(address_owner)constantreturns(uint256balance);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 86,
      "column": 4,
      "content": "functiontransfer(address_to,uint256_value)returns(boolsuccess);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 93,
      "column": 4,
      "content": "functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 99,
      "column": 4,
      "content": "functionapprove(address_spender,uint256_value)returns(boolsuccess);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 104,
      "column": 4,
      "content": "functionallowance(address_owner,address_spender)constantreturns(uint256remaining);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 185,
      "column": 4,
      "content": "functionsetIssuer(address_issuer)onlyOwner{issuer=_issuer;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 194,
      "column": 4,
      "content": "functionunlock()onlyOwnerreturns(boolsuccess){locked=false;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 204,
      "column": 4,
      "content": "functioninvalidateMail(uint256_number){if(messages[_number].validUntil>=now){throw;}if(messages[_number].attachmentSymbol.length!=0x0&&messages[_number].attachmentValue>0){Tokentoken=tokens[messages[_number].attachmentSymbol];token.transfer(messages[_number].from,messages[_number].attachmentValue.mul(messages[_number].to.length.sub(messages[_number].read.length)).div(messages[_number].to.length));}uint256i=0;while(i<messages[_number].to.length){addressrecipient=messages[_number].to[i];for(uinta=0;a<unreadMessages[recipient].length;++a){if(unreadMessages[recipient][a].id==_number){if(!unreadMessages[recipient][a].isOpened){unreadMessages[recipient][a].weight=0;unreadMessages[recipient][a].time=0;uint256value=messages[_number].weight.div(messages[_number].to.length);unreadMessageCount[recipient]--;balances[recipient]=balances[recipient].sub(value);if(!unreadMessages[recipient][a].free){usableBalances[messages[_number].from]=usableBalances[messages[_number].from].add(value);balances[messages[_number].from]=balances[messages[_number].from].add(value);}}break;}}i++;}}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 250,
      "column": 4,
      "content": "functiongetUnreadMessageCount(address_userAddress)constantreturns(uint256count){uint256unreadCount;for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==false){unreadCount++;}}returnunreadCount;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 268,
      "column": 4,
      "content": "functiongetUnreadMessages(address_userAddress)constantreturns(uint[]mmessages){for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==false){indexesUnread.push(unreadMessages[_userAddress][i].id);}}returnindexesUnread;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 293,
      "column": 4,
      "content": "functiongetReadMessages(address_userAddress)constantreturns(uint[]mmessages){for(uinti=0;i<unreadMessageCount[_userAddress];++i){if(unreadMessages[_userAddress][i].isOpened==true){indexesRead.push(unreadMessages[_userAddress][i].id);}}returnindexesRead;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 310,
      "column": 4,
      "content": "functionaddToken(address_tokenAddress,bytes32_symbol)onlyOwnerreturns(boolsuccess){Tokentoken=Token(_tokenAddress);tokens[_symbol]=token;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 322,
      "column": 4,
      "content": "functionlock()onlyOwnerreturns(boolsuccess){locked=true;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 341,
      "column": 4,
      "content": "functionbalanceOf(address_owner)constantreturns(uint256balance){returnbalances[_owner];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 348,
      "column": 4,
      "content": "function(){throw;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 359,
      "column": 4,
      "content": "functiontransfer(address_to,uint256_value)returns(boolsuccess){if(locked){throw;}if(balances[msg.sender]<_value||usableBalances[msg.sender]<_value){throw;}if(balances[_to]+_value<balances[_to]){throw;}balances[msg.sender]-=_value;balances[_to]+=_value;usableBalances[msg.sender]-=_value;usableBalances[_to]+=_value;Transfer(msg.sender,_to,_value);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 397,
      "column": 4,
      "content": "functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess){if(locked){throw;}if(balances[_from]<_value||usableBalances[_from]<_value){throw;}if(balances[_to]+_value<balances[_to]){throw;}if(_value>allowed[_from][msg.sender]){throw;}balances[_to]+=_value;balances[_from]-=_value;usableBalances[_from]-=_value;usableBalances[_to]+=_value;allowed[_from][msg.sender]-=_value;Transfer(_from,_to,_value);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 442,
      "column": 4,
      "content": "functionapprove(address_spender,uint256_value)returns(boolsuccess){if(locked){throw;}allowed[msg.sender][_spender]=_value;Approval(msg.sender,_spender,_value);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 465,
      "column": 4,
      "content": "functionallowance(address_owner,address_spender)constantreturns(uint256remaining){returnallowed[_owner][_spender];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 480,
      "column": 4,
      "content": "functionsendMail(address[]_to,uint256_weight,bytes32_hashedMessage,uint256_validUntil,bytes32_attachmentToken,uint256_attachmentAmount){booluseFreeTokens=false;if(_weight==0&&freeToUseTokens>0){_weight=_to.length;useFreeTokens=true;}if((!useFreeTokens&&usableBalances[msg.sender]<_weight)||_weight<_to.length){throw;}messages[currentMessageNumber].content=_hashedMessage;messages[currentMessageNumber].validUntil=_validUntil;messages[currentMessageNumber].time=now;messages[currentMessageNumber].from=msg.sender;messages[currentMessageNumber].to=_to;if(_attachmentToken!=\"\"){Tokentoken=tokens[_attachmentToken];if(!token.transferFrom(msg.sender,address(this),_attachmentAmount)){throw;}messages[currentMessageNumber].attachmentSymbol=_attachmentToken;messages[currentMessageNumber].attachmentValue=_attachmentAmount;}UnreadMessagememorycurrentUnreadMessage;currentUnreadMessage.id=currentMessageNumber;currentUnreadMessage.isOpened=false;currentUnreadMessage.from=msg.sender;currentUnreadMessage.time=now;currentUnreadMessage.weight=_weight;currentUnreadMessage.free=useFreeTokens;uint256i=0;uint256duplicateWeight=0;while(i<_to.length){if(lastReceivedMessage[_to[i]]==currentMessageNumber){i++;duplicateWeight=duplicateWeight.add(_weight.div(_to.length));continue;}lastReceivedMessage[_to[i]]=currentMessageNumber;unreadMessages[_to[i]].push(currentUnreadMessage);unreadMessageCount[_to[i]]++;balances[_to[i]]=balances[_to[i]].add(_weight.div(_to.length));i++;}if(useFreeTokens){freeToUseTokens=freeToUseTokens.sub(_weight.sub(duplicateWeight));}else{usableBalances[msg.sender]=usableBalances[msg.sender].sub(_weight.sub(duplicateWeight));balances[msg.sender]=balances[msg.sender].sub(_weight.sub(duplicateWeight));}messages[currentMessageNumber].weight=_weight.sub(duplicateWeight);currentMessageNumber++;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 547,
      "column": 4,
      "content": "functiongetUnreadMessage(uint256_number)constantreturns(UnreadMessageunread){for(uinta=0;a<unreadMessages[msg.sender].length;++a){if(unreadMessages[msg.sender][a].id==_number){returnunreadMessages[msg.sender][a];}}}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 561,
      "column": 4,
      "content": "functionopenMail(uint256_number)returns(boolsuccess){UnreadMessagememorycurrentUnreadMessage=getUnreadMessage(_number);if(currentUnreadMessage.isOpened||currentUnreadMessage.weight==0){throw;}if(messages[_number].attachmentSymbol!=0x0&&messages[_number].attachmentValue>0){Tokentoken=tokens[messages[_number].attachmentSymbol];token.transfer(msg.sender,messages[_number].attachmentValue.div(messages[_number].to.length));}for(uinta=0;a<unreadMessages[msg.sender].length;++a){if(unreadMessages[msg.sender][a].id==_number){unreadMessages[msg.sender][a].isOpened=true;}}messages[_number].read.push(msg.sender);usableBalances[msg.sender]=usableBalances[msg.sender].add(messages[_number].weight.div(messages[_number].to.length));returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 593,
      "column": 4,
      "content": "functiongetMail(uint256_number)constantreturns(bytes32message){UnreadMessagememorycurrentUnreadMessage=getUnreadMessage(_number);if(!currentUnreadMessage.isOpened||currentUnreadMessage.weight==0){throw;}returnmessages[_number].content;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 609,
      "column": 4,
      "content": "functionissue(address_recipient,uint256_value)onlyIssuerreturns(boolsuccess){if(totalSupply.add(_value)>maxTotalSupply){return;}balances[_recipient]=balances[_recipient].add(_value);usableBalances[_recipient]=usableBalances[_recipient].add(_value);totalSupply=totalSupply.add(_value);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 623,
      "column": 4,
      "content": "functionMail(){balances[msg.sender]=0;totalSupply=0;locked=false;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 163,
      "column": 4,
      "content": "mapping(uint256=>Message)messages;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 176,
      "column": 4,
      "content": "uint[]indexesUnread;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 177,
      "column": 4,
      "content": "uint[]indexesRead;"
    }
  ]
}