/unique_chucks/42/0xb019ed7fc2fe1e6c57e438c94799af02dee0e22d.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 27cb59
severity: 1
line: 68
column: 8
content: suicide

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 113
column: 4
content: functiontotalSupply()constantreturns(uint256supply);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 114
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 118
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 141
column: 4
content: functioncheckOnlyContractOwner()internalconstantreturns(uint){if(contractOwner==msg.sender){returnOK;}returnOWNED_ACCESS_DENIED_ONLY_CONTRACT_OWNER;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 258
column: 4
content: functiontotalSupply()constantreturns(uint256supply);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 259
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 263
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_ERC20_APPROVE
patternId: af782c
severity: 2
line: 509
column: 4
content: functionapprove(address_spender,uint_value)publicreturns(bool){if(_spender!=0x0){return_getAsset().__approve(_spender,_value,msg.sender);}else{returnfalse;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 132
column: 8
content: for(uinti=0;i<tokens.length;i++){addresstoken=tokens[i];uintbalance=ERC20Interface(token).balanceOf(this);if(balance!=0)ERC20Interface(token).transfer(_to,balance);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 174
column: 8
content: for(uint_idx=0;_idx<_signatures.length;++_idx){(_sig,_oracle)=(_signatures[_idx],_oracles[_idx]);if(!oracles[_sig][_oracle]){oracles[_sig][_oracle]=true;_emitOracleAdded(_sig,_oracle);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 188
column: 8
content: for(uint_idx=0;_idx<_signatures.length;++_idx){(_sig,_oracle)=(_signatures[_idx],_oracles[_idx]);if(oracles[_sig][_oracle]){deleteoracles[_sig][_oracle];_emitOracleRemoved(_sig,_oracle);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 891
column: 8
content: for(uint_userIdx=0;_userIdx<_users.length;++_userIdx){address_user=_users[_userIdx];uint_memberIndex=memberAddress2index[_user];require(_memberIndex!=0);if(_group.memberAddress2index[_user]!=0){continue;}_groupMembersCount=_groupMembersCount.add(1);_group.memberAddress2index[_user]=_groupMembersCount;_group.index2globalIndex[_groupMembersCount]=_memberIndex;_addGroupToMember(_user,_groupName);UserToGroupAdded(_user,_groupName);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 926
column: 8
content: for(uint_userIdx=0;_userIdx<_users.length;++_userIdx){address_user=_users[_userIdx];uint_memberIndex=memberAddress2index[_user];uint_groupMemberIndex=_group.memberAddress2index[_user];if(_memberIndex==0||_groupMemberIndex==0){continue;}if(_groupMemberIndex!=_groupMembersCount){uint_lastUserGlobalIndex=_group.index2globalIndex[_groupMembersCount];address_lastUser=index2memberAddress[_lastUserGlobalIndex];_group.index2globalIndex[_groupMemberIndex]=_lastUserGlobalIndex;_group.memberAddress2index[_lastUser]=_groupMemberIndex;}delete_group.memberAddress2index[_user];delete_group.index2globalIndex[_groupMembersCount];_groupMembersCount=_groupMembersCount.sub(1);_removeGroupFromMember(_user,_groupName);UserFromGroupRemoved(_user,_groupName);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 668
column: 4
content: functionstringToBytes32(stringmemorysource)privatepurereturns(bytes32result){assembly{result:=mload(add(source,32))}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 132
column: 8
content: for(uinti=0;i<tokens.length;i++){addresstoken=tokens[i];uintbalance=ERC20Interface(token).balanceOf(this);if(balance!=0)ERC20Interface(token).transfer(_to,balance);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 174
column: 8
content: for(uint_idx=0;_idx<_signatures.length;++_idx){(_sig,_oracle)=(_signatures[_idx],_oracles[_idx]);if(!oracles[_sig][_oracle]){oracles[_sig][_oracle]=true;_emitOracleAdded(_sig,_oracle);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 188
column: 8
content: for(uint_idx=0;_idx<_signatures.length;++_idx){(_sig,_oracle)=(_signatures[_idx],_oracles[_idx]);if(oracles[_sig][_oracle]){deleteoracles[_sig][_oracle];_emitOracleRemoved(_sig,_oracle);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 891
column: 8
content: for(uint_userIdx=0;_userIdx<_users.length;++_userIdx){address_user=_users[_userIdx];uint_memberIndex=memberAddress2index[_user];require(_memberIndex!=0);if(_group.memberAddress2index[_user]!=0){continue;}_groupMembersCount=_groupMembersCount.add(1);_group.memberAddress2index[_user]=_groupMembersCount;_group.index2globalIndex[_groupMembersCount]=_memberIndex;_addGroupToMember(_user,_groupName);UserToGroupAdded(_user,_groupName);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 926
column: 8
content: for(uint_userIdx=0;_userIdx<_users.length;++_userIdx){address_user=_users[_userIdx];uint_memberIndex=memberAddress2index[_user];uint_groupMemberIndex=_group.memberAddress2index[_user];if(_memberIndex==0||_groupMemberIndex==0){continue;}if(_groupMemberIndex!=_groupMembersCount){uint_lastUserGlobalIndex=_group.index2globalIndex[_groupMembersCount];address_lastUser=index2memberAddress[_lastUserGlobalIndex];_group.index2globalIndex[_groupMemberIndex]=_lastUserGlobalIndex;_group.memberAddress2index[_lastUser]=_groupMemberIndex;}delete_group.memberAddress2index[_user];delete_group.index2globalIndex[_groupMembersCount];_groupMembersCount=_groupMembersCount.sub(1);_removeGroupFromMember(_user,_groupName);UserFromGroupRemoved(_user,_groupName);}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 233
column: 0
content: contractATxAssetInterface{DataControllerInterfacepublicdataController;ServiceControllerInterfacepublicserviceController;function__transferWithReference(address_to,uint_value,string_reference,address_sender)publicreturns(bool);function__transferFromWithReference(address_from,address_to,uint_value,string_reference,address_sender)publicreturns(bool);function__approve(address_spender,uint_value,address_sender)publicreturns(bool);function__process(bytes,address)payablepublic{revert();}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 287
column: 0
content: contractATxAssetProxyisERC20,Object,ServiceAllowance{uintconstantUPGRADE_FREEZE_TIME=3days;usingSafeMathforuint;eventUpgradeProposal(addressnewVersion);addresslatestVersion;addresspendingVersion;uintpendingVersionTimestamp;Platformpublicplatform;bytes32publicsmbl;stringpublicname;modifieronlyPlatform(){if(msg.sender==address(platform)){_;}}modifieronlyAssetOwner(){if(platform.isOwner(msg.sender,smbl)){_;}}modifieronlyAccess(address_sender){if(getLatestVersion()==msg.sender){_;}}function()publicpayable{_getAsset().__process.value(msg.value)(msg.data,msg.sender);}functioninit(Platform_platform,string_symbol,string_name)publicreturns(bool){if(address(platform)!=0x0){returnfalse;}platform=_platform;symbol=_symbol;smbl=stringToBytes32(_symbol);name=_name;returntrue;}functiontotalSupply()publicviewreturns(uint){returnplatform.totalSupply(smbl);}functionbalanceOf(address_owner)publicviewreturns(uint){returnplatform.balanceOf(_owner,smbl);}functionallowance(address_from,address_spender)publicviewreturns(uint){returnplatform.allowance(_from,_spender,smbl);}functiondecimals()publicviewreturns(uint8){returnplatform.baseUnit(smbl);}functiontransfer(address_to,uint_value)publicreturns(bool){if(_to!=0x0){return_transferWithReference(_to,_value,"");}else{returnfalse;}}functiontransferWithReference(address_to,uint_value,string_reference)publicreturns(bool){if(_to!=0x0){return_transferWithReference(_to,_value,_reference);}else{returnfalse;}}function__transferWithReference(address_to,uint_value,string_reference,address_sender)publiconlyAccess(_sender)returns(bool){returnplatform.proxyTransferWithReference(_to,_value,smbl,_reference,_sender)==OK;}functiontransferFrom(address_from,address_to,uint_value)publicreturns(bool){if(_to!=0x0){return_getAsset().__transferFromWithReference(_from,_to,_value,"",msg.sender);}else{returnfalse;}}function__transferFromWithReference(address_from,address_to,uint_value,string_reference,address_sender)publiconlyAccess(_sender)returns(bool){returnplatform.proxyTransferFromWithReference(_from,_to,_value,smbl,_reference,_sender)==OK;}functionapprove(address_spender,uint_value)publicreturns(bool){if(_spender!=0x0){return_getAsset().__approve(_spender,_value,msg.sender);}else{returnfalse;}}function__approve(address_spender,uint_value,address_sender)publiconlyAccess(_sender)returns(bool){returnplatform.proxyApprove(_spender,_value,smbl,_sender)==OK;}functionemitTransfer(address_from,address_to,uint_value)publiconlyPlatform(){Transfer(_from,_to,_value);}functionemitApprove(address_from,address_spender,uint_value)publiconlyPlatform(){Approval(_from,_spender,_value);}functiongetLatestVersion()publicviewreturns(address){returnlatestVersion;}functiongetPendingVersion()publicviewreturns(address){returnpendingVersion;}functiongetPendingVersionTimestamp()publicviewreturns(uint){returnpendingVersionTimestamp;}functionproposeUpgrade(address_newVersion)publiconlyAssetOwnerreturns(bool){if(pendingVersion!=0x0){returnfalse;}if(_newVersion==0x0){returnfalse;}if(latestVersion==0x0){latestVersion=_newVersion;returntrue;}pendingVersion=_newVersion;pendingVersionTimestamp=now;UpgradeProposal(_newVersion);returntrue;}functionpurgeUpgrade()publiconlyAssetOwnerreturns(bool){if(pendingVersion==0x0){returnfalse;}deletependingVersion;deletependingVersionTimestamp;returntrue;}functioncommitUpgrade()publicreturns(bool){if(pendingVersion==0x0){returnfalse;}if(pendingVersionTimestamp.add(UPGRADE_FREEZE_TIME)>now){returnfalse;}latestVersion=pendingVersion;deletependingVersion;deletependingVersionTimestamp;returntrue;}functionisTransferAllowed(address,address,address,address,uint)publicviewreturns(bool){returntrue;}function_getAsset()internalviewreturns(ATxAssetInterface){returnATxAssetInterface(getLatestVersion());}function_transferWithReference(address_to,uint_value,string_reference)internalreturns(bool){return_getAsset().__transferWithReference(_to,_value,_reference,msg.sender);}functionstringToBytes32(stringmemorysource)privatepurereturns(bytes32result){assembly{result:=mload(add(source,32))}}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 743
column: 0
content: contractGroupsAccessManagerisObject,GroupsAccessManagerEmitter{uintconstantUSER_MANAGER_SCOPE=111000;uintconstantUSER_MANAGER_MEMBER_ALREADY_EXIST=USER_MANAGER_SCOPE+1;uintconstantUSER_MANAGER_GROUP_ALREADY_EXIST=USER_MANAGER_SCOPE+2;uintconstantUSER_MANAGER_OBJECT_ALREADY_SECURED=USER_MANAGER_SCOPE+3;uintconstantUSER_MANAGER_CONFIRMATION_HAS_COMPLETED=USER_MANAGER_SCOPE+4;uintconstantUSER_MANAGER_USER_HAS_CONFIRMED=USER_MANAGER_SCOPE+5;uintconstantUSER_MANAGER_NOT_ENOUGH_GAS=USER_MANAGER_SCOPE+6;uintconstantUSER_MANAGER_INVALID_INVOCATION=USER_MANAGER_SCOPE+7;uintconstantUSER_MANAGER_DONE=USER_MANAGER_SCOPE+11;uintconstantUSER_MANAGER_CANCELLED=USER_MANAGER_SCOPE+12;usingSafeMathforuint;structMember{addressaddr;uintgroupsCount;mapping(bytes32=>uint)groupName2index;mapping(uint=>uint)index2globalIndex;}structGroup{bytes32name;uintpriority;uintmembersCount;mapping(address=>uint)memberAddress2index;mapping(uint=>uint)index2globalIndex;}uintpublicmembersCount;mapping(uint=>address)index2memberAddress;mapping(address=>uint)memberAddress2index;mapping(address=>Member)address2member;uintpublicgroupsCount;mapping(uint=>bytes32)index2groupName;mapping(bytes32=>uint)groupName2index;mapping(bytes32=>Group)groupName2group;mapping(bytes32=>bool)publicgroupsBlocked;function()payablepublic{revert();}functionregisterUser(address_user)externalonlyContractOwnerreturns(uint){require(_user!=0x0);if(isRegisteredUser(_user)){returnUSER_MANAGER_MEMBER_ALREADY_EXIST;}uint_membersCount=membersCount.add(1);membersCount=_membersCount;memberAddress2index[_user]=_membersCount;index2memberAddress[_membersCount]=_user;address2member[_user]=Member(_user,0);UserCreated(_user);returnOK;}functionunregisterUser(address_user)externalonlyContractOwnerreturns(uint){require(_user!=0x0);uint_memberIndex=memberAddress2index[_user];if(_memberIndex==0||address2member[_user].groupsCount!=0){returnUSER_MANAGER_INVALID_INVOCATION;}uint_membersCount=membersCount;deletememberAddress2index[_user];if(_memberIndex!=_membersCount){address_lastUser=index2memberAddress[_membersCount];index2memberAddress[_memberIndex]=_lastUser;memberAddress2index[_lastUser]=_memberIndex;}deleteaddress2member[_user];deleteindex2memberAddress[_membersCount];deletememberAddress2index[_user];membersCount=_membersCount.sub(1);UserDeleted(_user);returnOK;}functioncreateGroup(bytes32_groupName,uint_priority)externalonlyContractOwnerreturns(uint){require(_groupName!=bytes32(0));if(isGroupExists(_groupName)){returnUSER_MANAGER_GROUP_ALREADY_EXIST;}uint_groupsCount=groupsCount.add(1);groupName2index[_groupName]=_groupsCount;index2groupName[_groupsCount]=_groupName;groupName2group[_groupName]=Group(_groupName,_priority,0);groupsCount=_groupsCount;GroupCreated(_groupName);returnOK;}functionchangeGroupActiveStatus(bytes32_groupName,bool_blocked)externalonlyContractOwnerreturns(uint){require(isGroupExists(_groupName));groupsBlocked[_groupName]=_blocked;returnOK;}functionaddUsersToGroup(bytes32_groupName,address[]_users)externalonlyContractOwnerreturns(uint){require(isGroupExists(_groupName));Groupstorage_group=groupName2group[_groupName];uint_groupMembersCount=_group.membersCount;for(uint_userIdx=0;_userIdx<_users.length;++_userIdx){address_user=_users[_userIdx];uint_memberIndex=memberAddress2index[_user];require(_memberIndex!=0);if(_group.memberAddress2index[_user]!=0){continue;}_groupMembersCount=_groupMembersCount.add(1);_group.memberAddress2index[_user]=_groupMembersCount;_group.index2globalIndex[_groupMembersCount]=_memberIndex;_addGroupToMember(_user,_groupName);UserToGroupAdded(_user,_groupName);}_group.membersCount=_groupMembersCount;returnOK;}functionremoveUsersFromGroup(bytes32_groupName,address[]_users)externalonlyContractOwnerreturns(uint){require(isGroupExists(_groupName));Groupstorage_group=groupName2group[_groupName];uint_groupMembersCount=_group.membersCount;for(uint_userIdx=0;_userIdx<_users.length;++_userIdx){address_user=_users[_userIdx];uint_memberIndex=memberAddress2index[_user];uint_groupMemberIndex=_group.memberAddress2index[_user];if(_memberIndex==0||_groupMemberIndex==0){continue;}if(_groupMemberIndex!=_groupMembersCount){uint_lastUserGlobalIndex=_group.index2globalIndex[_groupMembersCount];address_lastUser=index2memberAddress[_lastUserGlobalIndex];_group.index2globalIndex[_groupMemberIndex]=_lastUserGlobalIndex;_group.memberAddress2index[_lastUser]=_groupMemberIndex;}delete_group.memberAddress2index[_user];delete_group.index2globalIndex[_groupMembersCount];_groupMembersCount=_groupMembersCount.sub(1);_removeGroupFromMember(_user,_groupName);UserFromGroupRemoved(_user,_groupName);}_group.membersCount=_groupMembersCount;returnOK;}functionisRegisteredUser(address_user)publicviewreturns(bool){returnmemberAddress2index[_user]!=0;}functionisUserInGroup(bytes32_groupName,address_user)publicviewreturns(bool){returnisRegisteredUser(_user)&&address2member[_user].groupName2index[_groupName]!=0;}functionisGroupExists(bytes32_groupName)publicviewreturns(bool){returngroupName2index[_groupName]!=0;}functiongetGroups()publicviewreturns(bytes32[]_groups){uint_groupsCount=groupsCount;_groups=newbytes32[](_groupsCount);for(uint_groupIdx=0;_groupIdx<_groupsCount;++_groupIdx){_groups[_groupIdx]=index2groupName[_groupIdx+1];}}function_removeGroupFromMember(address_user,bytes32_groupName)private{Memberstorage_member=address2member[_user];uint_memberGroupsCount=_member.groupsCount;uint_memberGroupIndex=_member.groupName2index[_groupName];if(_memberGroupIndex!=_memberGroupsCount){uint_lastGroupGlobalIndex=_member.index2globalIndex[_memberGroupsCount];bytes32_lastGroupName=index2groupName[_lastGroupGlobalIndex];_member.index2globalIndex[_memberGroupIndex]=_lastGroupGlobalIndex;_member.groupName2index[_lastGroupName]=_memberGroupIndex;}delete_member.groupName2index[_groupName];delete_member.index2globalIndex[_memberGroupsCount];_member.groupsCount=_memberGroupsCount.sub(1);}function_addGroupToMember(address_user,bytes32_groupName)private{Memberstorage_member=address2member[_user];uint_memberGroupsCount=_member.groupsCount.add(1);_member.groupName2index[_groupName]=_memberGroupsCount;_member.index2globalIndex[_memberGroupsCount]=groupName2index[_groupName];_member.groupsCount=_memberGroupsCount;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 1082
column: 0
content: contractPendingManagerisObject,PendingManagerEmitter,PendingManagerInterface{uintconstantNO_RECORDS_WERE_FOUND=4;uintconstantPENDING_MANAGER_SCOPE=4000;uintconstantPENDING_MANAGER_INVALID_INVOCATION=PENDING_MANAGER_SCOPE+1;uintconstantPENDING_MANAGER_HASNT_VOTED=PENDING_MANAGER_SCOPE+2;uintconstantPENDING_DUPLICATE_TX=PENDING_MANAGER_SCOPE+3;uintconstantPENDING_MANAGER_CONFIRMED=PENDING_MANAGER_SCOPE+4;uintconstantPENDING_MANAGER_REJECTED=PENDING_MANAGER_SCOPE+5;uintconstantPENDING_MANAGER_IN_PROCESS=PENDING_MANAGER_SCOPE+6;uintconstantPENDING_MANAGER_TX_DOESNT_EXIST=PENDING_MANAGER_SCOPE+7;uintconstantPENDING_MANAGER_TX_WAS_DECLINED=PENDING_MANAGER_SCOPE+8;uintconstantPENDING_MANAGER_TX_WAS_NOT_CONFIRMED=PENDING_MANAGER_SCOPE+9;uintconstantPENDING_MANAGER_INSUFFICIENT_GAS=PENDING_MANAGER_SCOPE+10;uintconstantPENDING_MANAGER_POLICY_NOT_FOUND=PENDING_MANAGER_SCOPE+11;usingSafeMathforuint;enumGuardState{Decline,Confirmed,InProcess}structRequirements{bytes32groupName;uintacceptLimit;uintdeclineLimit;}structPolicy{uintgroupsCount;mapping(uint=>Requirements)participatedGroups;mapping(bytes32=>uint)groupName2index;uinttotalAcceptedLimit;uinttotalDeclinedLimit;uintsecuresCount;mapping(uint=>uint)index2txIndex;mapping(uint=>uint)txIndex2index;}structVote{bytes32groupName;boolaccepted;}structGuard{GuardStatestate;uintbasePolicyIndex;uintalreadyAccepted;uintalreadyDeclined;mapping(address=>Vote)votes;mapping(bytes32=>uint)acceptedCount;mapping(bytes32=>uint)declinedCount;}addresspublicaccessManager;mapping(address=>bool)publicauthorized;uintpublicpoliciesCount;mapping(uint=>bytes32)index2PolicyId;mapping(bytes32=>uint)policyId2Index;mapping(bytes32=>Policy)policyId2policy;uintpublictxCount;mapping(uint=>bytes32)index2txKey;mapping(bytes32=>uint)txKey2index;mapping(bytes32=>Guard)txKey2guard;modifieronlyAuthorized{if(authorized[msg.sender]||address(this)==msg.sender){_;}}functionPendingManager(address_accessManager)public{require(_accessManager!=0x0);accessManager=_accessManager;}function()payablepublic{revert();}functionsetAccessManager(address_accessManager)externalonlyContractOwnerreturns(uint){require(_accessManager!=0x0);accessManager=_accessManager;returnOK;}functionsignIn(address_contract)externalonlyContractOwnerreturns(uint){require(_contract!=0x0);authorized[_contract]=true;returnOK;}functionsignOut(address_contract)externalonlyContractOwnerreturns(uint){require(_contract!=0x0);deleteauthorized[_contract];returnOK;}functionaddPolicyRule(bytes4_sig,address_contract,bytes32_groupName,uint_acceptLimit,uint_declineLimit)onlyContractOwnerexternalreturns(uint){require(_sig!=0x0);require(_contract!=0x0);require(GroupsAccessManager(accessManager).isGroupExists(_groupName));require(_acceptLimit!=0);require(_declineLimit!=0);bytes32_policyHash=keccak256(_sig,_contract);if(policyId2Index[_policyHash]==0){uint_policiesCount=policiesCount.add(1);index2PolicyId[_policiesCount]=_policyHash;policyId2Index[_policyHash]=_policiesCount;policiesCount=_policiesCount;}Policystorage_policy=policyId2policy[_policyHash];uint_policyGroupsCount=_policy.groupsCount;if(_policy.groupName2index[_groupName]==0){_policyGroupsCount+=1;_policy.groupName2index[_groupName]=_policyGroupsCount;_policy.participatedGroups[_policyGroupsCount].groupName=_groupName;_policy.groupsCount=_policyGroupsCount;}uint_previousAcceptLimit=_policy.participatedGroups[_policyGroupsCount].acceptLimit;uint_previousDeclineLimit=_policy.participatedGroups[_policyGroupsCount].declineLimit;_policy.participatedGroups[_policyGroupsCount].acceptLimit=_acceptLimit;_policy.participatedGroups[_policyGroupsCount].declineLimit=_declineLimit;_policy.totalAcceptedLimit=_policy.totalAcceptedLimit.sub(_previousAcceptLimit).add(_acceptLimit);_policy.totalDeclinedLimit=_policy.totalDeclinedLimit.sub(_previousDeclineLimit).add(_declineLimit);PolicyRuleAdded(_sig,_contract,_policyHash,_groupName,_acceptLimit,_declineLimit);returnOK;}functionremovePolicyRule(bytes4_sig,address_contract,bytes32_groupName)onlyContractOwnerexternalreturns(uint){require(_sig!=bytes4(0));require(_contract!=0x0);require(GroupsAccessManager(accessManager).isGroupExists(_groupName));bytes32_policyHash=keccak256(_sig,_contract);Policystorage_policy=policyId2policy[_policyHash];uint_policyGroupNameIndex=_policy.groupName2index[_groupName];if(_policyGroupNameIndex==0){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}uint_policyGroupsCount=_policy.groupsCount;if(_policyGroupNameIndex!=_policyGroupsCount){Requirementsstorage_requirements=_policy.participatedGroups[_policyGroupsCount];_policy.participatedGroups[_policyGroupNameIndex]=_requirements;_policy.groupName2index[_requirements.groupName]=_policyGroupNameIndex;}_policy.totalAcceptedLimit=_policy.totalAcceptedLimit.sub(_policy.participatedGroups[_policyGroupsCount].acceptLimit);_policy.totalDeclinedLimit=_policy.totalDeclinedLimit.sub(_policy.participatedGroups[_policyGroupsCount].declineLimit);delete_policy.groupName2index[_groupName];delete_policy.participatedGroups[_policyGroupsCount];_policy.groupsCount=_policyGroupsCount.sub(1);PolicyRuleRemoved(_sig,_contract,_policyHash,_groupName);returnOK;}functionaddTx(bytes32_key,bytes4_sig,address_contract)externalonlyAuthorizedreturns(uint){require(_key!=bytes32(0));require(_sig!=bytes4(0));require(_contract!=0x0);bytes32_policyHash=keccak256(_sig,_contract);require(isPolicyExist(_policyHash));if(isTxExist(_key)){return_emitError(PENDING_DUPLICATE_TX);}if(_policyHash==bytes32(0)){return_emitError(PENDING_MANAGER_POLICY_NOT_FOUND);}uint_index=txCount.add(1);txCount=_index;index2txKey[_index]=_key;txKey2index[_key]=_index;Guardstorage_guard=txKey2guard[_key];_guard.basePolicyIndex=policyId2Index[_policyHash];_guard.state=GuardState.InProcess;Policystorage_policy=policyId2policy[_policyHash];uint_counter=_policy.securesCount.add(1);_policy.securesCount=_counter;_policy.index2txIndex[_counter]=_index;_policy.txIndex2index[_index]=_counter;ProtectionTxAdded(_key,_policyHash,block.number);returnOK;}functiondeleteTx(bytes32_key)externalonlyContractOwnerreturns(uint){require(_key!=bytes32(0));if(!isTxExist(_key)){return_emitError(PENDING_MANAGER_TX_DOESNT_EXIST);}uint_txsCount=txCount;uint_txIndex=txKey2index[_key];if(_txIndex!=_txsCount){bytes32_last=index2txKey[txCount];index2txKey[_txIndex]=_last;txKey2index[_last]=_txIndex;}deletetxKey2index[_key];deleteindex2txKey[_txsCount];txCount=_txsCount.sub(1);uint_basePolicyIndex=txKey2guard[_key].basePolicyIndex;Policystorage_policy=policyId2policy[index2PolicyId[_basePolicyIndex]];uint_counter=_policy.securesCount;uint_policyTxIndex=_policy.txIndex2index[_txIndex];if(_policyTxIndex!=_counter){uint_movedTxIndex=_policy.index2txIndex[_counter];_policy.index2txIndex[_policyTxIndex]=_movedTxIndex;_policy.txIndex2index[_movedTxIndex]=_policyTxIndex;}delete_policy.index2txIndex[_counter];delete_policy.txIndex2index[_txIndex];_policy.securesCount=_counter.sub(1);TxDeleted(_key);returnOK;}functionaccept(bytes32_key,bytes32_votingGroupName)externalreturns(uint){if(!isTxExist(_key)){return_emitError(PENDING_MANAGER_TX_DOESNT_EXIST);}if(!GroupsAccessManager(accessManager).isUserInGroup(_votingGroupName,msg.sender)){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}Guardstorage_guard=txKey2guard[_key];if(_guard.state!=GuardState.InProcess){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}if(_guard.votes[msg.sender].groupName!=bytes32(0)&&_guard.votes[msg.sender].accepted){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}Policystorage_policy=policyId2policy[index2PolicyId[_guard.basePolicyIndex]];uint_policyGroupIndex=_policy.groupName2index[_votingGroupName];uint_groupAcceptedVotesCount=_guard.acceptedCount[_votingGroupName];if(_groupAcceptedVotesCount==_policy.participatedGroups[_policyGroupIndex].acceptLimit){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}_guard.votes[msg.sender]=Vote(_votingGroupName,true);_guard.acceptedCount[_votingGroupName]=_groupAcceptedVotesCount+1;uint_alreadyAcceptedCount=_guard.alreadyAccepted+1;_guard.alreadyAccepted=_alreadyAcceptedCount;ProtectionTxAccepted(_key,msg.sender,_votingGroupName);if(_alreadyAcceptedCount==_policy.totalAcceptedLimit){_guard.state=GuardState.Confirmed;ProtectionTxDone(_key);}returnOK;}functiondecline(bytes32_key,bytes32_votingGroupName)externalreturns(uint){if(!isTxExist(_key)){return_emitError(PENDING_MANAGER_TX_DOESNT_EXIST);}if(!GroupsAccessManager(accessManager).isUserInGroup(_votingGroupName,msg.sender)){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}Guardstorage_guard=txKey2guard[_key];if(_guard.state!=GuardState.InProcess){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}if(_guard.votes[msg.sender].groupName!=bytes32(0)&&!_guard.votes[msg.sender].accepted){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}Policystorage_policy=policyId2policy[index2PolicyId[_guard.basePolicyIndex]];uint_policyGroupIndex=_policy.groupName2index[_votingGroupName];uint_groupDeclinedVotesCount=_guard.declinedCount[_votingGroupName];if(_groupDeclinedVotesCount==_policy.participatedGroups[_policyGroupIndex].declineLimit){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}_guard.votes[msg.sender]=Vote(_votingGroupName,false);_guard.declinedCount[_votingGroupName]=_groupDeclinedVotesCount+1;uint_alreadyDeclinedCount=_guard.alreadyDeclined+1;_guard.alreadyDeclined=_alreadyDeclinedCount;ProtectionTxDeclined(_key,msg.sender,_votingGroupName);if(_alreadyDeclinedCount==_policy.totalDeclinedLimit){_guard.state=GuardState.Decline;ProtectionTxCancelled(_key);}returnOK;}functionforceRejectVotes(bytes32_key,address_user)externalonlyContractOwnerreturns(uint){return_revoke(_key,_user);}functionrevoke(bytes32_key)externalreturns(uint){return_revoke(_key,msg.sender);}functionhasConfirmedRecord(bytes32_key)publicviewreturns(uint){require(_key!=bytes32(0));if(!isTxExist(_key)){returnNO_RECORDS_WERE_FOUND;}Guardstorage_guard=txKey2guard[_key];return_guard.state==GuardState.InProcess?PENDING_MANAGER_IN_PROCESS:_guard.state==GuardState.Confirmed?OK:PENDING_MANAGER_REJECTED;}functiongetPolicyDetails(bytes4_sig,address_contract)publicviewreturns(bytes32[]_groupNames,uint[]_acceptLimits,uint[]_declineLimits,uint_totalAcceptedLimit,uint_totalDeclinedLimit){require(_sig!=bytes4(0));require(_contract!=0x0);bytes32_policyHash=keccak256(_sig,_contract);uint_policyIdx=policyId2Index[_policyHash];if(_policyIdx==0){return;}Policystorage_policy=policyId2policy[_policyHash];uint_policyGroupsCount=_policy.groupsCount;_groupNames=newbytes32[](_policyGroupsCount);_acceptLimits=newuint[](_policyGroupsCount);_declineLimits=newuint[](_policyGroupsCount);for(uint_idx=0;_idx<_policyGroupsCount;++_idx){Requirementsstorage_requirements=_policy.participatedGroups[_idx+1];_groupNames[_idx]=_requirements.groupName;_acceptLimits[_idx]=_requirements.acceptLimit;_declineLimits[_idx]=_requirements.declineLimit;}(_totalAcceptedLimit,_totalDeclinedLimit)=(_policy.totalAcceptedLimit,_policy.totalDeclinedLimit);}functionisGroupInPolicy(bytes32_policyHash,bytes32_groupName)publicviewreturns(bool){Policystorage_policy=policyId2policy[_policyHash];return_policy.groupName2index[_groupName]!=0;}functionisPolicyExist(bytes32_policyHash)publicviewreturns(bool){returnpolicyId2Index[_policyHash]!=0;}functionisTxExist(bytes32_key)publicviewreturns(bool){returntxKey2index[_key]!=0;}function_updateTxState(Policystorage_policy,Guardstorage_guard,uintconfirmedAmount,uintdeclineAmount)private{if(declineAmount!=0&&_guard.state!=GuardState.Decline){_guard.state=GuardState.Decline;}elseif(confirmedAmount>=_policy.groupsCount&&_guard.state!=GuardState.Confirmed){_guard.state=GuardState.Confirmed;}elseif(_guard.state!=GuardState.InProcess){_guard.state=GuardState.InProcess;}}function_revoke(bytes32_key,address_user)privatereturns(uint){require(_key!=bytes32(0));require(_user!=0x0);if(!isTxExist(_key)){return_emitError(PENDING_MANAGER_TX_DOESNT_EXIST);}Guardstorage_guard=txKey2guard[_key];if(_guard.state!=GuardState.InProcess){return_emitError(PENDING_MANAGER_INVALID_INVOCATION);}bytes32_votedGroupName=_guard.votes[_user].groupName;if(_votedGroupName==bytes32(0)){return_emitError(PENDING_MANAGER_HASNT_VOTED);}boolisAcceptedVote=_guard.votes[_user].accepted;if(isAcceptedVote){_guard.acceptedCount[_votedGroupName]=_guard.acceptedCount[_votedGroupName].sub(1);_guard.alreadyAccepted=_guard.alreadyAccepted.sub(1);}else{_guard.declinedCount[_votedGroupName]=_guard.declinedCount[_votedGroupName].sub(1);_guard.alreadyDeclined=_guard.alreadyDeclined.sub(1);}delete_guard.votes[_user];ProtectionTxVoteRevoked(_key,_user,_votedGroupName);returnOK;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 1870
column: 0
content: contractDataControllerisOracleMethodAdapter,DataControllerEmitter{uintconstantDATA_CONTROLLER=109000;uintconstantDATA_CONTROLLER_ERROR=DATA_CONTROLLER+1;uintconstantDATA_CONTROLLER_CURRENT_WRONG_LIMIT=DATA_CONTROLLER+2;uintconstantDATA_CONTROLLER_WRONG_ALLOWANCE=DATA_CONTROLLER+3;uintconstantDATA_CONTROLLER_COUNTRY_CODE_ALREADY_EXISTS=DATA_CONTROLLER+4;uintconstantMAX_TOKEN_HOLDER_NUMBER=2**256-1;usingSafeMathforuint;structHoldersData{uintcountryCode;uintsendLimPerDay;uintsendLimPerMonth;booloperational;bytestext;uintholderAddressCount;mapping(uint=>address)index2Address;mapping(address=>uint)address2Index;}structCountryLimits{uintcountryCode;uintmaxTokenHolderNumber;uintcurrentTokenHolderNumber;}addresspublicwithdrawal;addressassetAddress;addresspublicserviceController;mapping(address=>uint)publicallowance;uintpublicholdersCount;mapping(uint=>HoldersData)holders;mapping(address=>bytes32)holderAddress2Id;mapping(bytes32=>uint)publicholderIndex;uintpubliccountriesCount;mapping(uint=>CountryLimits)countryLimitsList;mapping(uint=>uint)countryIndex;modifieronlyWithdrawal{if(msg.sender!=withdrawal){revert();}_;}modifieronlyAsset{if(msg.sender==assetAddress){_;}}modifieronlyContractOwner{if(msg.sender==contractOwner){_;}}functionDataController(address_serviceController,address_asset)public{require(_serviceController!=0x0);require(_asset!=0x0);serviceController=_serviceController;assetAddress=_asset;}function()payablepublic{revert();}functionsetWithdraw(address_withdrawal)onlyContractOwnerexternalreturns(uint){require(_withdrawal!=0x0);withdrawal=_withdrawal;returnOK;}functiongetPendingManager()publicviewreturns(address){returnServiceController(serviceController).getPendingManager();}functiongetHolderInfo(bytes32_externalHolderId)publicviewreturns(uint_countryCode,uint_limPerDay,uint_limPerMonth,bool_operational,bytes_text){HoldersDatastorage_data=holders[holderIndex[_externalHolderId]];return(_data.countryCode,_data.sendLimPerDay,_data.sendLimPerMonth,_data.operational,_data.text);}functiongetHolderAddresses(bytes32_externalHolderId)publicviewreturns(address[]_addresses){HoldersDatastorage_holderData=holders[holderIndex[_externalHolderId]];uint_addressesCount=_holderData.holderAddressCount;_addresses=newaddress[](_addressesCount);for(uint_holderAddressIdx=0;_holderAddressIdx<_addressesCount;++_holderAddressIdx){_addresses[_holderAddressIdx]=_holderData.index2Address[_holderAddressIdx+1];}}functiongetHolderCountryCode(bytes32_externalHolderId)publicviewreturns(uint){returnholders[holderIndex[_externalHolderId]].countryCode;}functiongetHolderExternalIdByAddress(address_address)publicviewreturns(bytes32){returnholderAddress2Id[_address];}functionisRegisteredAddress(address_address)publicviewreturns(bool){returnholderIndex[holderAddress2Id[_address]]!=0;}functionisHolderOwnAddress(bytes32_externalHolderId,address_address)publicviewreturns(bool){uint_holderIndex=holderIndex[_externalHolderId];if(_holderIndex==0){returnfalse;}returnholders[_holderIndex].address2Index[_address]!=0;}functiongetCountryInfo(uint_countryCode)publicviewreturns(uint_maxHolderNumber,uint_currentHolderCount){CountryLimitsstorage_data=countryLimitsList[countryIndex[_countryCode]];return(_data.maxTokenHolderNumber,_data.currentTokenHolderNumber);}functiongetCountryLimit(uint_countryCode)publicviewreturns(uintlimit){uint_index=countryIndex[_countryCode];require(_index!=0);returncountryLimitsList[_index].maxTokenHolderNumber;}functionaddCountryCode(uint_countryCode)onlyContractOwnerpublicreturns(uint){var(,_created)=_createCountryId(_countryCode);if(!_created){return_emitError(DATA_CONTROLLER_COUNTRY_CODE_ALREADY_EXISTS);}returnOK;}functionregisterHolder(bytes32_externalHolderId,address_holderAddress,uint_countryCode)onlyOracleOrOwnerexternalreturns(uint){require(_holderAddress!=0x0);require(holderIndex[_externalHolderId]==0);uint_holderIndex=holderIndex[holderAddress2Id[_holderAddress]];require(_holderIndex==0);_createCountryId(_countryCode);_holderIndex=holdersCount.add(1);holdersCount=_holderIndex;HoldersDatastorage_holderData=holders[_holderIndex];_holderData.countryCode=_countryCode;_holderData.operational=true;_holderData.sendLimPerDay=MAX_TOKEN_HOLDER_NUMBER;_holderData.sendLimPerMonth=MAX_TOKEN_HOLDER_NUMBER;uint_firstAddressIndex=1;_holderData.holderAddressCount=_firstAddressIndex;_holderData.address2Index[_holderAddress]=_firstAddressIndex;_holderData.index2Address[_firstAddressIndex]=_holderAddress;holderIndex[_externalHolderId]=_holderIndex;holderAddress2Id[_holderAddress]=_externalHolderId;_emitHolderRegistered(_externalHolderId,_holderIndex,_countryCode);returnOK;}functionaddHolderAddress(bytes32_externalHolderId,address_newAddress)onlyOracleOrOwnerexternalreturns(uint){uint_holderIndex=holderIndex[_externalHolderId];require(_holderIndex!=0);uint_newAddressId=holderIndex[holderAddress2Id[_newAddress]];require(_newAddressId==0);HoldersDatastorage_holderData=holders[_holderIndex];if(_holderData.address2Index[_newAddress]==0){_holderData.holderAddressCount=_holderData.holderAddressCount.add(1);_holderData.address2Index[_newAddress]=_holderData.holderAddressCount;_holderData.index2Address[_holderData.holderAddressCount]=_newAddress;}holderAddress2Id[_newAddress]=_externalHolderId;_emitHolderAddressAdded(_externalHolderId,_newAddress,_holderIndex);returnOK;}functionremoveHolderAddress(bytes32_externalHolderId,address_address)onlyOracleOrOwnerexternalreturns(uint){uint_holderIndex=holderIndex[_externalHolderId];require(_holderIndex!=0);HoldersDatastorage_holderData=holders[_holderIndex];uint_tempIndex=_holderData.address2Index[_address];require(_tempIndex!=0);address_lastAddress=_holderData.index2Address[_holderData.holderAddressCount];_holderData.address2Index[_lastAddress]=_tempIndex;_holderData.index2Address[_tempIndex]=_lastAddress;delete_holderData.address2Index[_address];_holderData.holderAddressCount=_holderData.holderAddressCount.sub(1);deleteholderAddress2Id[_address];_emitHolderAddressRemoved(_externalHolderId,_address,_holderIndex);returnOK;}functionchangeOperational(bytes32_externalHolderId,bool_operational)onlyOracleOrOwnerexternalreturns(uint){uint_holderIndex=holderIndex[_externalHolderId];require(_holderIndex!=0);holders[_holderIndex].operational=_operational;_emitHolderOperationalChanged(_externalHolderId,_operational);returnOK;}functionupdateTextForHolder(bytes32_externalHolderId,bytes_text)onlyOracleOrOwnerexternalreturns(uint){uint_holderIndex=holderIndex[_externalHolderId];require(_holderIndex!=0);holders[_holderIndex].text=_text;returnOK;}functionupdateLimitPerDay(bytes32_externalHolderId,uint_limit)onlyOracleOrOwnerexternalreturns(uint){uint_holderIndex=holderIndex[_externalHolderId];require(_holderIndex!=0);uint_currentLimit=holders[_holderIndex].sendLimPerDay;holders[_holderIndex].sendLimPerDay=_limit;_emitDayLimitChanged(_externalHolderId,_currentLimit,_limit);returnOK;}functionupdateLimitPerMonth(bytes32_externalHolderId,uint_limit)onlyOracleOrOwnerexternalreturns(uint){uint_holderIndex=holderIndex[_externalHolderId];require(_holderIndex!=0);uint_currentLimit=holders[_holderIndex].sendLimPerDay;holders[_holderIndex].sendLimPerMonth=_limit;_emitMonthLimitChanged(_externalHolderId,_currentLimit,_limit);returnOK;}functionchangeCountryLimit(uint_countryCode,uint_limit)onlyOracleOrOwnerexternalreturns(uint){uint_countryIndex=countryIndex[_countryCode];require(_countryIndex!=0);uint_currentTokenHolderNumber=countryLimitsList[_countryIndex].currentTokenHolderNumber;if(_currentTokenHolderNumber>_limit){returnDATA_CONTROLLER_CURRENT_WRONG_LIMIT;}countryLimitsList[_countryIndex].maxTokenHolderNumber=_limit;_emitCountryCodeChanged(_countryIndex,_countryCode,_limit);returnOK;}functionwithdrawFrom(address_holderAddress,uint_value)publiconlyAssetreturns(uint){bytes32_externalHolderId=holderAddress2Id[_holderAddress];HoldersDatastorage_holderData=holders[holderIndex[_externalHolderId]];_holderData.sendLimPerDay=_holderData.sendLimPerDay.sub(_value);_holderData.sendLimPerMonth=_holderData.sendLimPerMonth.sub(_value);returnOK;}functiondepositTo(address_holderAddress,uint_value)publiconlyAssetreturns(uint){bytes32_externalHolderId=holderAddress2Id[_holderAddress];HoldersDatastorage_holderData=holders[holderIndex[_externalHolderId]];_holderData.sendLimPerDay=_holderData.sendLimPerDay.add(_value);_holderData.sendLimPerMonth=_holderData.sendLimPerMonth.add(_value);returnOK;}functionupdateCountryHoldersCount(uint_countryCode,uint_updatedHolderCount)publiconlyAssetreturns(uint){CountryLimitsstorage_data=countryLimitsList[countryIndex[_countryCode]];assert(_data.maxTokenHolderNumber>=_updatedHolderCount);_data.currentTokenHolderNumber=_updatedHolderCount;returnOK;}functionchangeAllowance(address_from,uint_value)publiconlyWithdrawalreturns(uint){ServiceController_serviceController=ServiceController(serviceController);ATxAssetProxytoken=ATxAssetProxy(_serviceController.proxy());if(token.balanceOf(_from)<_value){returnDATA_CONTROLLER_WRONG_ALLOWANCE;}allowance[_from]=_value;returnOK;}function_createCountryId(uint_countryCode)internalreturns(uint,bool_created){uintcountryId=countryIndex[_countryCode];if(countryId==0){uint_countriesCount=countriesCount;countryId=_countriesCount.add(1);countriesCount=countryId;CountryLimitsstoragelimits=countryLimitsList[countryId];limits.countryCode=_countryCode;limits.maxTokenHolderNumber=MAX_TOKEN_HOLDER_NUMBER;countryIndex[_countryCode]=countryId;_emitCountryCodeAdded(countryIndex[_countryCode],_countryCode,MAX_TOKEN_HOLDER_NUMBER);_created=true;}return(countryId,_created);}}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 784
column: 30
content: {revert();}

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 1169
column: 30
content: {revert();}

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 1955
column: 30
content: {revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 1654
column: 8
content: if(OK!=PendingManager(_manager).addTx(_txHash,msg.sig,address(this))){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 1927
column: 8
content: if(msg.sender!=withdrawal){revert();}

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 292
column: 4
content: usingSafeMathforuint;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 756
column: 4
content: usingSafeMathforuint;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 1098
column: 4
content: usingSafeMathforuint;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 1882
column: 4
content: usingSafeMathforuint;

ruleId: SOLIDITY_SHOULD_NOT_BE_PURE
patternId: 11314f
severity: 1
line: 668
column: 4
content: functionstringToBytes32(stringmemorysource)privatepurereturns(bytes32result){assembly{result:=mload(add(source,32))}}

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 2236
column: 66
content: (uint,bool_created)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 1227
column: 30
content: keccak256(_sig,_contract)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 1276
column: 30
content: keccak256(_sig,_contract)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 1312
column: 30
content: keccak256(_sig,_contract)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 1531
column: 30
content: keccak256(_sig,_contract)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 1669
column: 18
content: keccak256(msg.sig,_args,_block)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 348
column: 15
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 784
column: 23
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 1169
column: 23
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 1955
column: 23
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 238
column: 63
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 239
column: 82
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 241
column: 23
content: bytes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 270
column: 56
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 277
column: 83
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 278
column: 102
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 280
column: 54
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 280
column: 68
content: string_description

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 363
column: 38
content: string_symbol

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 363
column: 54
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 441
column: 61
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 462
column: 63
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 497
column: 82
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 664
column: 62
content: string_reference

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 985
column: 46
content: bytes32[]_groups

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1070
column: 8
content: bytes32[]_groupNames

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1071
column: 8
content: uint[]_acceptLimits

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1072
column: 8
content: uint[]_declineLimits

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1522
column: 8
content: bytes32[]_groupNames

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1523
column: 8
content: uint[]_acceptLimits

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1524
column: 8
content: uint[]_declineLimits

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1975
column: 8
content: bytes_text

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1981
column: 80
content: address[]_addresses

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 669
column: 8
content: assembly{result:=mload(add(source,32))}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 50
column: 4
content: functionOwned(){contractOwner=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 67
column: 4
content: functiondestroy()onlyContractOwner{suicide(msg.sender);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 80
column: 4
content: functionchangeContractOwnership(address_to)onlyContractOwner()returns(bool){if(_to==0x0){returnfalse;}pendingContractOwner=_to;returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 96
column: 4
content: functionclaimContractOwnership()returns(bool){if(pendingContractOwner!=msg.sender){returnfalse;}contractOwner=pendingContractOwner;deletependingContractOwner;returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 113
column: 4
content: functiontotalSupply()constantreturns(uint256supply);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 114
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 115
column: 4
content: functiontransfer(address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 116
column: 4
content: functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 117
column: 4
content: functionapprove(address_spender,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 118
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 131
column: 4
content: functionwithdrawnTokens(address[]tokens,address_to)onlyContractOwnerreturns(uint){for(uinti=0;i<tokens.length;i++){addresstoken=tokens[i];uintbalance=ERC20Interface(token).balanceOf(this);if(balance!=0)ERC20Interface(token).transfer(_to,balance);}returnOK;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 258
column: 4
content: functiontotalSupply()constantreturns(uint256supply);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 259
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 260
column: 4
content: functiontransfer(address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 261
column: 4
content: functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 262
column: 4
content: functionapprove(address_spender,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 263
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 128
column: 4
content: uintconstantOK=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 129
column: 4
content: uintconstantOWNED_ACCESS_DENIED_ONLY_CONTRACT_OWNER=8;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 290
column: 4
content: uintconstantUPGRADE_FREEZE_TIME=3days;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 300
column: 4
content: addresslatestVersion;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 303
column: 4
content: addresspendingVersion;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 306
column: 4
content: uintpendingVersionTimestamp;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 745
column: 4
content: uintconstantUSER_MANAGER_SCOPE=111000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 746
column: 4
content: uintconstantUSER_MANAGER_MEMBER_ALREADY_EXIST=USER_MANAGER_SCOPE+1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 747
column: 4
content: uintconstantUSER_MANAGER_GROUP_ALREADY_EXIST=USER_MANAGER_SCOPE+2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 748
column: 4
content: uintconstantUSER_MANAGER_OBJECT_ALREADY_SECURED=USER_MANAGER_SCOPE+3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 749
column: 4
content: uintconstantUSER_MANAGER_CONFIRMATION_HAS_COMPLETED=USER_MANAGER_SCOPE+4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 750
column: 4
content: uintconstantUSER_MANAGER_USER_HAS_CONFIRMED=USER_MANAGER_SCOPE+5;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 751
column: 4
content: uintconstantUSER_MANAGER_NOT_ENOUGH_GAS=USER_MANAGER_SCOPE+6;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 752
column: 4
content: uintconstantUSER_MANAGER_INVALID_INVOCATION=USER_MANAGER_SCOPE+7;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 753
column: 4
content: uintconstantUSER_MANAGER_DONE=USER_MANAGER_SCOPE+11;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 754
column: 4
content: uintconstantUSER_MANAGER_CANCELLED=USER_MANAGER_SCOPE+12;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 774
column: 4
content: mapping(uint=>address)index2memberAddress;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 775
column: 4
content: mapping(address=>uint)memberAddress2index;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 776
column: 4
content: mapping(address=>Member)address2member;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 779
column: 4
content: mapping(uint=>bytes32)index2groupName;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 780
column: 4
content: mapping(bytes32=>uint)groupName2index;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 781
column: 4
content: mapping(bytes32=>Group)groupName2group;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1084
column: 4
content: uintconstantNO_RECORDS_WERE_FOUND=4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1085
column: 4
content: uintconstantPENDING_MANAGER_SCOPE=4000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1086
column: 4
content: uintconstantPENDING_MANAGER_INVALID_INVOCATION=PENDING_MANAGER_SCOPE+1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1087
column: 4
content: uintconstantPENDING_MANAGER_HASNT_VOTED=PENDING_MANAGER_SCOPE+2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1088
column: 4
content: uintconstantPENDING_DUPLICATE_TX=PENDING_MANAGER_SCOPE+3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1089
column: 4
content: uintconstantPENDING_MANAGER_CONFIRMED=PENDING_MANAGER_SCOPE+4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1090
column: 4
content: uintconstantPENDING_MANAGER_REJECTED=PENDING_MANAGER_SCOPE+5;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1091
column: 4
content: uintconstantPENDING_MANAGER_IN_PROCESS=PENDING_MANAGER_SCOPE+6;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1092
column: 4
content: uintconstantPENDING_MANAGER_TX_DOESNT_EXIST=PENDING_MANAGER_SCOPE+7;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1093
column: 4
content: uintconstantPENDING_MANAGER_TX_WAS_DECLINED=PENDING_MANAGER_SCOPE+8;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1094
column: 4
content: uintconstantPENDING_MANAGER_TX_WAS_NOT_CONFIRMED=PENDING_MANAGER_SCOPE+9;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1095
column: 4
content: uintconstantPENDING_MANAGER_INSUFFICIENT_GAS=PENDING_MANAGER_SCOPE+10;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1096
column: 4
content: uintconstantPENDING_MANAGER_POLICY_NOT_FOUND=PENDING_MANAGER_SCOPE+11;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1145
column: 4
content: mapping(uint=>bytes32)index2PolicyId;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1146
column: 4
content: mapping(bytes32=>uint)policyId2Index;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1147
column: 4
content: mapping(bytes32=>Policy)policyId2policy;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1150
column: 4
content: mapping(uint=>bytes32)index2txKey;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1151
column: 4
content: mapping(bytes32=>uint)txKey2index;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1152
column: 4
content: mapping(bytes32=>Guard)txKey2guard;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1627
column: 4
content: uintconstantMULTISIG_ADDED=3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1628
column: 4
content: uintconstantNO_RECORDS_WERE_FOUND=4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1679
column: 4
content: uintconstantSERVICE_CONTROLLER=350000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1680
column: 4
content: uintconstantSERVICE_CONTROLLER_EMISSION_EXIST=SERVICE_CONTROLLER+1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1681
column: 4
content: uintconstantSERVICE_CONTROLLER_BURNING_MAN_EXIST=SERVICE_CONTROLLER+2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1682
column: 4
content: uintconstantSERVICE_CONTROLLER_ALREADY_INITIALIZED=SERVICE_CONTROLLER+3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1683
column: 4
content: uintconstantSERVICE_CONTROLLER_SERVICE_EXIST=SERVICE_CONTROLLER+4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1691
column: 4
content: mapping(address=>bool)emissionProviders;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1692
column: 4
content: mapping(address=>bool)burningMans;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1874
column: 4
content: uintconstantDATA_CONTROLLER=109000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1875
column: 4
content: uintconstantDATA_CONTROLLER_ERROR=DATA_CONTROLLER+1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1876
column: 4
content: uintconstantDATA_CONTROLLER_CURRENT_WRONG_LIMIT=DATA_CONTROLLER+2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1877
column: 4
content: uintconstantDATA_CONTROLLER_WRONG_ALLOWANCE=DATA_CONTROLLER+3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1878
column: 4
content: uintconstantDATA_CONTROLLER_COUNTRY_CODE_ALREADY_EXISTS=DATA_CONTROLLER+4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1880
column: 4
content: uintconstantMAX_TOKEN_HOLDER_NUMBER=2**256-1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1907
column: 4
content: addressassetAddress;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1915
column: 4
content: mapping(uint=>HoldersData)holders;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1916
column: 4
content: mapping(address=>bytes32)holderAddress2Id;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1921
column: 4
content: mapping(uint=>CountryLimits)countryLimitsList;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1922
column: 4
content: mapping(uint=>uint)countryIndex;

SOLIDITY_VISIBILITY :78
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :5
SOLIDITY_UPGRADE_TO_050 :32
SOLIDITY_GAS_LIMIT_IN_LOOPS :5
SOLIDITY_SHOULD_RETURN_STRUCT :1
SOLIDITY_REDUNDANT_FALLBACK_REJECT :3
SOLIDITY_SHOULD_NOT_BE_PURE :1
SOLIDITY_ERC20_APPROVE :1
SOLIDITY_SAFEMATH :4
SOLIDITY_DEPRECATED_CONSTRUCTIONS :8
SOLIDITY_REVERT_REQUIRE :2
SOLIDITY_LOCKED_MONEY :5
SOLIDITY_USING_INLINE_ASSEMBLY :1