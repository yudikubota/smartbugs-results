{
  "contract": "0x96a51938cfb22565e0d40694fe103675c63ae218",
  "tool": "smartcheck",
  "start": 1563499505.6430626,
  "end": 1563499514.5303483,
  "duration": 8.887285709381104,
  "analysis": [
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 63,
      "column": 48,
      "content": "0x21835af6"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 68,
      "column": 40,
      "content": "0x21835af6"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 115,
      "column": 40,
      "content": "0x32921690"
    },
    {
      "name": "SOLIDITY_CALL_WITHOUT_DATA",
      "patternId": "om991k",
      "severity": 2,
      "line": 133,
      "column": 19,
      "content": "call.value(_value)()"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 191,
      "column": 39,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 196,
      "column": 63,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 198,
      "column": 59,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 247,
      "column": 44,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 253,
      "column": 26,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 259,
      "column": 28,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 266,
      "column": 30,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 269,
      "column": 26,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 274,
      "column": 24,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 277,
      "column": 39,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 287,
      "column": 39,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 296,
      "column": 39,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 309,
      "column": 24,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 68,
      "column": 60,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 110,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 113,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 116,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 128,
      "column": 12,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 6,
      "column": 4,
      "content": "functiongetNodeAddress(bytes32_nodeName)constantreturns(address);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 7,
      "column": 4,
      "content": "functionhasRelation(bytes32_nodeName,bytes32_relation,address_to)constantreturns(bool);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 8,
      "column": 4,
      "content": "functionaddNode(bytes32_nodeName,address_nodeAddress)constantreturns(bool);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 22,
      "column": 4,
      "content": "functiongetAddress(bytes32_name)constantreturns(address){returnambiC.getNodeAddress(_name);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 61,
      "column": 4,
      "content": "functioncheckDepth(addressself,uintn)constantreturns(bool){if(n==0)returntrue;returnself.call.gas(GAS_PER_DEPTH*n)(0x21835af6,n-1);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 66,
      "column": 4,
      "content": "function__dig(uintn)constant{if(n==0)return;if(!address(this).delegatecall(0x21835af6,n-1))throw;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 136,
      "column": 4,
      "content": "function_isContract()constantinternalreturns(bool){returnmsg.sender!=tx.origin;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 140,
      "column": 4,
      "content": "function_isHuman()constantinternalreturns(bool){return!_isContract();}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 155,
      "column": 4,
      "content": "functiondecodeIndirect(bytes_bban)constantreturns(string,string,string){bytesmemoryasset=newbytes(3);bytesmemoryinstitution=newbytes(4);bytesmemoryclient=newbytes(9);uint8k=0;for(uint8i=0;i<asset.length;i++){asset[i]=_bban[k++];}for(i=0;i<institution.length;i++){institution[i]=_bban[k++];}for(i=0;i<client.length;i++){client[i]=_bban[k++];}return(string(asset),string(institution),string(client));}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 174,
      "column": 4,
      "content": "functionparse(bytes32_icap)constantreturns(address,bytes32,bool){if(_icap[0]!=88||_icap[1]!=69){return(0,0,false);}for(uint8j=20;j<32;j++){if(_icap[j]!=0){return(0,0,false);}}bytesmemorybban=newbytes(18);for(uint8i=0;i<16;i++){bban[i]=_icap[i+4];}var(asset,institution,_)=decodeIndirect(bban);bytes32assetInstitutionHash=sha3(asset,institution);uint8parseChecksum=(uint8(_icap[2])-48)*10+(uint8(_icap[3])-48);uint8calcChecksum=98-mod9710(prepare(bban));if(parseChecksum!=calcChecksum){return(institutions[assetInstitutionHash],assets[sha3(asset)],false);}return(institutions[assetInstitutionHash],assets[sha3(asset)],registered[assetInstitutionHash]);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 201,
      "column": 4,
      "content": "functionprepare(bytes_bban)constantreturns(bytes){for(uint8i=0;i<16;i++){uint8charCode=uint8(_bban[i]);if(charCode>=65&&charCode<=90){_bban[i]=byte(charCode-65+10);}}_bban[16]=33;_bban[17]=14;return_bban;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 215,
      "column": 4,
      "content": "functionmod9710(bytes_prepared)constantreturns(uint8){uintm=0;for(uint8i=0;i<18;i++){uint8charCode=uint8(_prepared[i]);if(charCode>=48){m*=10;m+=charCode-48;m%=97;}else{m*=10;m+=charCode/10;m%=97;m*=10;m+=charCode%10;m%=97;}}m*=10;m%=97;m*=10;m%=97;returnuint8(m);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 258,
      "column": 4,
      "content": "functionaddr(bytes32_institution)constantreturns(address){returninstitutions[sha3(\"ETH\",_institution[0],_institution[1],_institution[2],_institution[3])];}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 162,
      "column": 8,
      "content": "for(uint8i=0;i<asset.length;i++){asset[i]=_bban[k++];}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 165,
      "column": 8,
      "content": "for(i=0;i<institution.length;i++){institution[i]=_bban[k++];}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 168,
      "column": 8,
      "content": "for(i=0;i<client.length;i++){client[i]=_bban[k++];}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 162,
      "column": 8,
      "content": "for(uint8i=0;i<asset.length;i++){asset[i]=_bban[k++];}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 165,
      "column": 8,
      "content": "for(i=0;i<institution.length;i++){institution[i]=_bban[k++];}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 168,
      "column": 8,
      "content": "for(i=0;i<client.length;i++){client[i]=_bban[k++];}"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 144,
      "column": 9,
      "content": "private"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 68,
      "column": 8,
      "content": "if(!address(this).delegatecall(0x21835af6,n-1))throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 109,
      "column": 8,
      "content": "if(stackDepthLib==0x0){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 112,
      "column": 8,
      "content": "if(_depth>1023){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 115,
      "column": 8,
      "content": "if(!stackDepthLib.delegatecall(0x32921690,stackDepthLib,_depth)){throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 127,
      "column": 8,
      "content": "if(!_unsafeSend(_to,_value)){throw;}"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "83k1no",
      "severity": 1,
      "line": 63,
      "column": 20,
      "content": "call.gas(GAS_PER_DEPTH*n)(0x21835af6,n-1)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "83k1no",
      "severity": 1,
      "line": 133,
      "column": 19,
      "content": "call.value(_value)()"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 6,
      "column": 4,
      "content": "functiongetNodeAddress(bytes32_nodeName)constantreturns(address);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 7,
      "column": 4,
      "content": "functionhasRelation(bytes32_nodeName,bytes32_relation,address_to)constantreturns(bool);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 8,
      "column": 4,
      "content": "functionaddNode(bytes32_nodeName,address_nodeAddress)constantreturns(bool);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 22,
      "column": 4,
      "content": "functiongetAddress(bytes32_name)constantreturns(address){returnambiC.getNodeAddress(_name);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 26,
      "column": 4,
      "content": "functionsetAmbiAddress(address_ambi,bytes32_name)returns(bool){if(address(ambiC)!=0x0){returnfalse;}AmbiambiContract=Ambi(_ambi);if(ambiContract.getNodeAddress(_name)!=address(this)){if(!ambiContract.addNode(_name,address(this))){returnfalse;}}name=_name;ambiC=ambiContract;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 41,
      "column": 4,
      "content": "functionimmortality()checkAccess(\"owner\")returns(bool){isImmortal=true;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 46,
      "column": 4,
      "content": "functionremove()checkAccess(\"owner\")returns(bool){if(isImmortal){returnfalse;}selfdestruct(msg.sender);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 61,
      "column": 4,
      "content": "functioncheckDepth(addressself,uintn)constantreturns(bool){if(n==0)returntrue;returnself.call.gas(GAS_PER_DEPTH*n)(0x21835af6,n-1);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 66,
      "column": 4,
      "content": "function__dig(uintn)constant{if(n==0)return;if(!address(this).delegatecall(0x21835af6,n-1))throw;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 103,
      "column": 4,
      "content": "functionsetupStackDepthLib(address_stackDepthLib)immutable(address(stackDepthLib))returns(bool){stackDepthLib=_stackDepthLib;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 155,
      "column": 4,
      "content": "functiondecodeIndirect(bytes_bban)constantreturns(string,string,string){bytesmemoryasset=newbytes(3);bytesmemoryinstitution=newbytes(4);bytesmemoryclient=newbytes(9);uint8k=0;for(uint8i=0;i<asset.length;i++){asset[i]=_bban[k++];}for(i=0;i<institution.length;i++){institution[i]=_bban[k++];}for(i=0;i<client.length;i++){client[i]=_bban[k++];}return(string(asset),string(institution),string(client));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 174,
      "column": 4,
      "content": "functionparse(bytes32_icap)constantreturns(address,bytes32,bool){if(_icap[0]!=88||_icap[1]!=69){return(0,0,false);}for(uint8j=20;j<32;j++){if(_icap[j]!=0){return(0,0,false);}}bytesmemorybban=newbytes(18);for(uint8i=0;i<16;i++){bban[i]=_icap[i+4];}var(asset,institution,_)=decodeIndirect(bban);bytes32assetInstitutionHash=sha3(asset,institution);uint8parseChecksum=(uint8(_icap[2])-48)*10+(uint8(_icap[3])-48);uint8calcChecksum=98-mod9710(prepare(bban));if(parseChecksum!=calcChecksum){return(institutions[assetInstitutionHash],assets[sha3(asset)],false);}return(institutions[assetInstitutionHash],assets[sha3(asset)],registered[assetInstitutionHash]);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 201,
      "column": 4,
      "content": "functionprepare(bytes_bban)constantreturns(bytes){for(uint8i=0;i<16;i++){uint8charCode=uint8(_bban[i]);if(charCode>=65&&charCode<=90){_bban[i]=byte(charCode-65+10);}}_bban[16]=33;_bban[17]=14;return_bban;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 215,
      "column": 4,
      "content": "functionmod9710(bytes_prepared)constantreturns(uint8){uintm=0;for(uint8i=0;i<18;i++){uint8charCode=uint8(_prepared[i]);if(charCode>=48){m*=10;m+=charCode-48;m%=97;}else{m*=10;m+=charCode/10;m%=97;m*=10;m+=charCode%10;m%=97;}}m*=10;m%=97;m*=10;m%=97;returnuint8(m);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 252,
      "column": 4,
      "content": "functionchangeInstitutionOwner(string_institution,address_address)noValue()onlyInstitutionOwner(_institution)returns(bool){institutionOwners[sha3(_institution)]=_address;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 258,
      "column": 4,
      "content": "functionaddr(bytes32_institution)constantreturns(address){returninstitutions[sha3(\"ETH\",_institution[0],_institution[1],_institution[2],_institution[3])];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 262,
      "column": 4,
      "content": "functionregisterInstitution(string_institution,address_address)noValue()checkAccess(\"admin\")returns(bool){if(bytes(_institution).length!=4){returnfalse;}if(institutionOwners[sha3(_institution)]!=0){returnfalse;}institutionOwners[sha3(_institution)]=_address;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 273,
      "column": 4,
      "content": "functionregisterInstitutionAsset(string_asset,string_institution,address_address)noValue()onlyInstitutionOwner(_institution)returns(bool){if(!registered[sha3(_asset)]){returnfalse;}bytes32assetInstitutionHash=sha3(_asset,_institution);if(registered[assetInstitutionHash]){returnfalse;}registered[assetInstitutionHash]=true;institutions[assetInstitutionHash]=_address;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 286,
      "column": 4,
      "content": "functionupdateInstitutionAsset(string_asset,string_institution,address_address)noValue()onlyInstitutionOwner(_institution)returns(bool){bytes32assetInstitutionHash=sha3(_asset,_institution);if(!registered[assetInstitutionHash]){returnfalse;}institutions[assetInstitutionHash]=_address;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 295,
      "column": 4,
      "content": "functionremoveInstitutionAsset(string_asset,string_institution)noValue()onlyInstitutionOwner(_institution)returns(bool){bytes32assetInstitutionHash=sha3(_asset,_institution);if(!registered[assetInstitutionHash]){returnfalse;}deleteregistered[assetInstitutionHash];deleteinstitutions[assetInstitutionHash];returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 305,
      "column": 4,
      "content": "functionregisterAsset(string_asset,bytes32_symbol)noValue()checkAccess(\"admin\")returns(bool){if(bytes(_asset).length!=3){returnfalse;}bytes32asset=sha3(_asset);if(registered[asset]){returnfalse;}registered[asset]=true;assets[asset]=_symbol;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 59,
      "column": 4,
      "content": "uintconstantGAS_PER_DEPTH=400;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 102,
      "column": 4,
      "content": "addressstackDepthLib;"
    }
  ]
}