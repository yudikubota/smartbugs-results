/unique_chucks/30/0xbd5af6f705e4582c3f2b368ccf278ce39c3cfc17.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 239
column: 0
content: contractFlightDelayLedgerInterfaceisFlightDelayDatabaseModel{functionreceiveFunds(Acc_to)payable;functionsendFunds(address_recipient,Acc_from,uint_amount)returns(bool_success);functionbookkeeping(Acc_from,Acc_to,uintamount);}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 5
column: 4
content: functionisOwner(address_addr)returns(bool_isOwner);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 7
column: 4
content: functionselfRegister(bytes32_id)returns(boolresult);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 9
column: 4
content: functiongetContract(bytes32_id)returns(address_addr);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 147
column: 4
content: functiondestruct()onlyController{selfdestruct(controller);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 151
column: 4
content: functionsetContracts()onlyController{}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 160
column: 4
content: functionsetPermissionById(uint8_perm,bytes32_id);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 162
column: 4
content: functionsetPermissionById(uint8_perm,bytes32_id,bool_access);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 164
column: 4
content: functionsetPermissionByAddress(uint8_perm,address_addr);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 166
column: 4
content: functionsetPermissionByAddress(uint8_perm,address_addr,bool_access);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 168
column: 4
content: functioncheckPermission(uint8_perm,address_addr)returns(bool_success);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 173
column: 4
content: functionsetAccessControl(address_contract,address_caller,uint8_perm);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 175
column: 4
content: functionsetAccessControl(address_contract,address_caller,uint8_perm,bool_access);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 182
column: 4
content: functiongetAccessControl(address_contract,address_caller,uint8_perm)returns(bool_allowed);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 184
column: 4
content: functionsetLedger(uint8_index,int_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 186
column: 4
content: functiongetLedger(uint8_index)returns(int_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 188
column: 4
content: functiongetCustomerPremium(uint_policyId)returns(address_customer,uint_premium);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 190
column: 4
content: functiongetPolicyData(uint_policyId)returns(address_customer,uint_premium,uint_weight);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 192
column: 4
content: functiongetPolicyState(uint_policyId)returns(policyState_state);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 194
column: 4
content: functiongetRiskId(uint_policyId)returns(bytes32_riskId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 196
column: 4
content: functioncreatePolicy(address_customer,uint_premium,Currency_currency,bytes32_customerExternalId,bytes32_riskId)returns(uint_policyId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 198
column: 4
content: functionsetState(uint_policyId,policyState_state,uint_stateTime,bytes32_stateMessage);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 205
column: 4
content: functionsetWeight(uint_policyId,uint_weight,bytes_proof);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 207
column: 4
content: functionsetPayouts(uint_policyId,uint_calculatedPayout,uint_actualPayout);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 209
column: 4
content: functionsetDelay(uint_policyId,uint8_delay,uint_delayInMinutes);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 211
column: 4
content: functiongetRiskParameters(bytes32_riskId)returns(bytes32_carrierFlightNumber,bytes32_departureYearMonthDay,uint_arrivalTime);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 214
column: 4
content: functiongetPremiumFactors(bytes32_riskId)returns(uint_cumulatedWeightedPremium,uint_premiumMultiplier);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 217
column: 4
content: functioncreateUpdateRisk(bytes32_carrierFlightNumber,bytes32_departureYearMonthDay,uint_arrivalTime)returns(bytes32_riskId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 220
column: 4
content: functionsetPremiumFactors(bytes32_riskId,uint_cumulatedWeightedPremium,uint_premiumMultiplier);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 222
column: 4
content: functiongetOraclizeCallback(bytes32_queryId)returns(uint_policyId,uint_arrivalTime);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 225
column: 4
content: functiongetOraclizePolicyId(bytes32_queryId)returns(uint_policyId);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 228
column: 4
content: functioncreateOraclizeCallback(bytes32_queryId,uint_policyId,oraclizeState_oraclizeState,uint_oraclizeTime);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 235
column: 4
content: functioncheckTime(bytes32_queryId,bytes32_riskId,uint_offset)returns(bool_result);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 241
column: 4
content: functionreceiveFunds(Acc_to)payable;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 243
column: 4
content: functionsendFunds(address_recipient,Acc_from,uint_amount)returns(bool_success);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 245
column: 4
content: functionbookkeeping(Acc_from,Acc_to,uintamount);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 449
column: 4
content: functionFlightDelayLedger(address_controller){setController(_controller);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 453
column: 4
content: functionsetContracts()onlyController{FD_AC=FlightDelayAccessControllerInterface(getContract("FD.AccessController"));FD_DB=FlightDelayDatabaseInterface(getContract("FD.Database"));FD_AC.setPermissionById(101,"FD.NewPolicy");FD_AC.setPermissionById(101,"FD.Controller");FD_AC.setPermissionById(102,"FD.Payout");FD_AC.setPermissionById(102,"FD.NewPolicy");FD_AC.setPermissionById(102,"FD.Controller");FD_AC.setPermissionById(102,"FD.Underwrite");FD_AC.setPermissionById(102,"FD.Owner");FD_AC.setPermissionById(103,"FD.Funder");FD_AC.setPermissionById(103,"FD.Underwrite");FD_AC.setPermissionById(103,"FD.Payout");FD_AC.setPermissionById(103,"FD.Ledger");FD_AC.setPermissionById(103,"FD.NewPolicy");FD_AC.setPermissionById(103,"FD.Controller");FD_AC.setPermissionById(103,"FD.Owner");FD_AC.setPermissionById(104,"FD.Funder");}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 480
column: 4
content: functionfund()payable{require(FD_AC.checkPermission(104,msg.sender));bookkeeping(Acc.Balance,Acc.RiskFund,msg.value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 488
column: 4
content: functionreceiveFunds(Acc_to)payable{require(FD_AC.checkPermission(101,msg.sender));LogReceiveFunds(msg.sender,uint8(_to),msg.value);bookkeeping(Acc.Balance,_to,msg.value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 496
column: 4
content: functionsendFunds(address_recipient,Acc_from,uint_amount)returns(bool_success){require(FD_AC.checkPermission(102,msg.sender));if(this.balance<_amount){returnfalse;}LogSendFunds(_recipient,uint8(_from),_amount);bookkeeping(_from,Acc.Balance,_amount);if(!_recipient.send(_amount)){bookkeeping(Acc.Balance,_from,_amount);_success=false;}else{_success=true;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 517
column: 4
content: functionbookkeeping(Acc_from,Acc_to,uint256_amount){require(FD_AC.checkPermission(103,msg.sender));assert(int256(_amount)>0);FD_DB.setLedger(uint8(_from),-int(_amount));FD_DB.setLedger(uint8(_to),int(_amount));}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 134
column: 4
content: FlightDelayControllerInterfaceFD_CI;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 341
column: 4
content: uintconstantMIN_OBSERVATIONS=10;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 343
column: 4
content: uintconstantMIN_PREMIUM=50finney;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 345
column: 4
content: uintconstantMAX_PREMIUM=1ether;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 347
column: 4
content: uintconstantMAX_PAYOUT=1100finney;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 349
column: 4
content: uintconstantMIN_PREMIUM_EUR=1500wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 350
column: 4
content: uintconstantMAX_PREMIUM_EUR=29000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 351
column: 4
content: uintconstantMAX_PAYOUT_EUR=30000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 353
column: 4
content: uintconstantMIN_PREMIUM_USD=1700wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 354
column: 4
content: uintconstantMAX_PREMIUM_USD=34000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 355
column: 4
content: uintconstantMAX_PAYOUT_USD=35000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 357
column: 4
content: uintconstantMIN_PREMIUM_GBP=1300wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 358
column: 4
content: uintconstantMAX_PREMIUM_GBP=25000wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 359
column: 4
content: uintconstantMAX_PAYOUT_GBP=270wei;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 362
column: 4
content: uintconstantMAX_CUMULATED_WEIGHTED_PREMIUM=60ether;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 364
column: 4
content: uint8constantREWARD_PERCENT=2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 366
column: 4
content: uint8constantRESERVE_PERCENT=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 370
column: 4
content: uint8[6]WEIGHT_PATTERN=[0,10,20,30,50,50];

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 382
column: 4
content: uintconstantMIN_TIME_BEFORE_DEPARTURE=24hours;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 384
column: 4
content: uintconstantCHECK_PAYOUT_OFFSET=15minutes;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 396
column: 4
content: uintconstantMAX_FLIGHT_DURATION=2days;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 398
column: 4
content: uintconstantCONTRACT_DEAD_LINE=1922396399;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 400
column: 4
content: uintconstantMIN_DEPARTURE_LIM=1508198400;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 402
column: 4
content: uintconstantMAX_DEPARTURE_LIM=1509840000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 405
column: 4
content: uintconstantORACLIZE_GAS=1000000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 414
column: 4
content: stringconstantORACLIZE_RATINGS_BASE_URL="[URL] json(https://api.flightstats.com/flex/ratings/rest/v1/json/flight/";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 417
column: 4
content: stringconstantORACLIZE_RATINGS_QUERY="?${[decrypt] <!--PUT ENCRYPTED_QUERY HERE--> }).ratings[0]['observations','late15','late30','late45','cancelled','diverted','arrivalAirportFsCode']";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 419
column: 4
content: stringconstantORACLIZE_STATUS_BASE_URL="[URL] json(https://api.flightstats.com/flex/flightstatus/rest/v2/json/flight/status/";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 422
column: 4
content: stringconstantORACLIZE_STATUS_QUERY="?${[decrypt] <!--PUT ENCRYPTED_QUERY HERE--> }&utc=true).flightStatuses[0]['status','delays','operationalTimes']";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 446
column: 4
content: FlightDelayDatabaseInterfaceFD_DB;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 447
column: 4
content: FlightDelayAccessControllerInterfaceFD_AC;

SOLIDITY_VISIBILITY :72
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1