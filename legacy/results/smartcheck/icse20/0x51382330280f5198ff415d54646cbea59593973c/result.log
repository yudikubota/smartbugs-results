/unique_chucks/21/0x51382330280f5198ff415d54646cbea59593973c.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 73
column: 2
content: functionget_security_state()publicviewreturns(uint256locked_features,uint256locked_features_proposed,uint256proposed_unlock_timestamp){uint256[3]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(security_locked_features_slot))mstore(add(return_value_mem,32),sload(security_locked_features_proposed_slot))mstore(add(return_value_mem,64),sload(security_proposed_unlock_timestamp_slot))return(return_value_mem,96)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 85
column: 2
content: functionget_creator()publicviewreturns(addressdcn_creator,addressdcn_creator_recovery,addressdcn_creator_recovery_proposed){uint256[3]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(creator_slot))mstore(add(return_value_mem,32),sload(creator_recovery_slot))mstore(add(return_value_mem,64),sload(creator_recovery_proposed_slot))return(return_value_mem,96)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 97
column: 2
content: functionget_asset(uint32asset_id)publicviewreturns(stringmemorysymbol,uint192unit_scale,addresscontract_address){uint256[5]memoryreturn_value_mem;assembly{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,1)revert(63,1)}letasset_ptr:=add(assets_slot,mul(2,asset_id))letasset_0:=sload(asset_ptr)letasset_1:=sload(add(asset_ptr,1))mstore(return_value_mem,96)mstore(add(return_value_mem,96),8)mstore(add(return_value_mem,128),asset_0)mstore(add(return_value_mem,32),and(asset_0,0xffffffffffffffffffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,64),asset_1)return(return_value_mem,136)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 119
column: 2
content: functionget_exchange(uint32exchange_id)publicviewreturns(stringmemoryname,boollocked,addressowner,addresswithdraw_address,addressrecovery_address,addressrecovery_address_proposed){uint256[8]memoryreturn_value_mem;assembly{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_0:=sload(exchange_ptr)letexchange_1:=sload(add(exchange_ptr,1))letexchange_2:=sload(add(exchange_ptr,2))letexchange_3:=sload(add(exchange_ptr,3))mstore(return_value_mem,192)mstore(add(return_value_mem,192),11)mstore(add(return_value_mem,224),exchange_0)mstore(add(return_value_mem,32),and(div(exchange_0,0x10000000000000000000000000000000000000000),0xff))mstore(add(return_value_mem,64),and(exchange_0,0xffffffffffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,96),exchange_1)mstore(add(return_value_mem,128),exchange_2)mstore(add(return_value_mem,160),exchange_3)return(return_value_mem,236)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 149
column: 2
content: functionget_exchange_balance(uint32exchange_id,uint32asset_id)publicviewreturns(uint256exchange_balance){uint256[1]memoryreturn_value_mem;assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_balance_ptr:=add(add(exchange_ptr,4),asset_id)mstore(return_value_mem,sload(exchange_balance_ptr))return(return_value_mem,32)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 161
column: 2
content: functionget_exchange_count()publicviewreturns(uint32count){uint256[1]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(exchange_count_slot))return(return_value_mem,32)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 171
column: 2
content: functionget_asset_count()publicviewreturns(uint32count){uint256[1]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(asset_count_slot))return(return_value_mem,32)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 181
column: 2
content: functionget_user_count()publicviewreturns(uint32count){uint256[1]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(user_count_slot))return(return_value_mem,32)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 191
column: 2
content: functionget_user(uint64user_id)publicviewreturns(addresstrade_address,addresswithdraw_address,addressrecovery_address,addressrecovery_address_proposed){uint256[4]memoryreturn_value_mem;assembly{letuser_count:=sload(user_count_slot)ifiszero(lt(user_id,user_count)){mstore(32,1)revert(63,1)}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))mstore(return_value_mem,sload(add(user_ptr,0)))mstore(add(return_value_mem,32),sload(add(user_ptr,1)))mstore(add(return_value_mem,64),sload(add(user_ptr,2)))mstore(add(return_value_mem,96),sload(add(user_ptr,3)))return(return_value_mem,128)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 213
column: 2
content: functionget_balance(uint64user_id,uint32asset_id)publicviewreturns(uint256return_balance){uint256[1]memoryreturn_value_mem;assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letuser_balance_ptr:=add(add(user_ptr,4),asset_id)mstore(return_value_mem,sload(user_balance_ptr))return(return_value_mem,32)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 225
column: 2
content: functionget_session(uint64user_id,uint32exchange_id)publicviewreturns(uint256unlock_at,addresstrade_address){uint256[2]memoryreturn_value_mem;assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))mstore(return_value_mem,sload(add(session_ptr,0)))mstore(add(return_value_mem,32),sload(add(session_ptr,1)))return(return_value_mem,64)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 238
column: 2
content: functionget_session_balance(uint64user_id,uint32exchange_id,uint32asset_id)publicviewreturns(uint128total_deposit,uint64unsettled_withdraw_total,uint64asset_balance){uint256[3]memoryreturn_value_mem;assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letsession_balance_ptr:=add(add(session_ptr,2),asset_id)letsession_balance_0:=sload(session_balance_ptr)mstore(return_value_mem,and(div(session_balance_0,0x100000000000000000000000000000000),0xffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,32),and(div(session_balance_0,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,64),and(session_balance_0,0xffffffffffffffff))return(return_value_mem,96)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 254
column: 2
content: functionget_market_state(uint64user_id,uint32exchange_id,uint32quote_asset_id,uint32base_asset_id)publicviewreturns(int64quote_qty,int64base_qty,uint64fee_used,uint64fee_limit,int64min_quote_qty,int64min_base_qty,uint64long_max_price,uint64short_min_price,uint64limit_version,int96quote_shift,int96base_shift){uint256[11]memoryreturn_value_mem;assembly{base_shift:=base_asset_idquote_shift:=quote_asset_idletuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letexchange_session_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letexchange_state_ptr:=add(add(exchange_session_ptr,4294967298),mul(3,or(mul(quote_shift,4294967296),base_shift)))letstate_data_0:=sload(exchange_state_ptr)letstate_data_1:=sload(add(exchange_state_ptr,1))letstate_data_2:=sload(add(exchange_state_ptr,2)){lettmp:=and(div(state_data_0,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,0),tmp)}{lettmp:=and(div(state_data_0,0x100000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,32),tmp)}mstore(add(return_value_mem,64),and(div(state_data_0,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,96),and(state_data_0,0xffffffffffffffff)){lettmp:=and(div(state_data_1,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,128),tmp)}{lettmp:=and(div(state_data_1,0x100000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,160),tmp)}mstore(add(return_value_mem,192),and(div(state_data_1,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,224),and(state_data_1,0xffffffffffffffff))mstore(add(return_value_mem,256),and(div(state_data_2,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)){lettmp:=and(div(state_data_2,0x1000000000000000000000000),0xffffffffffffffffffffffff)tmp:=signextend(11,tmp)mstore(add(return_value_mem,288),tmp)}{lettmp:=and(state_data_2,0xffffffffffffffffffffffff)tmp:=signextend(11,tmp)mstore(add(return_value_mem,320),tmp)}return(return_value_mem,352)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 422
column: 2
content: functionuser_create()publicreturns(uint64user_id){uint256[2]memorylog_data_mem;assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x4){mstore(32,0)revert(63,1)}}user_id:=sload(user_count_slot)ifiszero(lt(user_id,18446744073709551616)){mstore(32,1)revert(63,1)}sstore(user_count_slot,add(user_id,1))letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))sstore(add(user_ptr,0),caller)sstore(add(user_ptr,1),caller)sstore(add(user_ptr,2),caller)mstore(log_data_mem,user_id)log2(log_data_mem,32,0x49d7af0c8ce0d26f4490c17a316a59a7a5d28599a2208862554b648ebdf193f4,caller)}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 557
column: 2
content: functionadd_asset(stringmemorysymbol,uint192unit_scale,addresscontract_address)publicreturns(uint64asset_id){assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x1){mstore(32,0)revert(63,1)}}{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}asset_id:=sload(asset_count_slot)ifiszero(lt(asset_id,4294967296)){mstore(32,2)revert(63,1)}letsymbol_len:=mload(symbol)ifiszero(eq(symbol_len,8)){mstore(32,3)revert(63,1)}ifiszero(unit_scale){mstore(32,4)revert(63,1)}ifiszero(contract_address){mstore(32,5)revert(63,1)}letasset_symbol:=mload(add(symbol,32))letasset_data_0:=or(asset_symbol,unit_scale)letasset_ptr:=add(assets_slot,mul(2,asset_id))sstore(asset_ptr,asset_data_0)sstore(add(asset_ptr,1),contract_address)sstore(asset_count_slot,add(asset_id,1))}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 602
column: 2
content: functionadd_exchange(stringmemoryname,addressaddr)publicreturns(uint64exchange_id){assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x2){mstore(32,0)revert(63,1)}}{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}letname_len:=mload(name)ifiszero(eq(name_len,11)){mstore(32,2)revert(63,1)}exchange_id:=sload(exchange_count_slot)ifiszero(lt(exchange_id,4294967296)){mstore(32,3)revert(63,1)}letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letname_data:=mload(add(name,32))letexchange_0:=or(name_data,addr)sstore(exchange_ptr,exchange_0)sstore(add(exchange_ptr,1),addr)sstore(add(exchange_ptr,2),addr)sstore(exchange_count_slot,add(exchange_id,1))}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 1427
column: 11
content: true

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 73
column: 2
content: functionget_security_state()publicviewreturns(uint256locked_features,uint256locked_features_proposed,uint256proposed_unlock_timestamp){uint256[3]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(security_locked_features_slot))mstore(add(return_value_mem,32),sload(security_locked_features_proposed_slot))mstore(add(return_value_mem,64),sload(security_proposed_unlock_timestamp_slot))return(return_value_mem,96)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 85
column: 2
content: functionget_creator()publicviewreturns(addressdcn_creator,addressdcn_creator_recovery,addressdcn_creator_recovery_proposed){uint256[3]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(creator_slot))mstore(add(return_value_mem,32),sload(creator_recovery_slot))mstore(add(return_value_mem,64),sload(creator_recovery_proposed_slot))return(return_value_mem,96)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 97
column: 2
content: functionget_asset(uint32asset_id)publicviewreturns(stringmemorysymbol,uint192unit_scale,addresscontract_address){uint256[5]memoryreturn_value_mem;assembly{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,1)revert(63,1)}letasset_ptr:=add(assets_slot,mul(2,asset_id))letasset_0:=sload(asset_ptr)letasset_1:=sload(add(asset_ptr,1))mstore(return_value_mem,96)mstore(add(return_value_mem,96),8)mstore(add(return_value_mem,128),asset_0)mstore(add(return_value_mem,32),and(asset_0,0xffffffffffffffffffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,64),asset_1)return(return_value_mem,136)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 119
column: 2
content: functionget_exchange(uint32exchange_id)publicviewreturns(stringmemoryname,boollocked,addressowner,addresswithdraw_address,addressrecovery_address,addressrecovery_address_proposed){uint256[8]memoryreturn_value_mem;assembly{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_0:=sload(exchange_ptr)letexchange_1:=sload(add(exchange_ptr,1))letexchange_2:=sload(add(exchange_ptr,2))letexchange_3:=sload(add(exchange_ptr,3))mstore(return_value_mem,192)mstore(add(return_value_mem,192),11)mstore(add(return_value_mem,224),exchange_0)mstore(add(return_value_mem,32),and(div(exchange_0,0x10000000000000000000000000000000000000000),0xff))mstore(add(return_value_mem,64),and(exchange_0,0xffffffffffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,96),exchange_1)mstore(add(return_value_mem,128),exchange_2)mstore(add(return_value_mem,160),exchange_3)return(return_value_mem,236)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 149
column: 2
content: functionget_exchange_balance(uint32exchange_id,uint32asset_id)publicviewreturns(uint256exchange_balance){uint256[1]memoryreturn_value_mem;assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_balance_ptr:=add(add(exchange_ptr,4),asset_id)mstore(return_value_mem,sload(exchange_balance_ptr))return(return_value_mem,32)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 161
column: 2
content: functionget_exchange_count()publicviewreturns(uint32count){uint256[1]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(exchange_count_slot))return(return_value_mem,32)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 171
column: 2
content: functionget_asset_count()publicviewreturns(uint32count){uint256[1]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(asset_count_slot))return(return_value_mem,32)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 181
column: 2
content: functionget_user_count()publicviewreturns(uint32count){uint256[1]memoryreturn_value_mem;assembly{mstore(return_value_mem,sload(user_count_slot))return(return_value_mem,32)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 191
column: 2
content: functionget_user(uint64user_id)publicviewreturns(addresstrade_address,addresswithdraw_address,addressrecovery_address,addressrecovery_address_proposed){uint256[4]memoryreturn_value_mem;assembly{letuser_count:=sload(user_count_slot)ifiszero(lt(user_id,user_count)){mstore(32,1)revert(63,1)}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))mstore(return_value_mem,sload(add(user_ptr,0)))mstore(add(return_value_mem,32),sload(add(user_ptr,1)))mstore(add(return_value_mem,64),sload(add(user_ptr,2)))mstore(add(return_value_mem,96),sload(add(user_ptr,3)))return(return_value_mem,128)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 213
column: 2
content: functionget_balance(uint64user_id,uint32asset_id)publicviewreturns(uint256return_balance){uint256[1]memoryreturn_value_mem;assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letuser_balance_ptr:=add(add(user_ptr,4),asset_id)mstore(return_value_mem,sload(user_balance_ptr))return(return_value_mem,32)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 225
column: 2
content: functionget_session(uint64user_id,uint32exchange_id)publicviewreturns(uint256unlock_at,addresstrade_address){uint256[2]memoryreturn_value_mem;assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))mstore(return_value_mem,sload(add(session_ptr,0)))mstore(add(return_value_mem,32),sload(add(session_ptr,1)))return(return_value_mem,64)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 238
column: 2
content: functionget_session_balance(uint64user_id,uint32exchange_id,uint32asset_id)publicviewreturns(uint128total_deposit,uint64unsettled_withdraw_total,uint64asset_balance){uint256[3]memoryreturn_value_mem;assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letsession_balance_ptr:=add(add(session_ptr,2),asset_id)letsession_balance_0:=sload(session_balance_ptr)mstore(return_value_mem,and(div(session_balance_0,0x100000000000000000000000000000000),0xffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,32),and(div(session_balance_0,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,64),and(session_balance_0,0xffffffffffffffff))return(return_value_mem,96)}}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 254
column: 2
content: functionget_market_state(uint64user_id,uint32exchange_id,uint32quote_asset_id,uint32base_asset_id)publicviewreturns(int64quote_qty,int64base_qty,uint64fee_used,uint64fee_limit,int64min_quote_qty,int64min_base_qty,uint64long_max_price,uint64short_min_price,uint64limit_version,int96quote_shift,int96base_shift){uint256[11]memoryreturn_value_mem;assembly{base_shift:=base_asset_idquote_shift:=quote_asset_idletuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letexchange_session_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letexchange_state_ptr:=add(add(exchange_session_ptr,4294967298),mul(3,or(mul(quote_shift,4294967296),base_shift)))letstate_data_0:=sload(exchange_state_ptr)letstate_data_1:=sload(add(exchange_state_ptr,1))letstate_data_2:=sload(add(exchange_state_ptr,2)){lettmp:=and(div(state_data_0,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,0),tmp)}{lettmp:=and(div(state_data_0,0x100000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,32),tmp)}mstore(add(return_value_mem,64),and(div(state_data_0,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,96),and(state_data_0,0xffffffffffffffff)){lettmp:=and(div(state_data_1,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,128),tmp)}{lettmp:=and(div(state_data_1,0x100000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,160),tmp)}mstore(add(return_value_mem,192),and(div(state_data_1,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,224),and(state_data_1,0xffffffffffffffff))mstore(add(return_value_mem,256),and(div(state_data_2,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)){lettmp:=and(div(state_data_2,0x1000000000000000000000000),0xffffffffffffffffffffffff)tmp:=signextend(11,tmp)mstore(add(return_value_mem,288),tmp)}{lettmp:=and(state_data_2,0xffffffffffffffffffffffff)tmp:=signextend(11,tmp)mstore(add(return_value_mem,320),tmp)}return(return_value_mem,352)}}

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 74
column: 10
content: (uint256locked_features,uint256locked_features_proposed,uint256proposed_unlock_timestamp)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 86
column: 10
content: (addressdcn_creator,addressdcn_creator_recovery,addressdcn_creator_recovery_proposed)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 98
column: 10
content: (stringmemorysymbol,uint192unit_scale,addresscontract_address)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 120
column: 10
content: (stringmemoryname,boollocked,addressowner,addresswithdraw_address,addressrecovery_address,addressrecovery_address_proposed)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 192
column: 10
content: (addresstrade_address,addresswithdraw_address,addressrecovery_address,addressrecovery_address_proposed)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 226
column: 10
content: (uint256unlock_at,addresstrade_address)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 239
column: 10
content: (uint128total_deposit,uint64unsettled_withdraw_total,uint64asset_balance)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 83hf3l
severity: 1
line: 258
column: 10
content: (int64quote_qty,int64base_qty,uint64fee_used,uint64fee_limit,int64min_quote_qty,int64min_base_qty,uint64long_max_price,uint64short_min_price,uint64limit_version,int96quote_shift,int96base_shift)

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 67
column: 4
content: assembly{sstore(creator_slot,caller)sstore(creator_recovery_slot,caller)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 77
column: 4
content: assembly{mstore(return_value_mem,sload(security_locked_features_slot))mstore(add(return_value_mem,32),sload(security_locked_features_proposed_slot))mstore(add(return_value_mem,64),sload(security_proposed_unlock_timestamp_slot))return(return_value_mem,96)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 89
column: 4
content: assembly{mstore(return_value_mem,sload(creator_slot))mstore(add(return_value_mem,32),sload(creator_recovery_slot))mstore(add(return_value_mem,64),sload(creator_recovery_proposed_slot))return(return_value_mem,96)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 101
column: 4
content: assembly{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,1)revert(63,1)}letasset_ptr:=add(assets_slot,mul(2,asset_id))letasset_0:=sload(asset_ptr)letasset_1:=sload(add(asset_ptr,1))mstore(return_value_mem,96)mstore(add(return_value_mem,96),8)mstore(add(return_value_mem,128),asset_0)mstore(add(return_value_mem,32),and(asset_0,0xffffffffffffffffffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,64),asset_1)return(return_value_mem,136)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 126
column: 4
content: assembly{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_0:=sload(exchange_ptr)letexchange_1:=sload(add(exchange_ptr,1))letexchange_2:=sload(add(exchange_ptr,2))letexchange_3:=sload(add(exchange_ptr,3))mstore(return_value_mem,192)mstore(add(return_value_mem,192),11)mstore(add(return_value_mem,224),exchange_0)mstore(add(return_value_mem,32),and(div(exchange_0,0x10000000000000000000000000000000000000000),0xff))mstore(add(return_value_mem,64),and(exchange_0,0xffffffffffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,96),exchange_1)mstore(add(return_value_mem,128),exchange_2)mstore(add(return_value_mem,160),exchange_3)return(return_value_mem,236)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 153
column: 4
content: assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_balance_ptr:=add(add(exchange_ptr,4),asset_id)mstore(return_value_mem,sload(exchange_balance_ptr))return(return_value_mem,32)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 165
column: 4
content: assembly{mstore(return_value_mem,sload(exchange_count_slot))return(return_value_mem,32)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 175
column: 4
content: assembly{mstore(return_value_mem,sload(asset_count_slot))return(return_value_mem,32)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 185
column: 4
content: assembly{mstore(return_value_mem,sload(user_count_slot))return(return_value_mem,32)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 198
column: 4
content: assembly{letuser_count:=sload(user_count_slot)ifiszero(lt(user_id,user_count)){mstore(32,1)revert(63,1)}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))mstore(return_value_mem,sload(add(user_ptr,0)))mstore(add(return_value_mem,32),sload(add(user_ptr,1)))mstore(add(return_value_mem,64),sload(add(user_ptr,2)))mstore(add(return_value_mem,96),sload(add(user_ptr,3)))return(return_value_mem,128)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 217
column: 4
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letuser_balance_ptr:=add(add(user_ptr,4),asset_id)mstore(return_value_mem,sload(user_balance_ptr))return(return_value_mem,32)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 229
column: 4
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))mstore(return_value_mem,sload(add(session_ptr,0)))mstore(add(return_value_mem,32),sload(add(session_ptr,1)))return(return_value_mem,64)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 242
column: 4
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letsession_balance_ptr:=add(add(session_ptr,2),asset_id)letsession_balance_0:=sload(session_balance_ptr)mstore(return_value_mem,and(div(session_balance_0,0x100000000000000000000000000000000),0xffffffffffffffffffffffffffffffff))mstore(add(return_value_mem,32),and(div(session_balance_0,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,64),and(session_balance_0,0xffffffffffffffff))return(return_value_mem,96)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 265
column: 4
content: assembly{base_shift:=base_asset_idquote_shift:=quote_asset_idletuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letexchange_session_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letexchange_state_ptr:=add(add(exchange_session_ptr,4294967298),mul(3,or(mul(quote_shift,4294967296),base_shift)))letstate_data_0:=sload(exchange_state_ptr)letstate_data_1:=sload(add(exchange_state_ptr,1))letstate_data_2:=sload(add(exchange_state_ptr,2)){lettmp:=and(div(state_data_0,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,0),tmp)}{lettmp:=and(div(state_data_0,0x100000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,32),tmp)}mstore(add(return_value_mem,64),and(div(state_data_0,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,96),and(state_data_0,0xffffffffffffffff)){lettmp:=and(div(state_data_1,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,128),tmp)}{lettmp:=and(div(state_data_1,0x100000000000000000000000000000000),0xffffffffffffffff)tmp:=signextend(7,tmp)mstore(add(return_value_mem,160),tmp)}mstore(add(return_value_mem,192),and(div(state_data_1,0x10000000000000000),0xffffffffffffffff))mstore(add(return_value_mem,224),and(state_data_1,0xffffffffffffffff))mstore(add(return_value_mem,256),and(div(state_data_2,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)){lettmp:=and(div(state_data_2,0x1000000000000000000000000),0xffffffffffffffffffffffff)tmp:=signextend(11,tmp)mstore(add(return_value_mem,288),tmp)}{lettmp:=and(state_data_2,0xffffffffffffffffffffffff)tmp:=signextend(11,tmp)mstore(add(return_value_mem,320),tmp)}return(return_value_mem,352)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 314
column: 4
content: assembly{{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}letlocked_features:=sload(security_locked_features_slot)sstore(security_locked_features_slot,or(locked_features,lock_features))sstore(security_locked_features_proposed_slot,0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 329
column: 4
content: assembly{{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}letcurrent_proposal:=sload(security_locked_features_proposed_slot)letproposed_differences:=xor(current_proposal,proposed_locked_features)letdoes_unlocks_features:=and(proposed_differences,not(proposed_locked_features))ifdoes_unlocks_features{sstore(security_proposed_unlock_timestamp_slot,add(timestamp,172800))}sstore(security_locked_features_proposed_slot,proposed_locked_features)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 348
column: 4
content: assembly{{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}letunlock_timestamp:=sload(security_proposed_unlock_timestamp_slot)ifgt(unlock_timestamp,timestamp){mstore(32,2)revert(63,1)}sstore(security_locked_features_slot,sload(security_locked_features_proposed_slot))}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 366
column: 4
content: assembly{letcreator_recovery:=sload(creator_recovery_slot)ifiszero(eq(caller,creator_recovery)){mstore(32,1)revert(63,1)}sstore(creator_slot,new_creator)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 377
column: 4
content: assembly{letcreator_recovery:=sload(creator_recovery_slot)ifiszero(eq(caller,creator_recovery)){mstore(32,1)revert(63,1)}sstore(creator_recovery_proposed_slot,recovery)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 388
column: 4
content: assembly{letcreator_recovery_proposed:=sload(creator_recovery_proposed_slot)ifor(iszero(eq(caller,creator_recovery_proposed)),iszero(caller)){mstore(32,1)revert(63,1)}sstore(creator_recovery_slot,caller)sstore(creator_recovery_proposed_slot,0)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 400
column: 4
content: assembly{{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,2)revert(63,1)}}letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_0:=sload(exchange_ptr)sstore(exchange_ptr,or(and(0xffffffffffffffffffffff00ffffffffffffffffffffffffffffffffffffffff,exchange_0),mul(locked,0x10000000000000000000000000000000000000000)))}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 426
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x4){mstore(32,0)revert(63,1)}}user_id:=sload(user_count_slot)ifiszero(lt(user_id,18446744073709551616)){mstore(32,1)revert(63,1)}sstore(user_count_slot,add(user_id,1))letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))sstore(add(user_ptr,0),caller)sstore(add(user_ptr,1),caller)sstore(add(user_ptr,2),caller)mstore(log_data_mem,user_id)log2(log_data_mem,32,0x49d7af0c8ce0d26f4490c17a316a59a7a5d28599a2208862554b648ebdf193f4,caller)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 454
column: 4
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letrecovery_address:=sload(add(user_ptr,2))ifiszero(eq(caller,recovery_address)){mstore(32,1)revert(63,1)}sstore(add(user_ptr,0),trade_address)mstore(log_data_mem,user_id)log1(log_data_mem,32,0x0dcac7e45506b3812319ae528c780b9035570ee3b3557272431dce5b397d880a)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 470
column: 4
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letrecovery_address:=sload(add(user_ptr,2))ifiszero(eq(caller,recovery_address)){mstore(32,1)revert(63,1)}sstore(add(user_ptr,1),withdraw_address)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 482
column: 4
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letrecovery_address:=sload(add(user_ptr,2))ifiszero(eq(caller,recovery_address)){mstore(32,1)revert(63,1)}sstore(add(user_ptr,3),proposed)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 494
column: 4
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letproposed_ptr:=add(user_ptr,3)letrecovery_address_proposed:=sload(proposed_ptr)ifiszero(eq(caller,recovery_address_proposed)){mstore(32,1)revert(63,1)}sstore(proposed_ptr,0)sstore(add(user_ptr,2),recovery_address_proposed)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 508
column: 4
content: assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_recovery:=sload(add(exchange_ptr,2))ifiszero(eq(caller,exchange_recovery)){mstore(32,1)revert(63,1)}letexchange_0:=sload(exchange_ptr)sstore(exchange_ptr,or(and(exchange_0,0xffffffffffffffffffffffff0000000000000000000000000000000000000000),new_owner))}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 522
column: 4
content: assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_recovery:=sload(add(exchange_ptr,2))ifiszero(eq(caller,exchange_recovery)){mstore(32,1)revert(63,1)}sstore(add(exchange_ptr,1),new_withdraw)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 534
column: 4
content: assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_recovery:=sload(add(exchange_ptr,2))ifiszero(eq(caller,exchange_recovery)){mstore(32,1)revert(63,1)}sstore(add(exchange_ptr,3),proposed)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 546
column: 4
content: assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_recovery_proposed:=sload(add(exchange_ptr,3))ifor(iszero(eq(caller,exchange_recovery_proposed)),iszero(caller)){mstore(32,1)revert(63,1)}sstore(add(exchange_ptr,2),caller)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 559
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x1){mstore(32,0)revert(63,1)}}{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}asset_id:=sload(asset_count_slot)ifiszero(lt(asset_id,4294967296)){mstore(32,2)revert(63,1)}letsymbol_len:=mload(symbol)ifiszero(eq(symbol_len,8)){mstore(32,3)revert(63,1)}ifiszero(unit_scale){mstore(32,4)revert(63,1)}ifiszero(contract_address){mstore(32,5)revert(63,1)}letasset_symbol:=mload(add(symbol,32))letasset_data_0:=or(asset_symbol,unit_scale)letasset_ptr:=add(assets_slot,mul(2,asset_id))sstore(asset_ptr,asset_data_0)sstore(add(asset_ptr,1),contract_address)sstore(asset_count_slot,add(asset_id,1))}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 604
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x2){mstore(32,0)revert(63,1)}}{letcreator:=sload(creator_slot)ifiszero(eq(caller,creator)){mstore(32,1)revert(63,1)}}letname_len:=mload(name)ifiszero(eq(name_len,11)){mstore(32,2)revert(63,1)}exchange_id:=sload(exchange_count_slot)ifiszero(lt(exchange_id,4294967296)){mstore(32,3)revert(63,1)}letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letname_data:=mload(add(name,32))letexchange_0:=or(name_data,addr)sstore(exchange_ptr,exchange_0)sstore(add(exchange_ptr,1),addr)sstore(add(exchange_ptr,2),addr)sstore(exchange_count_slot,add(exchange_id,1))}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 646
column: 4
content: assembly{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letwithdraw_address:=sload(add(exchange_ptr,1))ifiszero(eq(caller,withdraw_address)){mstore(32,1)revert(63,1)}letexchange_balance_ptr:=add(add(exchange_ptr,4),asset_id)letexchange_balance:=sload(exchange_balance_ptr)ifgt(quantity,exchange_balance){mstore(32,2)revert(63,1)}sstore(exchange_balance_ptr,sub(exchange_balance,quantity))letasset_ptr:=add(assets_slot,mul(2,asset_id))letunit_scale:=and(sload(asset_ptr),0xffffffffffffffffffffffffffffffffffffffffffffffff)letasset_address:=sload(add(asset_ptr,1))letwithdraw:=mul(quantity,unit_scale)mstore(transfer_in_mem,0xa9059cbb00000000000000000000000000000000000000000000000000000000)mstore(add(transfer_in_mem,4),destination)mstore(add(transfer_in_mem,36),withdraw){letsuccess:=call(gas,asset_address,0,transfer_in_mem,68,transfer_out_mem,32)ifiszero(success){mstore(32,3)revert(63,1)}switchreturndatasizecase0{}case32{letresult:=mload(transfer_out_mem)ifiszero(result){mstore(32,4)revert(63,1)}}default{mstore(32,4)revert(63,1)}}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 695
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x8){mstore(32,0)revert(63,1)}}{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}}{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,2)revert(63,1)}}letexchange_balance_ptr:=add(add(add(exchanges_slot,mul(4294967300,exchange_id)),4),asset_id)letexchange_balance:=sload(exchange_balance_ptr)letupdated_balance:=add(exchange_balance,quantity)ifgt(updated_balance,0xFFFFFFFFFFFFFFFF){mstore(32,3)revert(63,1)}letasset_ptr:=add(assets_slot,mul(2,asset_id))letunit_scale:=and(sload(asset_ptr),0xffffffffffffffffffffffffffffffffffffffffffffffff)letasset_address:=sload(add(asset_ptr,1))letdeposit:=mul(quantity,unit_scale)sstore(exchange_balance_ptr,updated_balance)mstore(transfer_in_mem,0x23b872dd00000000000000000000000000000000000000000000000000000000)mstore(add(transfer_in_mem,4),caller)mstore(add(transfer_in_mem,36),address)mstore(add(transfer_in_mem,68),deposit){letsuccess:=call(gas,asset_address,0,transfer_in_mem,100,transfer_out_mem,32)ifiszero(success){mstore(32,4)revert(63,1)}switchreturndatasizecase0{}case32{letresult:=mload(transfer_out_mem)ifiszero(result){mstore(32,5)revert(63,1)}}default{mstore(32,5)revert(63,1)}}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 761
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x10){mstore(32,0)revert(63,1)}}{letuser_count:=sload(user_count_slot)ifiszero(lt(user_id,user_count)){mstore(32,1)revert(63,1)}}{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,2)revert(63,1)}}ifiszero(amount){stop()}letbalance_ptr:=add(add(add(users_slot,mul(237684487561239756867226304516,user_id)),4),asset_id)letcurrent_balance:=sload(balance_ptr)letproposed_balance:=add(current_balance,amount)iflt(proposed_balance,current_balance){mstore(32,3)revert(63,1)}letasset_address:=sload(add(add(assets_slot,mul(2,asset_id)),1))sstore(balance_ptr,proposed_balance)mstore(transfer_in_mem,0x23b872dd00000000000000000000000000000000000000000000000000000000)mstore(add(transfer_in_mem,4),caller)mstore(add(transfer_in_mem,36),address)mstore(add(transfer_in_mem,68),amount){letsuccess:=call(gas,asset_address,0,transfer_in_mem,100,transfer_out_mem,32)ifiszero(success){mstore(32,4)revert(63,1)}switchreturndatasizecase0{}case32{letresult:=mload(transfer_out_mem)ifiszero(result){mstore(32,5)revert(63,1)}}default{mstore(32,5)revert(63,1)}}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 827
column: 4
content: assembly{ifiszero(amount){stop()}{letuser_count:=sload(user_count_slot)ifiszero(lt(user_id,user_count)){mstore(32,6)revert(63,1)}}{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,1)revert(63,1)}}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))letwithdraw_address:=sload(add(user_ptr,1))ifiszero(eq(caller,withdraw_address)){mstore(32,2)revert(63,1)}letbalance_ptr:=add(add(user_ptr,4),asset_id)letcurrent_balance:=sload(balance_ptr)iflt(current_balance,amount){mstore(32,3)revert(63,1)}sstore(balance_ptr,sub(current_balance,amount))letasset_address:=sload(add(add(assets_slot,mul(2,asset_id)),1))mstore(transfer_in_mem,0xa9059cbb00000000000000000000000000000000000000000000000000000000)mstore(add(transfer_in_mem,4),destination)mstore(add(transfer_in_mem,36),amount){letsuccess:=call(gas,asset_address,0,transfer_in_mem,68,transfer_out_mem,32)ifiszero(success){mstore(32,4)revert(63,1)}switchreturndatasizecase0{}case32{letresult:=mload(transfer_out_mem)ifiszero(result){mstore(32,5)revert(63,1)}}default{mstore(32,5)revert(63,1)}}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 888
column: 4
content: assembly{{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))lettrade_address:=sload(add(user_ptr,0))ifiszero(eq(caller,trade_address)){mstore(32,2)revert(63,1)}{letfails_min_time:=lt(unlock_at,add(timestamp,28800))letfails_max_time:=gt(unlock_at,add(timestamp,1209600))ifor(fails_min_time,fails_max_time){mstore(32,3)revert(63,1)}}letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letunlock_at_ptr:=add(session_ptr,0)iflt(sload(unlock_at_ptr),timestamp){sstore(add(session_ptr,1),caller)}sstore(unlock_at_ptr,unlock_at)mstore(log_data_mem,user_id)mstore(add(log_data_mem,32),exchange_id)log1(log_data_mem,64,0x1b0c381a98d9352dd527280acefa9a69d2c111b6a9d3aa3063aac6c2ec7f3163)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 926
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x400){mstore(32,0)revert(63,1)}}{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id))lettrade_address:=sload(add(user_ptr,0))ifiszero(eq(caller,trade_address)){mstore(32,2)revert(63,1)}letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letunlock_at:=sload(add(session_ptr,0))ifgt(unlock_at,timestamp){mstore(32,3)revert(63,1)}letmarket_state_ptr:=add(add(session_ptr,4294967298),mul(3,or(mul(quote_asset_id,4294967296),base_asset_id)))sstore(market_state_ptr,0)sstore(add(market_state_ptr,1),0)letmarket_state_2_ptr:=add(market_state_ptr,2)letmarket_state_2:=sload(market_state_2_ptr)letlimit_version:=add(and(div(market_state_2,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff),1)sstore(market_state_2_ptr,mul(limit_version,0x1000000000000000000000000000000000000000000000000))}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 967
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x20){mstore(32,0)revert(63,1)}}{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}}{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,2)revert(63,1)}}ifiszero(quantity){stop()}letasset_ptr:=add(assets_slot,mul(2,asset_id))letunit_scale:=and(sload(asset_ptr),0xffffffffffffffffffffffffffffffffffffffffffffffff)letscaled_quantity:=mul(quantity,unit_scale)letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id)){letwithdraw_address:=sload(add(user_ptr,1))ifiszero(eq(caller,withdraw_address)){mstore(32,3)revert(63,1)}}letuser_balance_ptr:=add(add(user_ptr,4),asset_id)letuser_balance:=sload(user_balance_ptr)iflt(user_balance,scaled_quantity){mstore(32,4)revert(63,1)}letsession_balance_ptr:=add(add(add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id)),2),asset_id)letsession_balance_0:=sload(session_balance_ptr)letupdated_exchange_balance:=add(and(session_balance_0,0xffffffffffffffff),quantity)ifgt(updated_exchange_balance,0xFFFFFFFFFFFFFFFF){mstore(32,5)revert(63,1)}letupdated_total_deposit:=add(and(div(session_balance_0,0x100000000000000000000000000000000),0xffffffffffffffffffffffffffffffff),quantity)sstore(user_balance_ptr,sub(user_balance,scaled_quantity))sstore(session_balance_ptr,or(and(0xffffffffffffffff0000000000000000,session_balance_0),or(mul(updated_total_deposit,0x100000000000000000000000000000000),updated_exchange_balance)))mstore(log_data_mem,user_id)mstore(add(log_data_mem,32),exchange_id)mstore(add(log_data_mem,64),asset_id)log1(log_data_mem,96,0x7a2923ebfa019dc20de0ae2be0c8639b07e068b143e98ed7f7a74dc4d4f5ab45)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1033
column: 4
content: assembly{ifiszero(quantity){stop()}{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}}{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,2)revert(63,1)}}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,user_id)){lettrade_address:=sload(add(user_ptr,0))ifiszero(eq(caller,trade_address)){mstore(32,3)revert(63,1)}}letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id)){letsession_0:=sload(session_ptr)letunlock_at:=session_0ifgt(unlock_at,timestamp){mstore(32,4)revert(63,1)}}letsession_balance_ptr:=add(add(session_ptr,2),asset_id)letsession_balance_0:=sload(session_balance_ptr)letsession_balance:=and(session_balance_0,0xffffffffffffffff)ifgt(quantity,session_balance){mstore(32,5)revert(63,1)}letupdated_exchange_balance:=sub(session_balance,quantity)letunsettled_withdraw_total:=and(div(session_balance_0,0x10000000000000000),0xffffffffffffffff)iflt(updated_exchange_balance,unsettled_withdraw_total){mstore(32,6)revert(63,1)}sstore(session_balance_ptr,or(and(0xffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000,session_balance_0),updated_exchange_balance))letasset_ptr:=add(assets_slot,mul(2,asset_id))letunit_scale:=and(sload(asset_ptr),0xffffffffffffffffffffffffffffffffffffffffffffffff)letscaled_quantity:=mul(quantity,unit_scale)letuser_balance_ptr:=add(add(user_ptr,4),asset_id)letuser_balance:=sload(user_balance_ptr)letupdated_user_balance:=add(user_balance,scaled_quantity)iflt(updated_user_balance,user_balance){mstore(32,7)revert(63,1)}sstore(user_balance_ptr,updated_user_balance)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1104
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x40){mstore(32,0)revert(63,1)}}{letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,1)revert(63,1)}}{letasset_count:=sload(asset_count_slot)ifiszero(lt(asset_id,asset_count)){mstore(32,2)revert(63,1)}}ifiszero(quantity){stop()}letsession_balance_ptr:=add(add(add(add(add(users_slot,mul(237684487561239756867226304516,user_id)),4294967300),mul(55340232225423622146,exchange_id)),2),asset_id)letsession_balance_0:=sload(session_balance_ptr)letupdated_exchange_balance:=add(and(session_balance_0,0xffffffffffffffff),quantity)ifgt(updated_exchange_balance,0xFFFFFFFFFFFFFFFF){mstore(32,3)revert(63,1)}letasset_ptr:=add(assets_slot,mul(2,asset_id))letunit_scale:=and(sload(asset_ptr),0xffffffffffffffffffffffffffffffffffffffffffffffff)letasset_address:=sload(add(asset_ptr,1))letscaled_quantity:=mul(quantity,unit_scale)letupdated_total_deposit:=add(and(div(session_balance_0,0x100000000000000000000000000000000),0xffffffffffffffffffffffffffffffff),quantity)sstore(session_balance_ptr,or(and(0xffffffffffffffff0000000000000000,session_balance_0),or(mul(updated_total_deposit,0x100000000000000000000000000000000),updated_exchange_balance)))mstore(transfer_in_mem,0x23b872dd00000000000000000000000000000000000000000000000000000000)mstore(add(transfer_in_mem,4),caller)mstore(add(transfer_in_mem,36),address)mstore(add(transfer_in_mem,68),scaled_quantity){letsuccess:=call(gas,asset_address,0,transfer_in_mem,100,transfer_out_mem,32)ifiszero(success){mstore(32,4)revert(63,1)}switchreturndatasizecase0{}case32{letresult:=mload(transfer_out_mem)ifiszero(result){mstore(32,5)revert(63,1)}}default{mstore(32,5)revert(63,1)}}mstore(log_data_mem,user_id)mstore(add(log_data_mem,32),exchange_id)mstore(add(log_data_mem,64),asset_id)log1(log_data_mem,96,0x7a2923ebfa019dc20de0ae2be0c8639b07e068b143e98ed7f7a74dc4d4f5ab45)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1186
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x800){mstore(32,0)revert(63,1)}}letdata_len:=mload(data)letcursor:=add(data,32)letcursor_end:=add(cursor,data_len)for{}lt(cursor,cursor_end){}{letunsettled_withdraw_header_0:=mload(cursor)letexchange_id:=and(div(unsettled_withdraw_header_0,0x100000000000000000000000000000000000000000000000000000000),0xffffffff)letasset_id:=and(div(unsettled_withdraw_header_0,0x1000000000000000000000000000000000000000000000000),0xffffffff)letuser_count:=and(div(unsettled_withdraw_header_0,0x10000000000000000000000000000000000000000),0xffffffff)letgroup_end:=add(cursor,add(12,mul(user_count,8)))ifgt(group_end,cursor_end){mstore(32,1)revert(63,1)}letexchange_balance_ptr:=add(add(add(exchanges_slot,mul(4294967300,exchange_id)),4),asset_id)letexchange_balance:=sload(exchange_balance_ptr)letstart_exchange_balance:=exchange_balancefor{}lt(cursor,group_end){cursor:=add(cursor,8)}{letuser_id:=and(div(mload(cursor),0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)letsession_balance_ptr:=add(add(add(add(add(users_slot,mul(237684487561239756867226304516,user_id)),4294967300),mul(55340232225423622146,exchange_id)),2),asset_id)letsession_balance_0:=sload(session_balance_ptr)letasset_balance:=and(session_balance_0,0xffffffffffffffff)letunsettled_balance:=and(div(session_balance_0,0x10000000000000000),0xffffffffffffffff)letto_recover:=unsettled_balanceifgt(to_recover,asset_balance){to_recover:=asset_balance}ifto_recover{exchange_balance:=add(exchange_balance,to_recover)asset_balance:=sub(asset_balance,to_recover)unsettled_balance:=sub(unsettled_balance,to_recover)ifgt(start_exchange_balance,exchange_balance){mstore(32,2)revert(63,1)}sstore(session_balance_ptr,or(and(0xffffffffffffffffffffffffffffffff00000000000000000000000000000000,session_balance_0),or(mul(unsettled_balance,0x10000000000000000),asset_balance)))}}sstore(exchange_balance_ptr,exchange_balance)}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1253
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x80){mstore(32,0)revert(63,1)}}letdata_len:=mload(data)letcursor:=add(data,32)letcursor_end:=add(cursor,data_len)letheader_0:=mload(cursor)cursor:=add(cursor,4)ifgt(cursor,cursor_end){mstore(32,1)revert(63,1)}letexchange_id:=and(div(header_0,0x100000000000000000000000000000000000000000000000000000000),0xffffffff){letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,2)revert(63,1)}}{letexchange_data:=sload(add(exchanges_slot,mul(4294967300,exchange_id)))ifiszero(eq(caller,and(exchange_data,0xffffffffffffffffffffffffffffffffffffffff))){mstore(32,3)revert(63,1)}ifand(div(exchange_data,0x10000000000000000000000000000000000000000),0xff){mstore(32,4)revert(63,1)}}letasset_count:=sload(asset_count_slot)for{}lt(cursor,cursor_end){}{letgroup_0:=mload(cursor)cursor:=add(cursor,6)ifgt(cursor,cursor_end){mstore(32,5)revert(63,1)}letasset_id:=and(div(group_0,0x100000000000000000000000000000000000000000000000000000000),0xffffffff)ifiszero(lt(asset_id,asset_count)){mstore(32,6)revert(63,1)}letdisallow_overdraft:=iszero(and(div(group_0,0x1000000000000000000000000000000000000000000000000000000),0xff))letcursor_group_end:=add(cursor,mul(and(div(group_0,0x10000000000000000000000000000000000000000000000000000),0xff),16))ifgt(cursor_group_end,cursor_end){mstore(32,7)revert(63,1)}letexchange_balance_ptr:=add(add(add(exchanges_slot,mul(4294967300,exchange_id)),4),asset_id)letexchange_balance_remaining:=sload(exchange_balance_ptr)letunit_scale:=and(sload(add(assets_slot,mul(2,asset_id))),0xffffffffffffffffffffffffffffffffffffffffffffffff)for{}lt(cursor,cursor_group_end){cursor:=add(cursor,16)}{lettransfer_0:=mload(cursor)letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,and(div(transfer_0,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)))letquantity:=and(div(transfer_0,0x100000000000000000000000000000000),0xffffffffffffffff)letexchange_balance_used:=0letsession_balance_ptr:=add(add(add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id)),2),asset_id)letsession_balance_0:=sload(session_balance_ptr)letsession_balance:=and(session_balance_0,0xffffffffffffffff)letsession_balance_updated:=sub(session_balance,quantity)ifgt(session_balance_updated,session_balance){ifdisallow_overdraft{mstore(32,8)revert(63,1)}exchange_balance_used:=sub(quantity,session_balance)session_balance_updated:=0ifgt(exchange_balance_used,exchange_balance_remaining){mstore(32,9)revert(63,1)}exchange_balance_remaining:=sub(exchange_balance_remaining,exchange_balance_used)}letquantity_scaled:=mul(quantity,unit_scale)letuser_balance_ptr:=add(add(user_ptr,4),asset_id)letuser_balance:=sload(user_balance_ptr)letupdated_user_balance:=add(user_balance,quantity_scaled)ifgt(user_balance,updated_user_balance){mstore(32,10)revert(63,1)}letunsettled_withdraw_total_updated:=add(and(div(session_balance_0,0x10000000000000000),0xffffffffffffffff),exchange_balance_used)ifgt(unsettled_withdraw_total_updated,0xFFFFFFFFFFFFFFFF){mstore(32,11)revert(63,1)}sstore(session_balance_ptr,or(and(0xffffffffffffffffffffffffffffffff00000000000000000000000000000000,session_balance_0),or(mul(unsettled_withdraw_total_updated,0x10000000000000000),session_balance_updated)))sstore(user_balance_ptr,updated_user_balance)}sstore(exchange_balance_ptr,exchange_balance_remaining)}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1398
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x100){mstore(32,0)revert(63,1)}}letdata_size:=mload(data)cursor:=add(data,32)cursor_end:=add(cursor,data_size)letset_limits_header_0:=mload(cursor)cursor:=add(cursor,4)ifgt(cursor,cursor_end){mstore(32,1)revert(63,1)}exchange_id:=and(div(set_limits_header_0,0x100000000000000000000000000000000000000000000000000000000),0xffffffff)letexchange_0:=sload(add(exchanges_slot,mul(4294967300,exchange_id)))letexchange_owner:=and(exchange_0,0xffffffffffffffffffffffffffffffffffffffff)ifiszero(eq(caller,exchange_owner)){mstore(32,2)revert(63,1)}ifand(div(exchange_0,0x10000000000000000000000000000000000000000),0xff){mstore(32,3)revert(63,1)}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1433
column: 8
content: assembly{ifeq(cursor,cursor_end){return(0,0)}update_limit_0:=mload(cursor)update_limit_1:=mload(add(cursor,32))update_limit_2:=mload(add(cursor,64))cursor:=add(cursor,96)ifgt(cursor,cursor_end){mstore(32,4)revert(63,1)}{mstore(to_hash_mem,0xbe6b685e53075dd48bdabc4949b848400d5a7e53705df48e04ace664c3946ad2)lettemp_var:=0temp_var:=and(div(update_limit_0,0x100000000000000000000000000000000000000000000000000000000),0xffffffff)mstore(add(to_hash_mem,32),temp_var)temp_var:=and(div(update_limit_0,0x10000000000000000000000000000000000000000),0xffffffffffffffff)mstore(add(to_hash_mem,64),temp_var)mstore(add(set_limit_memory_space,0),temp_var)temp_var:=and(div(update_limit_0,0x100000000000000000000000000000000),0xffffffff)mstore(add(to_hash_mem,96),temp_var)temp_var:=and(div(update_limit_0,0x1000000000000000000000000),0xffffffff)mstore(add(to_hash_mem,128),temp_var)mstore(add(set_limit_memory_space,64),temp_var)temp_var:=and(div(update_limit_0,0x10000000000000000),0xffffffff)mstore(add(to_hash_mem,160),temp_var)mstore(add(set_limit_memory_space,96),temp_var)temp_var:=and(update_limit_0,0xffffffffffffffff)mstore(add(to_hash_mem,192),temp_var)temp_var:=and(div(update_limit_1,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)temp_var:=signextend(7,temp_var)mstore(add(to_hash_mem,224),temp_var)temp_var:=and(div(update_limit_1,0x100000000000000000000000000000000),0xffffffffffffffff)temp_var:=signextend(7,temp_var)mstore(add(to_hash_mem,256),temp_var)temp_var:=and(div(update_limit_1,0x10000000000000000),0xffffffffffffffff)mstore(add(to_hash_mem,288),temp_var)temp_var:=and(update_limit_1,0xffffffffffffffff)mstore(add(to_hash_mem,320),temp_var)temp_var:=and(div(update_limit_2,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)mstore(add(to_hash_mem,352),temp_var)mstore(add(set_limit_memory_space,128),temp_var)temp_var:=and(div(update_limit_2,0x1000000000000000000000000),0xffffffffffffffffffffffff)temp_var:=signextend(11,temp_var)mstore(add(to_hash_mem,384),temp_var)mstore(add(set_limit_memory_space,160),temp_var)temp_var:=and(update_limit_2,0xffffffffffffffffffffffff)temp_var:=signextend(11,temp_var)mstore(add(to_hash_mem,416),temp_var)mstore(add(set_limit_memory_space,192),temp_var)}limit_hash:=keccak256(to_hash_mem,448)mstore(to_hash_mem,0x1901000000000000000000000000000000000000000000000000000000000000)mstore(add(to_hash_mem,2),0xe3d3073cc59e3a3126c17585a7e516a048e61a9a1c82144af982d1c194b18710)mstore(add(to_hash_mem,34),limit_hash)limit_hash:=keccak256(to_hash_mem,66)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1495
column: 10
content: assembly{sig_r:=mload(cursor)sig_s:=mload(add(cursor,32))sig_v:=and(div(mload(add(cursor,64)),0x100000000000000000000000000000000000000000000000000000000000000),0xff)cursor:=add(cursor,65)ifgt(cursor,cursor_end){mstore(32,5)revert(63,1)}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1511
column: 10
content: assembly{letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,mload(add(set_limit_memory_space,0))))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))lettrade_address:=sload(add(session_ptr,1))ifiszero(eq(recovered_address,trade_address)){mstore(32,6)revert(63,1)}}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1521
column: 8
content: assembly{{ifiszero(eq(mload(add(set_limit_memory_space,32)),exchange_id)){mstore(32,7)revert(63,1)}}letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,mload(add(set_limit_memory_space,0))))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letmarket_state_ptr:=add(add(session_ptr,4294967298),mul(3,or(mul(mload(add(set_limit_memory_space,64)),4294967296),mload(add(set_limit_memory_space,96)))))letmarket_state_0:=sload(market_state_ptr)letmarket_state_1:=sload(add(market_state_ptr,1))letmarket_state_2:=sload(add(market_state_ptr,2)){letcurrent_limit_version:=and(div(market_state_2,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)ifiszero(gt(mload(add(set_limit_memory_space,128)),current_limit_version)){mstore(32,8)revert(63,1)}}letquote_qty:=and(div(market_state_0,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)quote_qty:=signextend(7,quote_qty)letbase_qty:=and(div(market_state_0,0x100000000000000000000000000000000),0xffffffffffffffff)base_qty:=signextend(7,base_qty){letcurrent_shift:=and(div(market_state_2,0x1000000000000000000000000),0xffffffffffffffffffffffff)current_shift:=signextend(11,current_shift)letnew_shift:=mload(add(set_limit_memory_space,160))quote_qty:=add(quote_qty,sub(new_shift,current_shift))ifor(slt(quote_qty,0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8000000000000000),sgt(quote_qty,0x7FFFFFFFFFFFFFFF)){mstore(32,9)revert(63,1)}}{letcurrent_shift:=and(market_state_2,0xffffffffffffffffffffffff)current_shift:=signextend(11,current_shift)letnew_shift:=mload(add(set_limit_memory_space,192))base_qty:=add(base_qty,sub(new_shift,current_shift))ifor(slt(base_qty,0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8000000000000000),sgt(base_qty,0x7FFFFFFFFFFFFFFF)){mstore(32,10)revert(63,1)}}letnew_market_state_0:=or(or(or(mul(and(quote_qty,0xffffffffffffffff),0x1000000000000000000000000000000000000000000000000),mul(and(base_qty,0xffffffffffffffff),0x100000000000000000000000000000000)),and(update_limit_0,0xffffffffffffffff)),and(0xffffffffffffffff0000000000000000,market_state_0))sstore(market_state_ptr,new_market_state_0)sstore(add(market_state_ptr,1),update_limit_1)sstore(add(market_state_ptr,2),update_limit_2)}

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 1593
column: 4
content: assembly{{letlocked_features:=sload(security_locked_features_slot)ifand(locked_features,0x200){mstore(32,0)revert(63,1)}}letdata_len:=mload(data)letcursor:=add(data,32)letcursor_end:=add(cursor,data_len)letexchange_id_0:=mload(cursor)cursor:=add(cursor,4)ifgt(cursor,cursor_end){mstore(32,1)revert(63,1)}letexchange_id:=and(div(exchange_id_0,0x100000000000000000000000000000000000000000000000000000000),0xffffffff){letexchange_count:=sload(exchange_count_slot)ifiszero(lt(exchange_id,exchange_count)){mstore(32,2)revert(63,1)}}{letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_0:=sload(exchange_ptr)ifiszero(eq(caller,and(exchange_0,0xffffffffffffffffffffffffffffffffffffffff))){mstore(32,2)revert(63,1)}ifand(div(exchange_0,0x10000000000000000000000000000000000000000),0xff){mstore(32,3)revert(63,1)}}for{}lt(cursor,cursor_end){}{letheader_0:=mload(cursor)cursor:=add(cursor,9)ifgt(cursor,cursor_end){mstore(32,4)revert(63,1)}letquote_asset_id:=and(div(header_0,0x100000000000000000000000000000000000000000000000000000000),0xffffffff)letbase_asset_id:=and(div(header_0,0x1000000000000000000000000000000000000000000000000),0xffffffff)ifeq(quote_asset_id,base_asset_id){mstore(32,16)revert(63,1)}letgroup_end:=add(cursor,mul(and(div(header_0,0x10000000000000000000000000000000000000000000000),0xff),32)){letasset_count:=sload(asset_count_slot)ifiszero(and(lt(quote_asset_id,asset_count),lt(base_asset_id,asset_count))){mstore(32,5)revert(63,1)}}ifgt(group_end,cursor_end){mstore(32,6)revert(63,1)}letquote_net:=0letbase_net:=0letexchange_ptr:=add(exchanges_slot,mul(4294967300,exchange_id))letexchange_balance_ptr:=add(add(exchange_ptr,4),quote_asset_id)letexchange_balance:=sload(exchange_balance_ptr)for{}lt(cursor,group_end){cursor:=add(cursor,32)}{letsettlement_0:=mload(cursor)letuser_ptr:=add(users_slot,mul(237684487561239756867226304516,and(div(settlement_0,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)))letsession_ptr:=add(add(user_ptr,4294967300),mul(55340232225423622146,exchange_id))letmarket_state_ptr:=add(add(session_ptr,4294967298),mul(3,or(mul(quote_asset_id,4294967296),base_asset_id)))letquote_delta:=and(div(settlement_0,0x100000000000000000000000000000000),0xffffffffffffffff)quote_delta:=signextend(7,quote_delta)letbase_delta:=and(div(settlement_0,0x10000000000000000),0xffffffffffffffff)base_delta:=signextend(7,base_delta)quote_net:=add(quote_net,quote_delta)base_net:=add(base_net,base_delta)letfees:=and(settlement_0,0xffffffffffffffff)exchange_balance:=add(exchange_balance,fees)letmarket_state_0:=sload(market_state_ptr){letquote_qty:=and(div(market_state_0,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)quote_qty:=signextend(7,quote_qty)letbase_qty:=and(div(market_state_0,0x100000000000000000000000000000000),0xffffffffffffffff)base_qty:=signextend(7,base_qty)quote_qty:=add(quote_qty,quote_delta)base_qty:=add(base_qty,base_delta)ifor(or(slt(quote_qty,0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8000000000000000),sgt(quote_qty,0x7FFFFFFFFFFFFFFF)),or(slt(base_qty,0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8000000000000000),sgt(base_qty,0x7FFFFFFFFFFFFFFF))){mstore(32,7)revert(63,1)}letfee_used:=add(and(div(market_state_0,0x10000000000000000),0xffffffffffffffff),fees)letfee_limit:=and(market_state_0,0xffffffffffffffff)ifgt(fee_used,fee_limit){mstore(32,8)revert(63,1)}market_state_0:=or(or(or(mul(quote_qty,0x1000000000000000000000000000000000000000000000000),mul(and(base_qty,0xFFFFFFFFFFFFFFFF),0x100000000000000000000000000000000)),mul(fee_used,0x10000000000000000)),fee_limit)letmarket_state_1:=sload(add(market_state_ptr,1)){letmin_quote_qty:=and(div(market_state_1,0x1000000000000000000000000000000000000000000000000),0xffffffffffffffff)min_quote_qty:=signextend(7,min_quote_qty)letmin_base_qty:=and(div(market_state_1,0x100000000000000000000000000000000),0xffffffffffffffff)min_base_qty:=signextend(7,min_base_qty)ifor(slt(quote_qty,min_quote_qty),slt(base_qty,min_base_qty)){mstore(32,9)revert(63,1)}}{letnegatives:=add(slt(quote_qty,1),mul(slt(base_qty,1),2))switchnegativescase3{ifor(quote_qty,base_qty){mstore(32,10)revert(63,1)}}case1{letcurrent_price:=div(mul(sub(0,quote_qty),100000000),base_qty)letlong_max_price:=and(div(market_state_1,0x10000000000000000),0xffffffffffffffff)ifgt(current_price,long_max_price){mstore(32,11)revert(63,1)}}case2{ifbase_qty{letcurrent_price:=div(mul(quote_qty,100000000),sub(0,base_qty))letshort_min_price:=and(market_state_1,0xffffffffffffffff)iflt(current_price,short_min_price){mstore(32,12)revert(63,1)}}}}}letquote_session_balance_ptr:=add(add(session_ptr,2),quote_asset_id)letbase_session_balance_ptr:=add(add(session_ptr,2),base_asset_id)letquote_session_balance_0:=sload(quote_session_balance_ptr)letbase_session_balance_0:=sload(base_session_balance_ptr)letquote_balance:=and(quote_session_balance_0,0xffffffffffffffff)quote_balance:=add(quote_balance,quote_delta)quote_balance:=sub(quote_balance,fees)ifgt(quote_balance,0xFFFFFFFFFFFFFFFF){mstore(32,13)revert(63,1)}letbase_balance:=and(base_session_balance_0,0xffffffffffffffff)base_balance:=add(base_balance,base_delta)ifgt(base_balance,0xFFFFFFFFFFFFFFFF){mstore(32,14)revert(63,1)}sstore(market_state_ptr,market_state_0)sstore(quote_session_balance_ptr,or(and(0xffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000,quote_session_balance_0),quote_balance))sstore(base_session_balance_ptr,or(and(0xffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000,base_session_balance_0),base_balance))}ifor(quote_net,base_net){mstore(32,15)revert(63,1)}sstore(exchange_balance_ptr,exchange_balance)}}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 7
column: 2
content: uint256creator;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 8
column: 2
content: uint256creator_recovery;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 9
column: 2
content: uint256creator_recovery_proposed;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 10
column: 2
content: uint256user_count;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 11
column: 2
content: uint256exchange_count;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 12
column: 2
content: uint256asset_count;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 13
column: 2
content: uint256security_locked_features;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 14
column: 2
content: uint256security_locked_features_proposed;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 15
column: 2
content: uint256security_proposed_unlock_timestamp;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 62
column: 2
content: User[18446744073709551616]users;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 63
column: 2
content: Asset[4294967296]assets;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 64
column: 2
content: Exchange[4294967296]exchanges;

SOLIDITY_VISIBILITY :12
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :16
SOLIDITY_GAS_LIMIT_IN_LOOPS :1
SOLIDITY_USING_INLINE_ASSEMBLY :49
SOLIDITY_SHOULD_RETURN_STRUCT :8
SOLIDITY_SHOULD_NOT_BE_VIEW :13