/unique_contracts/0x9473481877cb241b0c8f647bf841973196e61a1d.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 162
column: 18
content: 0x509A38b7a1cC0dcd83Aa9d06214663D9eC7c7F4a

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 354
column: 37
content: 0x7E8f1b7655fc05e48462082E5A12e53DBc33464a

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 355
column: 30
content: 0x84F4CE7a40238062edFe3CD552cacA656d862f27

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 356
column: 35
content: 0x3706E1CdB3254a1601098baE8D1A8312Cf92f282

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 89
column: 4
content: owner=address(0)

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 120
column: 4
content: functionbalanceOf(address_owner)publicconstantreturns(uint256_balance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 228
column: 4
content: functiongetFirstBuyer(address_firstBuyer)constantpublicreturns(uint256,uint256,uint256){return(firstBuyers[_firstBuyer].lastTransactionIndex,firstBuyers[_firstBuyer].tokensReceived,firstBuyers[_firstBuyer].weightedContribution);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 236
column: 4
content: functiongetNumberOfFirstBuyer()constantpublicreturns(uint256){returnnumOfFirstBuyers;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 245
column: 4
content: functiongetFirstBuyerAddress(uint256_index)constantpublicreturns(address){returnfirstBuyerIndex[_index];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 253
column: 4
content: functiongetNumberOfTransactions()constantpublicreturns(uint256){returnnumOfTransaction;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 261
column: 4
content: functiongetTotalWeightedContribution()constantpublicreturns(uint256){returntotalWeightedContribution;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 281
column: 4
content: functiontotalSupply()publicconstantreturns(uint256_totalSupply);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 282
column: 4
content: functionbalanceOf(address_owner)publicconstantreturns(uint256_balance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 286
column: 4
content: functionallowance(address_owner,address_spender)publicconstantreturns(uint256_remaining);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 293
column: 4
content: functioncanMakeNoFeeTransfer(address_from,address_to)constantpublicreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 294
column: 4
content: functiongetNetworkFee()publicconstantreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 295
column: 4
content: functiongetBlocksquareFee()publicconstantreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 296
column: 4
content: functiongetCPFee()publicconstantreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 297
column: 4
content: functiongetFirstBuyersFee()publicconstantreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 298
column: 4
content: functionhasPrestige(address_owner)publicconstantreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 519
column: 4
content: functionallowance(address_owner,address_spender)publicconstantreturns(uint256){returnallowances[_owner][_spender];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 527
column: 4
content: functiontotalSupply()publicconstantreturns(uint256){returnsupply;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 536
column: 4
content: functionbalanceOf(address_owner)publicconstantreturns(uint256){returnbalances[_owner];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 545
column: 4
content: functiongetPropertyInfo(uint8_index)publicconstantreturns(string,string,uint64,uint64,uint64){return(properties[_index].primaryPropertyType,properties[_index].secondaryPropertyType,properties[_index].cadastralMunicipality,properties[_index].parcelNumber,properties[_index].id);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 552
column: 4
content: functiongetMap()publicconstantreturns(string){returnmapURL;}

ruleId: SOLIDITY_ERC20_APPROVE
patternId: af782c
severity: 2
line: 460
column: 4
content: functionapprove(address_spender,uint256_amount)publicreturns(bool){allowances[msg.sender][_spender]=_amount;emitApproval(msg.sender,_spender,_amount);returntrue;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 172
column: 8
content: for(uint256i=0;i<_addresses.length;i++){uint256weightedContribution=(bst.balanceOf(_addresses[i]).mul(_amount[i])).div(10**18);FirstBuyerstoragebuyer=firstBuyers[_addresses[i]];uint256before=buyer.tokensReceived;buyer.tokensReceived=buyer.tokensReceived.add(_amount[i]);buyer.weightedContribution=buyer.weightedContribution.add(weightedContribution);property.mintTokens(_addresses[i],_amount[i]);firstBuyers[_addresses[i]]=buyer;totalWeightedContribution=totalWeightedContribution.add(weightedContribution);if(before==0){firstBuyerIndex[numOfFirstBuyers]=_addresses[i];numOfFirstBuyers++;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 172
column: 8
content: for(uint256i=0;i<_addresses.length;i++){uint256weightedContribution=(bst.balanceOf(_addresses[i]).mul(_amount[i])).div(10**18);FirstBuyerstoragebuyer=firstBuyers[_addresses[i]];uint256before=buyer.tokensReceived;buyer.tokensReceived=buyer.tokensReceived.add(_amount[i]);buyer.weightedContribution=buyer.weightedContribution.add(weightedContribution);property.mintTokens(_addresses[i],_amount[i]);firstBuyers[_addresses[i]]=buyer;totalWeightedContribution=totalWeightedContribution.add(weightedContribution);if(before==0){firstBuyerIndex[numOfFirstBuyers]=_addresses[i];numOfFirstBuyers++;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 123
column: 0
content: contractFirstBuyersisOwnable{usingSafeMathforuint256;modifieronlyFirstBuyer(){require(firstBuyers[msg.sender].tokensReceived>0);_;}structFirstBuyer{uint256lastTransactionIndex;uint256tokensReceived;uint256weightedContribution;}mapping(address=>FirstBuyer)firstBuyers;mapping(uint256=>uint256)transactions;mapping(uint256=>address)firstBuyerIndex;uint256numOfTransaction;uint256numOfFirstBuyers=0;uint256totalWeightedContribution;Propproperty;BSTbst;eventFirstBuyerWhitdraw(addressindexed_firstBuyer,uint256_amount);eventNewTransactionOfTokens(uint256_amount,uint256_index);constructor(address_property,address_owner)public{property=Prop(_property);owner=_owner;bst=BST(0x509A38b7a1cC0dcd83Aa9d06214663D9eC7c7F4a);}functionaddFirstBuyers(address[]_addresses,uint256[]_amount)publiconlyOwner{require(_addresses.length==_amount.length);for(uint256i=0;i<_addresses.length;i++){uint256weightedContribution=(bst.balanceOf(_addresses[i]).mul(_amount[i])).div(10**18);FirstBuyerstoragebuyer=firstBuyers[_addresses[i]];uint256before=buyer.tokensReceived;buyer.tokensReceived=buyer.tokensReceived.add(_amount[i]);buyer.weightedContribution=buyer.weightedContribution.add(weightedContribution);property.mintTokens(_addresses[i],_amount[i]);firstBuyers[_addresses[i]]=buyer;totalWeightedContribution=totalWeightedContribution.add(weightedContribution);if(before==0){firstBuyerIndex[numOfFirstBuyers]=_addresses[i];numOfFirstBuyers++;}}}functionwithdrawTokens()publiconlyFirstBuyer{FirstBuyerstoragebuyer=firstBuyers[msg.sender];require(numOfTransaction>=buyer.lastTransactionIndex);uint256iterateOver=numOfTransaction.sub(buyer.lastTransactionIndex);if(iterateOver>30){iterateOver=30;}uint256iterate=buyer.lastTransactionIndex.add(iterateOver);uint256amount=0;for(uint256i=buyer.lastTransactionIndex;i<iterate;i++){uint256ratio=((buyer.weightedContribution.mul(10**14)).div(totalWeightedContribution));amount=amount.add((transactions[buyer.lastTransactionIndex].mul(ratio)).div(10**14));buyer.lastTransactionIndex=buyer.lastTransactionIndex.add(1);}assert(property.noFeeTransfer(msg.sender,amount));emitFirstBuyerWhitdraw(msg.sender,amount);}functionincomingTransaction(uint256_amount)public{require(msg.sender==address(property));transactions[numOfTransaction]=_amount;numOfTransaction+=1;emitNewTransactionOfTokens(_amount,numOfTransaction);}functiongetFirstBuyer(address_firstBuyer)constantpublicreturns(uint256,uint256,uint256){return(firstBuyers[_firstBuyer].lastTransactionIndex,firstBuyers[_firstBuyer].tokensReceived,firstBuyers[_firstBuyer].weightedContribution);}functiongetNumberOfFirstBuyer()constantpublicreturns(uint256){returnnumOfFirstBuyers;}functiongetFirstBuyerAddress(uint256_index)constantpublicreturns(address){returnfirstBuyerIndex[_index];}functiongetNumberOfTransactions()constantpublicreturns(uint256){returnnumOfTransaction;}functiongetTotalWeightedContribution()constantpublicreturns(uint256){returntotalWeightedContribution;}function()publicpayable{revert();}}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 377
column: 4
content: functionsetDataFactory(address_data)publiconlyOwner{data=Data(_data);}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 268
column: 31
content: {revert();}

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 124
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 306
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 268
column: 16
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 170
column: 28
content: address[]_addresses

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 170
column: 50
content: uint256[]_amount

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 368
column: 25
content: string_primaryPropertyType

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 368
column: 54
content: string_secondaryPropertyType

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 500
column: 37
content: string_reason

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 545
column: 68
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 545
column: 76
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 552
column: 47
content: string

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 140
column: 4
content: mapping(address=>FirstBuyer)firstBuyers;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 141
column: 4
content: mapping(uint256=>uint256)transactions;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 142
column: 4
content: mapping(uint256=>address)firstBuyerIndex;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 145
column: 4
content: uint256numOfTransaction;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 146
column: 4
content: uint256numOfFirstBuyers=0;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 147
column: 4
content: uint256totalWeightedContribution;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 148
column: 4
content: Propproperty;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 149
column: 4
content: BSTbst;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 318
column: 4
content: stringmapURL="https://www.google.com/maps/place/Tehnolo%C5%A1ki+park+Ljubljana+d.o.o./@46.0491873,14.458252,17z/data=!3m1!4b1!4m5!3m4!1s0x477ad2b1cdee0541:0x8e60f36e738253f0!8m2!3d46.0491873!4d14.4604407";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 333
column: 4
content: uint256supply;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 334
column: 4
content: uint256MAXSUPPLY=100000*10**18;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 335
column: 4
content: uint256feePercent;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 336
column: 4
content: mapping(address=>uint256)balances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 337
column: 4
content: mapping(address=>mapping(address=>uint256))allowances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 339
column: 4
content: Datadata;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 341
column: 4
content: Prop[]properties;

SOLIDITY_VISIBILITY :16
SOLIDITY_SAFEMATH :2
SOLIDITY_OVERPOWERED_ROLE :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :20
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :1
SOLIDITY_ADDRESS_HARDCODED :5
SOLIDITY_UPGRADE_TO_050 :9
SOLIDITY_GAS_LIMIT_IN_LOOPS :1
SOLIDITY_REDUNDANT_FALLBACK_REJECT :1
SOLIDITY_ERC20_APPROVE :1