/unique_contracts/0x111d30967038b08d5f3b0502940f8a5df13216a7.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 780
column: 32
content: 0xea0f17CA7C3e371af30EFE8CbA0e646374552e8B

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 782
column: 28
content: 0x4cA09B312F23b390450D902B21c7869AA64877E3

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 446
column: 19
content: 0xfd

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 448
column: 27
content: 0xfd

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 450
column: 27
content: 0xfe

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 452
column: 27
content: 0xff

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 605
column: 32
content: 0x76

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 606
column: 36
content: 0xa9

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 607
column: 36
content: 0x14

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 608
column: 37
content: 0x88

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 609
column: 37
content: 0xac

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 615
column: 36
content: 0xa9

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 616
column: 36
content: 0x14

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 617
column: 37
content: 0x87

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 145
column: 29
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 178
column: 31
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 195
column: 31
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 208
column: 35
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 222
column: 31
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 230
column: 29
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 235
column: 35
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 240
column: 35
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 248
column: 35
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 256
column: 35
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 274
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 314
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 683
column: 22
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 713
column: 22
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 820
column: 53
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 823
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 824
column: 21
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 825
column: 28
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 829
column: 36
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 841
column: 63
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 844
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 849
column: 64
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 852
column: 43
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 857
column: 34
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 861
column: 62
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 864
column: 39
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 874
column: 17
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 875
column: 48
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 876
column: 36
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 878
column: 19
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 880
column: 16
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 883
column: 28
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 895
column: 63
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 902
column: 64
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 909
column: 34
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 913
column: 62
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 926
column: 15
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 937
column: 26
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 949
column: 63
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 956
column: 64
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 963
column: 35
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 967
column: 62
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 976
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 86
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 90
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 217
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance){returnbalances[_owner];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 229
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining){if(!istransferAllowed)throw;returnallowed[_owner][_spender];}

ruleId: SOLIDITY_ERC20_APPROVE
patternId: af782c
severity: 2
line: 221
column: 4
content: functionapprove(address_spender,uint256_value)onlyPayloadSize(2*32)returns(boolsuccess){if(!istransferAllowed)throw;require((_value==0)||(allowed[msg.sender][_spender]==0));allowed[msg.sender][_spender]=_value;Approval(msg.sender,_spender,_value);returntrue;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 519
column: 8
content: for(uinti=0;i<output_values.length;i++){varpkhash=parseOutputScript(txBytes,script_starts[i],output_script_lens[i]);if(pkhash==btcAddress&&output_values[i]>=value){return(true,output_values[i]);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 519
column: 8
content: for(uinti=0;i<output_values.length;i++){varpkhash=parseOutputScript(txBytes,script_starts[i],output_script_lens[i]);if(pkhash==btcAddress&&output_values[i]>=value){return(true,output_values[i]);}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 97
column: 0
content: contractSMTTokenisToken,Ownable,Sales{stringpublicconstantname="Sun Money Token";stringpublicconstantsymbol="SMT";uint256publicconstantdecimals=18;stringpublicversion="1.0";uintpublicvalueToBeSent=1;addresspersonMakingTx;addresspublicaddr1;addresspublictxorigin;boolisTesting;bytes32testname;addressfinalOwner;boolpublicfinalizedPublicICO=false;boolpublicfinalizedPreICO=false;uint256publicSMTfundAfterPreICO;uint256publicethraised;uint256publicbtcraised;boolpublicistransferAllowed;uint256publicconstantSMTfund=10*(10**6)*10**decimals;uint256publicfundingStartBlock;uint256publicfundingEndBlock;uint256publictokensPerEther=150;uint256publictokensPerBTC=22*150*(10**10);uint256publictokenCreationMax=72*(10**5)*10**decimals;mapping(address=>bool)ownership;mapping(address=>uint256)balances;mapping(address=>mapping(address=>uint256))allowed;modifieronlyPayloadSize(uintsize){require(msg.data.length>=size+4);_;}functiontransfer(address_to,uint256_value)onlyPayloadSize(2*32)returns(boolsuccess){if(!istransferAllowed)throw;if(balances[msg.sender]>=_value&&_value>0){balances[msg.sender]-=_value;balances[_to]+=_value;Transfer(msg.sender,_to,_value);returntrue;}else{returnfalse;}}functionSMTToken(uint256_fundingStartBlock,uint256_fundingEndBlock){totalSupply=SMTfund;fundingStartBlock=_fundingStartBlock;fundingEndBlock=_fundingEndBlock;}ICOSaleStatepublicsalestate=ICOSaleState.PrivateSale;eventstateChange(ICOSaleStatestate);functionsetState(ICOSaleStatestate)returns(bool){if(!ownership[msg.sender])throw;salestate=state;stateChange(salestate);returntrue;}functiongetState()returns(ICOSaleState){returnsalestate;}functiontransferFrom(address_from,address_to,uint256_value)onlyPayloadSize(3*32)returns(boolsuccess){if(!istransferAllowed)throw;if(balances[_from]>=_value&&allowed[_from][msg.sender]>=_value&&_value>0){balances[_to]+=_value;balances[_from]-=_value;allowed[_from][msg.sender]-=_value;Transfer(_from,_to,_value);returntrue;}else{returnfalse;}}functionaddToBalances(address_person,uint256value){if(!ownership[msg.sender])throw;balances[_person]=SafeMath.add(balances[_person],value);}functionaddToOwnership(addressowners)onlyOwner{ownership[owners]=true;}functionbalanceOf(address_owner)constantreturns(uint256balance){returnbalances[_owner];}functionapprove(address_spender,uint256_value)onlyPayloadSize(2*32)returns(boolsuccess){if(!istransferAllowed)throw;require((_value==0)||(allowed[msg.sender][_spender]==0));allowed[msg.sender][_spender]=_value;Approval(msg.sender,_spender,_value);returntrue;}functionallowance(address_owner,address_spender)constantreturns(uint256remaining){if(!istransferAllowed)throw;returnallowed[_owner][_spender];}functionincreaseEthRaised(uint256value){if(!ownership[msg.sender])throw;ethraised+=value;}functionincreaseBTCRaised(uint256value){if(!ownership[msg.sender])throw;btcraised+=value;}functionfinalizePreICO(uint256value)returns(bool){if(!ownership[msg.sender])throw;finalizedPreICO=true;SMTfundAfterPreICO=value;returntrue;}functionfinalizePublicICO()returns(bool){if(!ownership[msg.sender])throw;finalizedPublicICO=true;istransferAllowed=true;returntrue;}functionisValid()returns(bool){if(block.number>=fundingStartBlock&&block.number<fundingEndBlock){returntrue;}else{returnfalse;}}function()payable{throw;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 754
column: 0
content: contractPreICOisOwnable,Pausable,Utils,PricingStrategy,Sales{SMTTokentoken;uint256publictokensPerBTC;uintpublictokensPerEther;uint256publicinitialSupplyPrivateSale;uint256publicinitialSupplyPreSale;uint256publicSMTfundAfterPreICO;uint256publicinitialSupplyPublicPreICO;uint256publiccurrentSupply;uint256publicfundingStartBlock;uint256publicfundingEndBlock;uint256publicSMTfund;uint256publictokenCreationMaxPreICO=15*(10**5)*10**18;uint256publictokenCreationMaxPrivateSale=15*(10**5)*(10**18);uint256publicteam=1*(10**6)*(10**18);uint256publicreserve=1*(10**6)*(10**18);uint256publicmentors=5*(10**5)*10**18;uint256publicbounty=3*(10**5)*10**18;uint256totalsend=team+reserve+bounty+mentors;addresspublicaddressPeople=0xea0f17CA7C3e371af30EFE8CbA0e646374552e8B;addresspublicownerAddr=0x4cA09B312F23b390450D902B21c7869AA64877E3;uint256publicnumberOfBackers;mapping(uint256=>bool)transactionsClaimed;uint256publicvalueToBeSent;functionPreICO(addresstokenAddress){token=SMTToken(tokenAddress);tokensPerEther=token.tokensPerEther();tokensPerBTC=token.tokensPerBTC();valueToBeSent=token.valueToBeSent();SMTfund=token.SMTfund();}functionsendFunds()onlyOwner{token.addToBalances(addressPeople,totalsend);}functioncalNewTokens(uint256contribution,stringtypes)returns(uint256){uint256disc=totalDiscount(currentSupply,contribution,types);uint256CreatedTokens;if(keccak256(types)==keccak256("ethereum"))CreatedTokens=SafeMath.mul(contribution,tokensPerEther);elseif(keccak256(types)==keccak256("bitcoin"))CreatedTokens=SafeMath.mul(contribution,tokensPerBTC);uint256tokens=SafeMath.add(CreatedTokens,SafeMath.div(SafeMath.mul(CreatedTokens,disc),100));returntokens;}function()externalpayablestopInEmergency{if(token.getState()==ICOSaleState.PublicICO)throw;boolisfinalized=token.finalizedPreICO();boolisValid=token.isValid();if(isfinalized)throw;if(!isValid)throw;if(msg.value==0)throw;uint256newCreatedTokens;if(token.getState()==ICOSaleState.PrivateSale||token.getState()==ICOSaleState.PreSale){if((msg.value)<1*10**18)throw;newCreatedTokens=calNewTokens(msg.value,"ethereum");uint256temp=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);if(temp>tokenCreationMaxPrivateSale){uint256consumed=SafeMath.sub(tokenCreationMaxPrivateSale,initialSupplyPrivateSale);initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,consumed);currentSupply=SafeMath.add(currentSupply,consumed);uint256nonConsumed=SafeMath.sub(newCreatedTokens,consumed);uint256finalTokens=SafeMath.sub(nonConsumed,SafeMath.div(nonConsumed,10));switchState();initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,finalTokens);currentSupply=SafeMath.add(currentSupply,finalTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(msg.sender,SafeMath.add(finalTokens,consumed));if(!ownerAddr.send(msg.value))throw;token.increaseEthRaised(msg.value);}else{initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;numberOfBackers++;token.addToBalances(msg.sender,newCreatedTokens);if(!ownerAddr.send(msg.value))throw;token.increaseEthRaised(msg.value);}}elseif(token.getState()==ICOSaleState.PreICO){if(msg.value<5*10**17)throw;newCreatedTokens=calNewTokens(msg.value,"ethereum");initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(msg.sender,newCreatedTokens);if(!ownerAddr.send(msg.value))throw;token.increaseEthRaised(msg.value);}}functiontokenAssignExchange(addressaddr,uint256val,uint256txnHash)publiconlyOwner{if(val==0)throw;if(token.getState()==ICOSaleState.PublicICO)throw;if(transactionsClaimed[txnHash])throw;boolisfinalized=token.finalizedPreICO();if(isfinalized)throw;boolisValid=token.isValid();if(!isValid)throw;uint256newCreatedTokens;if(token.getState()==ICOSaleState.PrivateSale||token.getState()==ICOSaleState.PreSale){if(val<1*10**18)throw;newCreatedTokens=calNewTokens(val,"ethereum");uint256temp=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);if(temp>tokenCreationMaxPrivateSale){uint256consumed=SafeMath.sub(tokenCreationMaxPrivateSale,initialSupplyPrivateSale);initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,consumed);currentSupply=SafeMath.add(currentSupply,consumed);uint256nonConsumed=SafeMath.sub(newCreatedTokens,consumed);uint256finalTokens=SafeMath.sub(nonConsumed,SafeMath.div(nonConsumed,10));switchState();initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,finalTokens);currentSupply=SafeMath.add(currentSupply,finalTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,SafeMath.add(finalTokens,consumed));token.increaseEthRaised(val);}else{initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseEthRaised(val);}}elseif(token.getState()==ICOSaleState.PreICO){if(msg.value<5*10**17)throw;newCreatedTokens=calNewTokens(val,"ethereum");initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseEthRaised(val);}}functionprocessTransaction(bytestxn,uint256txHash,addressaddr,bytes20btcaddr)onlyOwnerreturns(uint){boolvalueSent;boolisValid=token.isValid();if(!isValid)throw;if(!transactionsClaimed[txHash]){var(a,b)=BTC.checkValueSent(txn,btcaddr,valueToBeSent);if(a){valueSent=true;transactionsClaimed[txHash]=true;uint256newCreatedTokens;if(token.getState()==ICOSaleState.PrivateSale||token.getState()==ICOSaleState.PreSale){if(b<45*10**5)throw;newCreatedTokens=calNewTokens(b,"bitcoin");uint256temp=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);if(temp>tokenCreationMaxPrivateSale){uint256consumed=SafeMath.sub(tokenCreationMaxPrivateSale,initialSupplyPrivateSale);initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,consumed);currentSupply=SafeMath.add(currentSupply,consumed);uint256nonConsumed=SafeMath.sub(newCreatedTokens,consumed);uint256finalTokens=SafeMath.sub(nonConsumed,SafeMath.div(nonConsumed,10));switchState();initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,finalTokens);currentSupply=SafeMath.add(currentSupply,finalTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,SafeMath.add(finalTokens,consumed));token.increaseBTCRaised(b);}else{initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseBTCRaised(b);}}elseif(token.getState()==ICOSaleState.PreICO){if(msg.value<225*10**4)throw;newCreatedTokens=calNewTokens(b,"bitcoin");initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseBTCRaised(b);}return1;}}else{throw;}}functionfinalizePreICO()publiconlyOwner{uint256val=currentSupply;token.finalizePreICO(val);}functionswitchState()internal{token.setState(ICOSaleState.PreICO);}}

ruleId: SOLIDITY_MSGVALUE_EQUALS_ZERO
patternId: 1df89a
severity: 1
line: 825
column: 12
content: msg.value==0

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 273
column: 22
content: {throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 145
column: 6
content: if(!istransferAllowed)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 178
column: 4
content: if(!ownership[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 195
column: 8
content: if(!istransferAllowed)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 208
column: 8
content: if(!ownership[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 222
column: 8
content: if(!istransferAllowed)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 230
column: 6
content: if(!istransferAllowed)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 235
column: 8
content: if(!ownership[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 240
column: 8
content: if(!ownership[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 248
column: 8
content: if(!ownership[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 256
column: 8
content: if(!ownership[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 313
column: 4
content: if(paused){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 683
column: 2
content: if(contribution==0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 713
column: 2
content: if(contribution==0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 820
column: 8
content: if(token.getState()==ICOSaleState.PublicICO)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 823
column: 8
content: if(isfinalized)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 824
column: 8
content: if(!isValid)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 825
column: 8
content: if(msg.value==0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 829
column: 9
content: if((msg.value)<1*10**18)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 841
column: 10
content: if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 844
column: 10
content: if(!ownerAddr.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 849
column: 7
content: if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 852
column: 13
content: if(!ownerAddr.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 857
column: 9
content: if(msg.value<5*10**17)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 861
column: 9
content: if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 864
column: 9
content: if(!ownerAddr.send(msg.value))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 874
column: 3
content: if(val==0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 875
column: 3
content: if(token.getState()==ICOSaleState.PublicICO)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 876
column: 3
content: if(transactionsClaimed[txnHash])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 878
column: 3
content: if(isfinalized)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 880
column: 3
content: if(!isValid)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 883
column: 9
content: if(val<1*10**18)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 895
column: 10
content: if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 902
column: 7
content: if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 909
column: 9
content: if(msg.value<5*10**17)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 913
column: 9
content: if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 926
column: 2
content: if(!isValid)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 929
column: 2
content: if(!transactionsClaimed[txHash]){var(a,b)=BTC.checkValueSent(txn,btcaddr,valueToBeSent);if(a){valueSent=true;transactionsClaimed[txHash]=true;uint256newCreatedTokens;if(token.getState()==ICOSaleState.PrivateSale||token.getState()==ICOSaleState.PreSale){if(b<45*10**5)throw;newCreatedTokens=calNewTokens(b,"bitcoin");uint256temp=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);if(temp>tokenCreationMaxPrivateSale){uint256consumed=SafeMath.sub(tokenCreationMaxPrivateSale,initialSupplyPrivateSale);initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,consumed);currentSupply=SafeMath.add(currentSupply,consumed);uint256nonConsumed=SafeMath.sub(newCreatedTokens,consumed);uint256finalTokens=SafeMath.sub(nonConsumed,SafeMath.div(nonConsumed,10));switchState();initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,finalTokens);currentSupply=SafeMath.add(currentSupply,finalTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,SafeMath.add(finalTokens,consumed));token.increaseBTCRaised(b);}else{initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseBTCRaised(b);}}elseif(token.getState()==ICOSaleState.PreICO){if(msg.value<225*10**4)throw;newCreatedTokens=calNewTokens(b,"bitcoin");initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseBTCRaised(b);}return1;}}else{throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 937
column: 9
content: if(b<45*10**5)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 949
column: 10
content: if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 956
column: 7
content: if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 963
column: 9
content: if(msg.value<225*10**4)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 967
column: 9
content: if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 548
column: 13
content: vari=0

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 581
column: 13
content: vari=0

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 20
column: 2
content: functionOwnable(){owner=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 86
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 87
column: 4
content: functiontransfer(address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 88
column: 4
content: functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 89
column: 4
content: functionapprove(address_spender,uint256_value)returns(boolsuccess);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 90
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 144
column: 4
content: functiontransfer(address_to,uint256_value)onlyPayloadSize(2*32)returns(boolsuccess){if(!istransferAllowed)throw;if(balances[msg.sender]>=_value&&_value>0){balances[msg.sender]-=_value;balances[_to]+=_value;Transfer(msg.sender,_to,_value);returntrue;}else{returnfalse;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 157
column: 4
content: functionSMTToken(uint256_fundingStartBlock,uint256_fundingEndBlock){totalSupply=SMTfund;fundingStartBlock=_fundingStartBlock;fundingEndBlock=_fundingEndBlock;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 177
column: 4
content: functionsetState(ICOSaleStatestate)returns(bool){if(!ownership[msg.sender])throw;salestate=state;stateChange(salestate);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 187
column: 4
content: functiongetState()returns(ICOSaleState){returnsalestate;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 194
column: 4
content: functiontransferFrom(address_from,address_to,uint256_value)onlyPayloadSize(3*32)returns(boolsuccess){if(!istransferAllowed)throw;if(balances[_from]>=_value&&allowed[_from][msg.sender]>=_value&&_value>0){balances[_to]+=_value;balances[_from]-=_value;allowed[_from][msg.sender]-=_value;Transfer(_from,_to,_value);returntrue;}else{returnfalse;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 207
column: 4
content: functionaddToBalances(address_person,uint256value){if(!ownership[msg.sender])throw;balances[_person]=SafeMath.add(balances[_person],value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 213
column: 4
content: functionaddToOwnership(addressowners)onlyOwner{ownership[owners]=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 217
column: 4
content: functionbalanceOf(address_owner)constantreturns(uint256balance){returnbalances[_owner];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 221
column: 4
content: functionapprove(address_spender,uint256_value)onlyPayloadSize(2*32)returns(boolsuccess){if(!istransferAllowed)throw;require((_value==0)||(allowed[msg.sender][_spender]==0));allowed[msg.sender][_spender]=_value;Approval(msg.sender,_spender,_value);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 229
column: 4
content: functionallowance(address_owner,address_spender)constantreturns(uint256remaining){if(!istransferAllowed)throw;returnallowed[_owner][_spender];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 234
column: 4
content: functionincreaseEthRaised(uint256value){if(!ownership[msg.sender])throw;ethraised+=value;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 239
column: 4
content: functionincreaseBTCRaised(uint256value){if(!ownership[msg.sender])throw;btcraised+=value;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 247
column: 4
content: functionfinalizePreICO(uint256value)returns(bool){if(!ownership[msg.sender])throw;finalizedPreICO=true;SMTfundAfterPreICO=value;returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 255
column: 4
content: functionfinalizePublicICO()returns(bool){if(!ownership[msg.sender])throw;finalizedPublicICO=true;istransferAllowed=true;returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 263
column: 4
content: functionisValid()returns(bool){if(block.number>=fundingStartBlock&&block.number<fundingEndBlock){returntrue;}else{returnfalse;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 273
column: 4
content: function()payable{throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 441
column: 4
content: functionparseVarInt(bytestxBytes,uintpos)returns(uint,uint){varibit=uint8(txBytes[pos]);pos+=1;if(ibit<0xfd){return(ibit,pos);}elseif(ibit==0xfd){return(getBytesLE(txBytes,pos,16),pos+2);}elseif(ibit==0xfe){return(getBytesLE(txBytes,pos,32),pos+4);}elseif(ibit==0xff){return(getBytesLE(txBytes,pos,64),pos+8);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 457
column: 4
content: functiongetBytesLE(bytesdata,uintpos,uintbits)returns(uint){if(bits==8){returnuint8(data[pos]);}elseif(bits==16){returnuint16(data[pos])+uint16(data[pos+1])*2**8;}elseif(bits==32){returnuint32(data[pos])+uint32(data[pos+1])*2**8+uint32(data[pos+2])*2**16+uint32(data[pos+3])*2**24;}elseif(bits==64){returnuint64(data[pos])+uint64(data[pos+1])*2**8+uint64(data[pos+2])*2**16+uint64(data[pos+3])*2**24+uint64(data[pos+4])*2**32+uint64(data[pos+5])*2**40+uint64(data[pos+6])*2**48+uint64(data[pos+7])*2**56;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 481
column: 4
content: functiongetFirstTwoOutputs(bytestxBytes)returns(uint,bytes20,uint,bytes20){uintpos;uint[]memoryinput_script_lens=newuint[](2);uint[]memoryoutput_script_lens=newuint[](2);uint[]memoryscript_starts=newuint[](2);uint[]memoryoutput_values=newuint[](2);bytes20[]memoryoutput_addresses=newbytes20[](2);pos=4;(input_script_lens,pos)=scanInputs(txBytes,pos,0);(output_values,script_starts,output_script_lens,pos)=scanOutputs(txBytes,pos,2);for(uinti=0;i<2;i++){varpkhash=parseOutputScript(txBytes,script_starts[i],output_script_lens[i]);output_addresses[i]=pkhash;}return(output_values[0],output_addresses[0],output_values[1],output_addresses[1]);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 509
column: 4
content: functioncheckValueSent(bytestxBytes,bytes20btcAddress,uintvalue)returns(bool,uint){uintpos=4;(,pos)=scanInputs(txBytes,pos,0);var(output_values,script_starts,output_script_lens,)=scanOutputs(txBytes,pos,0);for(uinti=0;i<output_values.length;i++){varpkhash=parseOutputScript(txBytes,script_starts[i],output_script_lens[i]);if(pkhash==btcAddress&&output_values[i]>=value){return(true,output_values[i]);}}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 531
column: 4
content: functionscanInputs(bytestxBytes,uintpos,uintstop)returns(uint[],uint){uintn_inputs;uinthalt;uintscript_len;(n_inputs,pos)=parseVarInt(txBytes,pos);if(stop==0||stop>n_inputs){halt=n_inputs;}else{halt=stop;}uint[]memoryscript_lens=newuint[](halt);for(vari=0;i<halt;i++){pos+=36;(script_len,pos)=parseVarInt(txBytes,pos);script_lens[i]=script_len;pos+=script_len+4;}return(script_lens,pos);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 562
column: 4
content: functionscanOutputs(bytestxBytes,uintpos,uintstop)returns(uint[],uint[],uint[],uint){uintn_outputs;uinthalt;uintscript_len;(n_outputs,pos)=parseVarInt(txBytes,pos);if(stop==0||stop>n_outputs){halt=n_outputs;}else{halt=stop;}uint[]memoryscript_starts=newuint[](halt);uint[]memoryscript_lens=newuint[](halt);uint[]memoryoutput_values=newuint[](halt);for(vari=0;i<halt;i++){output_values[i]=getBytesLE(txBytes,pos,64);pos+=8;(script_len,pos)=parseVarInt(txBytes,pos);script_starts[i]=pos;script_lens[i]=script_len;pos+=script_len;}return(output_values,script_starts,script_lens,pos);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 594
column: 4
content: functionsliceBytes20(bytesdata,uintstart)returns(bytes20){uint160slice=0;for(uint160i=0;i<20;i++){slice+=uint160(data[i+start])<<(8*(19-i));}returnbytes20(slice);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 603
column: 4
content: functionisP2PKH(bytestxBytes,uintpos,uintscript_len)returns(bool){return(script_len==25)&&(txBytes[pos]==0x76)&&(txBytes[pos+1]==0xa9)&&(txBytes[pos+2]==0x14)&&(txBytes[pos+23]==0x88)&&(txBytes[pos+24]==0xac);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 613
column: 4
content: functionisP2SH(bytestxBytes,uintpos,uintscript_len)returns(bool){return(script_len==23)&&(txBytes[pos+0]==0xa9)&&(txBytes[pos+1]==0x14)&&(txBytes[pos+22]==0x87);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 622
column: 4
content: functionparseOutputScript(bytestxBytes,uintpos,uintscript_len)returns(bytes20){if(isP2PKH(txBytes,pos,script_len)){returnsliceBytes20(txBytes,pos+3);}elseif(isP2SH(txBytes,pos,script_len)){returnsliceBytes20(txBytes,pos+2);}else{return;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 682
column: 1
content: functionbaseDiscounts(uint256currentsupply,uint256contribution,stringtypes)returns(uint256){if(contribution==0)throw;if(keccak256("ethereum")==keccak256(types)){if(currentsupply>=0&&currentsupply<=15*(10**5)*(10**18)&&contribution>=1*10**18){return40;}elseif(currentsupply>15*(10**5)*(10**18)&&currentsupply<30*(10**5)*(10**18)&&contribution>=5*10**17){return30;}else{return0;}}elseif(keccak256("bitcoin")==keccak256(types)){if(currentsupply>=0&&currentsupply<=15*(10**5)*(10**18)&&contribution>=45*10**5){return40;}elseif(currentsupply>15*(10**5)*(10**18)&&currentsupply<30*(10**5)*(10**18)&&contribution>=225*10**4){return30;}else{return0;}}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 710
column: 1
content: functionvolumeDiscounts(uint256contribution,stringtypes)returns(uint256){if(contribution==0)throw;if(keccak256("ethereum")==keccak256(types)){if(contribution>=3*10**18&&contribution<10*10**18){return0;}elseif(contribution>=10*10**18&&contribution<20*10**18){return5;}elseif(contribution>=20*10**18){return10;}else{return0;}}elseif(keccak256("bitcoin")==keccak256(types)){if(contribution>=3*45*10**5&&contribution<10*45*10**5){return0;}elseif(contribution>=10*45*10**5&&contribution<20*45*10**5){return5;}elseif(contribution>=20*45*10**5){return10;}else{return0;}}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 744
column: 1
content: functiontotalDiscount(uint256currentsupply,uint256contribution,stringtypes)returns(uint256){uint256basediscount=baseDiscounts(currentsupply,contribution,types);uint256volumediscount=volumeDiscounts(contribution,types);uint256totaldiscount=basediscount+volumediscount;returntotaldiscount;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 792
column: 3
content: functionPreICO(addresstokenAddress){token=SMTToken(tokenAddress);tokensPerEther=token.tokensPerEther();tokensPerBTC=token.tokensPerBTC();valueToBeSent=token.valueToBeSent();SMTfund=token.SMTfund();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 802
column: 4
content: functionsendFunds()onlyOwner{token.addToBalances(addressPeople,totalsend);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 808
column: 1
content: functioncalNewTokens(uint256contribution,stringtypes)returns(uint256){uint256disc=totalDiscount(currentSupply,contribution,types);uint256CreatedTokens;if(keccak256(types)==keccak256("ethereum"))CreatedTokens=SafeMath.mul(contribution,tokensPerEther);elseif(keccak256(types)==keccak256("bitcoin"))CreatedTokens=SafeMath.mul(contribution,tokensPerBTC);uint256tokens=SafeMath.add(CreatedTokens,SafeMath.div(SafeMath.mul(CreatedTokens,disc),100));returntokens;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 922
column: 1
content: functionprocessTransaction(bytestxn,uint256txHash,addressaddr,bytes20btcaddr)onlyOwnerreturns(uint){boolvalueSent;boolisValid=token.isValid();if(!isValid)throw;if(!transactionsClaimed[txHash]){var(a,b)=BTC.checkValueSent(txn,btcaddr,valueToBeSent);if(a){valueSent=true;transactionsClaimed[txHash]=true;uint256newCreatedTokens;if(token.getState()==ICOSaleState.PrivateSale||token.getState()==ICOSaleState.PreSale){if(b<45*10**5)throw;newCreatedTokens=calNewTokens(b,"bitcoin");uint256temp=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);if(temp>tokenCreationMaxPrivateSale){uint256consumed=SafeMath.sub(tokenCreationMaxPrivateSale,initialSupplyPrivateSale);initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,consumed);currentSupply=SafeMath.add(currentSupply,consumed);uint256nonConsumed=SafeMath.sub(newCreatedTokens,consumed);uint256finalTokens=SafeMath.sub(nonConsumed,SafeMath.div(nonConsumed,10));switchState();initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,finalTokens);currentSupply=SafeMath.add(currentSupply,finalTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,SafeMath.add(finalTokens,consumed));token.increaseBTCRaised(b);}else{initialSupplyPrivateSale=SafeMath.add(initialSupplyPrivateSale,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPrivateSale>tokenCreationMaxPrivateSale)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseBTCRaised(b);}}elseif(token.getState()==ICOSaleState.PreICO){if(msg.value<225*10**4)throw;newCreatedTokens=calNewTokens(b,"bitcoin");initialSupplyPublicPreICO=SafeMath.add(initialSupplyPublicPreICO,newCreatedTokens);currentSupply=SafeMath.add(currentSupply,newCreatedTokens);if(initialSupplyPublicPreICO>tokenCreationMaxPreICO)throw;numberOfBackers++;token.addToBalances(addr,newCreatedTokens);token.increaseBTCRaised(b);}return1;}}else{throw;}}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 106
column: 4
content: addresspersonMakingTx;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 114
column: 4
content: boolisTesting;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 116
column: 4
content: bytes32testname;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 117
column: 4
content: addressfinalOwner;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 133
column: 4
content: mapping(address=>bool)ownership;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 136
column: 4
content: mapping(address=>uint256)balances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 137
column: 4
content: mapping(address=>mapping(address=>uint256))allowed;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 756
column: 1
content: SMTTokentoken;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 779
column: 1
content: uint256totalsend=team+reserve+bounty+mentors;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 788
column: 1
content: mapping(uint256=>bool)transactionsClaimed;

SOLIDITY_VISIBILITY :49
SOLIDITY_MSGVALUE_EQUALS_ZERO :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :47
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_REVERT_REQUIRE :42
SOLIDITY_LOCKED_MONEY :2
SOLIDITY_VAR :2
SOLIDITY_EXTRA_GAS_IN_LOOPS :1
SOLIDITY_ADDRESS_HARDCODED :14
SOLIDITY_GAS_LIMIT_IN_LOOPS :1
SOLIDITY_REDUNDANT_FALLBACK_REJECT :1
SOLIDITY_ERC20_APPROVE :1