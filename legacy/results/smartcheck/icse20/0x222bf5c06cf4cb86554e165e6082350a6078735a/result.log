/unique_chucks/29/0x222bf5c06cf4cb86554e165e6082350a6078735a.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 42
column: 27
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 43
column: 51
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 68
column: 27
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 76
column: 27
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 87
column: 32
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 101
column: 36
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 149
column: 32
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 162
column: 20
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 163
column: 13
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 176
column: 26
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 208
column: 26
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 277
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 291
column: 13
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 303
column: 23
content: throw

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 48
column: 2
content: for(vari=0;i<listeners.length;i++){balanceOf[listeners[i]]=last_reading;Transfer(msg.sender,listeners[i],last_reading-oldreading);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 62
column: 2
content: for(vari=0;i<listeners.length;i++){if(listeners[i]==a)listeners[i]=0;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 194
column: 3
content: for(vari=0;i<peers.length;i++){if(molist[peers[i]]==j){GridMemberpeer=GridMember(peers[i]);allowance[peer]=getActual();peer.doBalance(this);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 288
column: 2
content: for(vari=0;i<members.length;i++){if(members[i]==a)found=true;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 304
column: 2
content: for(vari=0;i<members.length;i++){doBalanceFor(members[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 48
column: 2
content: for(vari=0;i<listeners.length;i++){balanceOf[listeners[i]]=last_reading;Transfer(msg.sender,listeners[i],last_reading-oldreading);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 62
column: 2
content: for(vari=0;i<listeners.length;i++){if(listeners[i]==a)listeners[i]=0;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 194
column: 3
content: for(vari=0;i<peers.length;i++){if(molist[peers[i]]==j){GridMemberpeer=GridMember(peers[i]);allowance[peer]=getActual();peer.doBalance(this);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 288
column: 2
content: for(vari=0;i<members.length;i++){if(members[i]==a)found=true;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 304
column: 2
content: for(vari=0;i<members.length;i++){doBalanceFor(members[i]);}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 42
column: 2
content: if(msg.sender!=operator)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 43
column: 2
content: if((timeofreading<time)||(reading>last_reading))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 68
column: 2
content: if(msg.sender!=operator)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 76
column: 2
content: if(msg.sender!=operator)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 87
column: 2
content: if(msg.sender!=mp.operator())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 101
column: 8
content: if(msg.sender!=operator)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 149
column: 2
content: if(msg.sender!=mp.operator())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 162
column: 2
content: if(merritorder>9)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 163
column: 2
content: if(feedin)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 176
column: 2
content: if(reading<lastreading)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 208
column: 2
content: if(tx.origin!=operator)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 277
column: 2
content: if(msg.sender!=owner)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 291
column: 2
content: if(!found)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 303
column: 2
content: if(now<next_balance)throw;

ruleId: SOLIDITY_TX_ORIGIN
patternId: 12e802
severity: 2
line: 208
column: 5
content: tx.origin

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 298
column: 4
content: sendToAggregation(g.actual_feedin()+g.actual_feedout())

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 48
column: 6
content: vari=0

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 62
column: 6
content: vari=0

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 193
column: 6
content: varj=0

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 194
column: 7
content: vari=0

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 288
column: 6
content: vari=0

ruleId: SOLIDITY_VAR
patternId: d28aa7
severity: 2
line: 304
column: 6
content: vari=0

ruleId: SOLIDITY_VAR
patternId: f77619
severity: 1
line: 44
column: 2
content: varoldreading=last_reading

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 36
column: 1
content: functionMPO(){operator=msg.sender;shift=0;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 41
column: 1
content: functionupdateReading(uint256last_reading,uint256timeofreading){if(msg.sender!=operator)throw;if((timeofreading<time)||(reading>last_reading))throw;varoldreading=last_reading;reading=last_reading-shift;time=timeofreading;balanceOf[this]=last_reading;for(vari=0;i<listeners.length;i++){balanceOf[listeners[i]]=last_reading;Transfer(msg.sender,listeners[i],last_reading-oldreading);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 54
column: 1
content: functionregisterListening(addressa){listeners.push(a);balanceOf[a]=reading;Transfer(msg.sender,a,reading);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 60
column: 1
content: functionunregisterListening(addressa){for(vari=0;i<listeners.length;i++){if(listeners[i]==a)listeners[i]=0;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 67
column: 1
content: functiontransferOwnership(addressto){if(msg.sender!=operator)throw;operator=to;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 71
column: 1
content: functiontransfer(address_to,uint256_value){Transfer(msg.sender,_to,_value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 75
column: 1
content: functionassetMoveInformation(addressnewmpo,addressgridMemberToInform){if(msg.sender!=operator)throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 86
column: 1
content: functionswitchMPO(addressfrom,addressto){if(msg.sender!=mp.operator())throw;if(mp==from){mp=MPO(to);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 96
column: 4
content: functionoperated(){operator=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 105
column: 4
content: functiontransferOperator(addressnewOperator)onlyOperator{operator=newOperator;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 132
column: 1
content: functionGridMember(stringmembername,uint256managablebalance,booldirectionFeedin,addressmpo,addressaggregation){name=membername;managedbalance=managablebalance;balanceOf[this]=managablebalance;Transfer(msg.sender,this,managablebalance);feedin=directionFeedin;if(feedin)total_feedin=lastreading;elsetotal_feedout=lastreading;autobalancepeers=false;mp=MPO(mpo);updateReading(mp.reading());actual_feedin=0;actual_feedout=0;listening=false;aggregate=aggregation;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 148
column: 1
content: functionswitchMPO(addressfrom,addressto){if(msg.sender!=mp.operator())throw;updateWithMPO();lastreading=0;super.switchMPO(from,to);updateWithMPO();listening=false;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 156
column: 1
content: functionregisterListening()onlyOperator{mp.registerListening(this);listening=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 161
column: 1
content: functionaddPowerSource(addresspeer,uint256manageallowed,uintmerritorder)onlyOperator{if(merritorder>9)throw;if(feedin)throw;allowance[peer]=manageallowed;peers.push(peer);molist[peer]=merritorder;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 170
column: 1
content: functionupdateWithMPO(){updateReading(mp.balanceOf(mp));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 184
column: 1
content: functionrequestPeerBalance()onlyOperator{updateWithMPO();runPeerBalance();Aggregationa=Aggregation(aggregate);a.doBalanceFor(this);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 203
column: 1
content: functiongetActual()returns(uint256){if(feedin)returnactual_feedin;elsereturnactual_feedout;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 207
column: 1
content: functionreceiveTransfer(uint256amount){if(tx.origin!=operator)throw;if(feedin)actual_feedin-=amount;elseactual_feedout-=amount;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 211
column: 1
content: functionsendToAggregation(uint256amount){balanceOf[this]-=amount;balanceOf[aggregate]+=amount;if(feedin)actual_feedin-=amount;elseactual_feedout-=amount;Transfer(this,aggregate,amount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 217
column: 1
content: functiondoBalance(addressrequester){updateWithMPO();if(autobalancepeers){if((actual_feedin>0)||(actual_feedout>0)){}}GridMemberpeer=GridMember(requester);if(feedin==peer.feedin())return;uint256peer_allowance=peer.allowance(this);uint256balance_amount=0;if(feedin){balance_amount=actual_feedin;}else{balance_amount=actual_feedout;}if(peer_allowance<balance_amount){balance_amount=peer_allowance;}if(balanceOf[this]<balance_amount)balance_amount=balanceOf[this];if((peer.managedbalance()-peer.balanceOf(requester))+peer.getActual()<balance_amount)balance_amount=(peer.managedbalance()-peer.balanceOf(requester))+peer.getActual();if(balance_amount>0){balanceOf[this]-=balance_amount;balanceOf[requester]+=balance_amount;Transfer(this,requester,balance_amount);if(feedin){actual_feedin-=balance_amount;}else{actual_feedout-=balance_amount;}peer.receiveTransfer(balance_amount);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 248
column: 1
content: functiontransfer(address_to,uint256_value){Transfer(msg.sender,_to,_value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 271
column: 1
content: functionAggregation(){owner=msg.sender;next_balance=now+3600;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 276
column: 1
content: functionaddGridMember(addressgridmember){if(msg.sender!=owner)throw;members.push(gridmember);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 281
column: 1
content: functiontransfer(address_to,uint256_value){Transfer(msg.sender,_to,_value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 286
column: 1
content: functiondoBalanceFor(addressa){boolfound=false;for(vari=0;i<members.length;i++){if(members[i]==a)found=true;}if(!found)throw;GridMemberg=GridMember(a);actual_feedin+=g.actual_feedin();actual_feedout+=g.actual_feedout();g.sendToAggregation(g.actual_feedin()+g.actual_feedout());lastbalancing[a]=now;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 302
column: 1
content: functiondoBalance(){if(now<next_balance)throw;for(vari=0;i<members.length;i++){doBalanceFor(members[i]);}next_balance=now+3600;}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 29
column: 1
content: uint256shift;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 124
column: 1
content: boollistening;

SOLIDITY_VISIBILITY :28
SOLIDITY_DEPRECATED_CONSTRUCTIONS :14
SOLIDITY_REVERT_REQUIRE :14
SOLIDITY_VAR :7
SOLIDITY_EXTRA_GAS_IN_LOOPS :5
SOLIDITY_GAS_LIMIT_IN_LOOPS :5
SOLIDITY_UNCHECKED_CALL :1
SOLIDITY_TX_ORIGIN :1