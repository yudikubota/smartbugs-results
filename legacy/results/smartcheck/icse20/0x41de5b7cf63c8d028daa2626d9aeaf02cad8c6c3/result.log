/unique_contracts/0x41de5b7cf63c8d028daa2626d9aeaf02cad8c6c3.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 68
column: 8
content: q.data.length=600000

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 22
column: 4
content: functionadd(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x+y)>=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 26
column: 4
content: functionsub(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x-y)<=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 30
column: 4
content: functionmul(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x*y)>=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 34
column: 4
content: functiondiv(uint256x,uint256y)constantinternalreturns(uint256z){z=x/y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 38
column: 4
content: functionmin(uint256x,uint256y)constantinternalreturns(uint256z){returnx<=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 42
column: 4
content: functionmax(uint256x,uint256y)constantinternalreturns(uint256z){returnx>=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 63
column: 4
content: functionqueueSize()constantreturns(uintr){r=q.back-q.front;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 150
column: 4
content: functiontime()constantreturns(uint){if(cTime>0){returncTime;}returnblock.timestamp;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 159
column: 4
content: functiontoday()constantreturns(uint){returndayFor(time());}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 163
column: 4
content: functiondayFor(uinttimestamp)constantreturns(uint){returnsub(timestamp,startTime)/24hours;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 167
column: 4
content: functionlowerLimitForToday()constantreturns(uint){returntoday()*1ether;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 852kwn
severity: 1
line: 174
column: 53
content: years

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 261
column: 33
content: mul(div(msg.value,5),4)

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 285
column: 33
content: mul(div(msg.value,5),4)

ruleId: SOLIDITY_ERC20_APPROVE
patternId: af782c
severity: 2
line: 192
column: 4
content: functionapprove(address_spender,uint256_value)returns(boolsuccess){allowance[msg.sender][_spender]=_value;returntrue;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 303
column: 15
content: ptr<size

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 127
column: 4
content: functionsetCTime(uint_cTime)onlyOwner{cTime=_cTime;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 71
column: 23
content: BuyTicketticket

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 78
column: 43
content: BuyTicketr

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 6
column: 4
content: functionowned(){owner=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 15
column: 4
content: functiontransferOwnership(addressnewOwner)onlyOwner{owner=newOwner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 63
column: 4
content: functionqueueSize()constantreturns(uintr){r=q.back-q.front;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 67
column: 4
content: functionqueue(){q.data.length=600000;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 127
column: 4
content: functionsetCTime(uint_cTime)onlyOwner{cTime=_cTime;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 131
column: 4
content: functionDeCenterToken(address_beneficiary,address_expertsAccount,address_teamAccount,uint_startTime,uint_refundStartTime){beneficiary=_beneficiary;expertsAccount=_expertsAccount;teamAccount=_teamAccount;startTime=_startTime;refundStartTime=_refundStartTime;balanceOf[this]=totalSupply;scheduledTopUp();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 150
column: 4
content: functiontime()constantreturns(uint){if(cTime>0){returncTime;}returnblock.timestamp;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 159
column: 4
content: functiontoday()constantreturns(uint){returndayFor(time());}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 163
column: 4
content: functiondayFor(uinttimestamp)constantreturns(uint){returnsub(timestamp,startTime)/24hours;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 167
column: 4
content: functionlowerLimitForToday()constantreturns(uint){returntoday()*1ether;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 171
column: 4
content: functionscheduledTopUp()onlyOwner{uintpayment=400000000000000;require(sub(time(),lastScheduledTopUp)>=1years);require(teamAndExpertsTokens>=payment*2);lastScheduledTopUp=time();teamAndExpertsTokens-=payment;balanceOf[this]=sub(balanceOf[this],payment);balanceOf[expertsAccount]=add(balanceOf[expertsAccount],payment);teamAndExpertsTokens-=payment;balanceOf[this]=sub(balanceOf[this],payment);balanceOf[teamAccount]=add(balanceOf[teamAccount],payment);Transfer(this,expertsAccount,payment);Transfer(this,teamAccount,payment);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 192
column: 4
content: functionapprove(address_spender,uint256_value)returns(boolsuccess){allowance[msg.sender][_spender]=_value;returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 212
column: 4
content: functiontransfer(address_to,uint256_value){require(balanceOf[msg.sender]>=_value);if(_to==address(this)){refund(_value);return;}balanceOf[msg.sender]=sub(balanceOf[msg.sender],_value);balanceOf[_to]=add(balanceOf[_to],_value);Transfer(msg.sender,_to,_value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 227
column: 4
content: functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess){require(balanceOf[_from]>=_value);require(_value<=allowance[_from][msg.sender]);allowance[_from][msg.sender]=sub(allowance[_from][msg.sender],_value);balanceOf[_from]=sub(balanceOf[_from],_value);balanceOf[_to]=add(balanceOf[_to],_value);Transfer(_from,_to,_value);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 240
column: 4
content: functioncloseRefund()onlyOwner{require(time()-refundStartTime>refundDuration);beneficiary.transfer(this.balance);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 251
column: 4
content: functionbuy()payable{require(startTime<=time());uintamount=div(msg.value,price);if(time()-startTime>firstStageDuration){require(1ether<=msg.value);require(msg.value<=300ether);beneficiary.transfer(mul(div(msg.value,5),4));uintcurrentDay=lastProcessedDay+1;uintlimit=maxDailyCap-dailyTotals[currentDay];if(limit>=amount){availableTokens=sub(availableTokens,amount);balanceOf[this]=sub(balanceOf[this],amount);dailyTotals[currentDay]=add(dailyTotals[currentDay],amount);balanceOf[msg.sender]=add(balanceOf[msg.sender],amount);Transfer(this,msg.sender,amount);}else{queuedAmount=add(queuedAmount,amount);require(queuedAmount<=availableTokens);BuyTicketmemoryticket=BuyTicket({account:msg.sender,amount:amount,time:time()});pushQueue(ticket);}}else{require(lowerLimitForToday()<=msg.value);require(amount<=availableTokens);beneficiary.transfer(mul(div(msg.value,5),4));availableTokens=sub(availableTokens,amount);balanceOf[this]=sub(balanceOf[this],amount);balanceOf[msg.sender]=add(balanceOf[msg.sender],amount);Transfer(this,msg.sender,amount);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 295
column: 4
content: functionprocessPendingTickets()onlyOwner{uintsize=queueSize();uintptr=0;uintcurrentDay;uintlimit;BuyTicketmemoryticket;while(ptr<size){currentDay=lastProcessedDay+1;limit=maxDailyCap-dailyTotals[currentDay];if(startTime+(currentDay-1)*1days>time()){return;}if(ptr>50){return;}ticket=peekQueue();if(limit<ticket.amount||ticket.time-1000seconds>startTime+(currentDay-1)*1days){lastProcessedDay+=1;continue;}popQueue();ptr+=1;availableTokens=sub(availableTokens,ticket.amount);queuedAmount=sub(queuedAmount,ticket.amount);dailyTotals[currentDay]=add(dailyTotals[currentDay],ticket.amount);balanceOf[this]=sub(balanceOf[this],ticket.amount);balanceOf[ticket.account]=add(balanceOf[ticket.account],ticket.amount);Transfer(this,ticket.account,ticket.amount);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 337
column: 4
content: function()payable{buy();}

SOLIDITY_VISIBILITY :18
SOLIDITY_OVERPOWERED_ROLE :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :12
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :1
SOLIDITY_UPGRADE_TO_050 :2
SOLIDITY_GAS_LIMIT_IN_LOOPS :1
SOLIDITY_DIV_MUL :2
SOLIDITY_ERC20_APPROVE :1