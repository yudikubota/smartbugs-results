{
  "contract": "0xaaf401585b72c678afc09036510d3ef759bdaf7e",
  "tool": "smartcheck",
  "start": 1563534656.1097906,
  "end": 1563534667.8843598,
  "duration": 11.774569272994995,
  "analysis": [
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 93,
      "column": 42,
      "content": "0x150b7a02"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 94,
      "column": 42,
      "content": "0xf0b9e5ba"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 95,
      "column": 42,
      "content": "0xcd740db5"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 229,
      "column": 46,
      "content": "0xed81cdda"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 250,
      "column": 46,
      "content": "0x43a61a8e"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 267,
      "column": 50,
      "content": "0x6352211e"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 277,
      "column": 50,
      "content": "0xed81cdda"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 319,
      "column": 59,
      "content": "0xed81cdda"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 383,
      "column": 28,
      "content": "0x01ffc9a7"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 385,
      "column": 28,
      "content": "0x80ac58cd"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 387,
      "column": 28,
      "content": "0x5b5e139f"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 389,
      "column": 28,
      "content": "0x780e9d63"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 391,
      "column": 28,
      "content": "0x150b7a02"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 393,
      "column": 28,
      "content": "0xf0b9e5ba"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 395,
      "column": 28,
      "content": "0x1efdf36a"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 397,
      "column": 28,
      "content": "0xa344afe4"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 399,
      "column": 28,
      "content": "0x7294ffed"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 401,
      "column": 28,
      "content": "0xc5fd96cd"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 403,
      "column": 28,
      "content": "0xa1b23002"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "b140cd",
      "severity": 1,
      "line": 405,
      "column": 28,
      "content": "0x8318b539"
    },
    {
      "name": "SOLIDITY_ARRAY_LENGTH_MANIPULATION",
      "patternId": "872bdd",
      "severity": 1,
      "line": 351,
      "column": 8,
      "content": "ownedTokens[_from].length--"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 202,
      "column": 15,
      "content": "rootOwnerAddress==address(this)"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_PURE",
      "patternId": "11314f",
      "severity": 1,
      "line": 715,
      "column": 4,
      "content": "functionvalidateAndLower(string_s)privatepurereturns(stringmokenName){assembly{letlen:=mload(_s)letp:=add(_s,0x20)ifeq(len,0){revert(0,0)}ifgt(len,100){revert(0,0)}letb:=byte(0,mload(add(_s,0x20)))iflt(b,0x21){revert(0,0)}b:=byte(0,mload(add(p,sub(len,1))))iflt(b,0x21){revert(0,0)}for{letend:=add(p,len)}lt(p,end){p:=add(p,1)}{b:=byte(0,mload(p))iflt(b,0x5b){ifgt(b,0x40){mstore8(p,add(b,32))}}}}return_s;}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 166,
      "column": 4,
      "content": "functionisContract(addressaddr)internalviewreturns(bool){uint256size;assembly{size:=extcodesize(addr)}returnsize>0;}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 196,
      "column": 4,
      "content": "functionrootOwnerOf(uint256_tokenId)publicviewreturns(bytes32rootOwner){addressrootOwnerAddress=address(mokens[_tokenId].data);require(rootOwnerAddress!=address(0),\"tokenId not found.\");uint256parentTokenId;boolisParent;while(rootOwnerAddress==address(this)){parentTokenId=mokens[_tokenId].parentTokenId;isParent=parentTokenId>0;if(isParent){_tokenId=parentTokenId-1;}else{_tokenId=childTokenOwner[rootOwnerAddress][_tokenId]-1;}rootOwnerAddress=address(mokens[_tokenId].data);}parentTokenId=mokens[_tokenId].parentTokenId;isParent=parentTokenId>0;if(isParent){parentTokenId--;}bytesmemorycalldata;boolcallSuccess;if(isParent==false){calldata=abi.encodeWithSelector(0xed81cdda,address(this),_tokenId);assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}if(callSuccess==true&&rootOwner>>224==ERC998_MAGIC_VALUE){returnrootOwner;}else{returnERC998_MAGIC_VALUE<<224|bytes32(rootOwnerAddress);}}else{calldata=abi.encodeWithSelector(0x43a61a8e,parentTokenId);assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}if(callSuccess==true&&rootOwner>>224==ERC998_MAGIC_VALUE){returnrootOwner;}else{addresschildContract=rootOwnerAddress;calldata=abi.encodeWithSelector(0x6352211e,parentTokenId);assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwnerAddress:=mload(calldata)}}require(callSuccess,\"Call to ownerOf failed\");calldata=abi.encodeWithSelector(0xed81cdda,childContract,parentTokenId);assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}if(callSuccess==true&&rootOwner>>224==ERC998_MAGIC_VALUE){returnrootOwner;}else{returnERC998_MAGIC_VALUE<<224|bytes32(rootOwnerAddress);}}}}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 804,
      "column": 4,
      "content": "functionmokenBytes32(uint256_tokenId)externalviewreturns(bytes32mokenNameBytes32,bytes32era,bytes32data,addresstokenOwner){data=bytes32(mokens[_tokenId].data);require(data!=0,\"The tokenId does not exist.\");bytesmemorymokenNameBytes=bytes(mokens[_tokenId].name);require(mokenNameBytes.length!=0,\"The tokenId does not exist.\");assembly{mokenNameBytes32:=mload(add(mokenNameBytes,32))}return(mokenNameBytes32,eraFromMokenData(data),data,address(data));}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 839,
      "column": 4,
      "content": "functionmokenNameBytes32(uint256_tokenId)externalviewreturns(bytes32mokenNameBytes32_){bytesmemorymokenNameBytes=bytes(mokens[_tokenId].name);require(mokenNameBytes.length!=0,\"The tokenId does not exist.\");assembly{mokenNameBytes32_:=mload(add(mokenNameBytes,32))}returnmokenNameBytes32_;}"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 715,
      "column": 30,
      "content": "string_s"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 715,
      "column": 63,
      "content": "stringmokenName"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 230,
      "column": 12,
      "content": "assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 251,
      "column": 12,
      "content": "assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 268,
      "column": 16,
      "content": "assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwnerAddress:=mload(calldata)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 278,
      "column": 16,
      "content": "assembly{callSuccess:=staticcall(gas,rootOwnerAddress,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{rootOwner:=mload(calldata)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 320,
      "column": 12,
      "content": "assembly{callSuccess:=staticcall(gas,_from,add(calldata,0x20),mload(calldata),calldata,0x20)ifcallSuccess{tokenOwner:=mload(calldata)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 377,
      "column": 8,
      "content": "assembly{callSuccess:=delegatecall(gas,_delegate,add(calldata,0x20),mload(calldata),0,0)}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 495,
      "column": 12,
      "content": "assembly{toTokenId:=calldataload(164)}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 716,
      "column": 8,
      "content": "assembly{letlen:=mload(_s)letp:=add(_s,0x20)ifeq(len,0){revert(0,0)}ifgt(len,100){revert(0,0)}letb:=byte(0,mload(add(_s,0x20)))iflt(b,0x21){revert(0,0)}b:=byte(0,mload(add(p,sub(len,1))))iflt(b,0x21){revert(0,0)}for{letend:=add(p,len)}lt(p,end){p:=add(p,1)}{b:=byte(0,mload(p))iflt(b,0x5b){ifgt(b,0x40){mstore8(p,add(b,32))}}}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 810,
      "column": 8,
      "content": "assembly{mokenNameBytes32:=mload(add(mokenNameBytes,32))}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 842,
      "column": 8,
      "content": "assembly{mokenNameBytes32_:=mload(add(mokenNameBytes,32))}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 851,
      "column": 8,
      "content": "assembly{letresult:=delegatecall(gas,sload(delegate_slot),add(data,0x20),mload(data),0,0)letsize:=returndatasizeletptr:=mload(0x40)returndatacopy(ptr,0,size)switchresultcase0{revert(ptr,size)}default{return(ptr,size)}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 894,
      "column": 8,
      "content": "assembly{toTokenId:=calldataload(132)}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 908,
      "column": 8,
      "content": "assembly{toTokenId:=calldataload(164)}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 93,
      "column": 4,
      "content": "bytes4constantERC721_RECEIVED_NEW=0x150b7a02;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 94,
      "column": 4,
      "content": "bytes4constantERC721_RECEIVED_OLD=0xf0b9e5ba;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 95,
      "column": 4,
      "content": "bytes32constantERC998_MAGIC_VALUE=0xcd740db5;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 97,
      "column": 4,
      "content": "uint256constantUINT16_MASK=0x000000000000000000000000000000000000000000000000000000000000ffff;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 98,
      "column": 4,
      "content": "uint256constantMOKEN_LINK_HASH_MASK=0xffffffffffffffff000000000000000000000000000000000000000000000000;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 99,
      "column": 4,
      "content": "uint256constantMOKEN_DATA_MASK=0x0000000000000000ffffffffffffffffffffffffffffffffffffffffffffffff;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 100,
      "column": 4,
      "content": "uint256constantMAX_MOKENS=4294967296;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 101,
      "column": 4,
      "content": "uint256constantMAX_OWNER_MOKENS=65536;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 146,
      "column": 4,
      "content": "mapping(uint256=>mapping(address=>uint256))erc20ContractIndex;"
    }
  ]
}