/unique_chucks/27/0x0710714a1e30c70aea2dc1254e24292bea7943f4.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 109
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 113
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 124
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 334
column: 16
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 345
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 349
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 364
column: 16
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 378
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 388
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 396
column: 16
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 401
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 6
column: 2
content: functionmul(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a*b;assert(a==0||c/a==b);returnc;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 12
column: 2
content: functiondiv(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a/b;returnc;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 19
column: 2
content: functionsub(uint256a,uint256b)internalconstantreturns(uint256){assert(b<=a);returna-b;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 24
column: 2
content: functionadd(uint256a,uint256b)internalconstantreturns(uint256){uint256c=a+b;assert(c>=a);returnc;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 34
column: 4
content: functiontotalSupply()constantreturns(uint256supply){}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 159
column: 4
content: functionbalanceOf(address_investor)constantreturns(uint256balance){returnbalances[_investor];}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 183
column: 4
content: functionsetCurrentMarketRate(uint256_currentMarketRate)onlyCreatorreturns(uint256){currentMarketRate=_currentMarketRate;}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 193
column: 4
content: functionsetMinimumIcoRate(uint256_minimumIcoRate)onlyCreatorreturns(uint256){minimumIcoRate=_minimumIcoRate;}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 32
column: 4
content: functionissue(address_recipient,uint256_value)returns(boolsuccess){}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 33
column: 4
content: functionissueAtIco(address_recipient,uint256_value,uint256_icoNumber)returns(boolsuccess){}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 34
column: 4
content: functiontotalSupply()constantreturns(uint256supply){}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 35
column: 4
content: functionunlock()returns(boolsuccess){}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 108
column: 8
content: if(stage!=_stage&&_stage!=Stages.Ico){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 112
column: 8
content: if(stage!=Stages.PriorityIco&&stage!=Stages.OpenIco&&stage!=Stages.PreIco){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 123
column: 8
content: if(creator!=msg.sender){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 333
column: 12
content: if(!creator.send(amountToSend)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 344
column: 8
content: if(!humanityFund.send(ethForHumanityFund)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 348
column: 8
content: if(!buyBackFund.send(ethForBuyBackFund)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 363
column: 12
content: if(!richToken.issue(investorAddress,toBeIssued)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 377
column: 8
content: if(receivedEth<minAcceptedEthAmount){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 387
column: 8
content: if(tokensToBeIssued==0||icoTokenIssued[currentIco]+tokensToBeIssued>maxIssuedTokensPerIco){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 395
column: 12
content: if(tokensToBeIssued>canBuyTokensInThisIco-alreadyBoughtInIco){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 400
column: 8
content: if(!richToken.issue(msg.sender,tokensToBeIssued)){throw;}

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 40
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 333
column: 25
content: send(amountToSend)

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 344
column: 26
content: send(ethForHumanityFund)

ruleId: SOLIDITY_SEND
patternId: 430636
severity: 1
line: 348
column: 25
content: send(ethForBuyBackFund)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 32
column: 4
content: functionissue(address_recipient,uint256_value)returns(boolsuccess){}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 33
column: 4
content: functionissueAtIco(address_recipient,uint256_value,uint256_icoNumber)returns(boolsuccess){}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 34
column: 4
content: functiontotalSupply()constantreturns(uint256supply){}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 35
column: 4
content: functionunlock()returns(boolsuccess){}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 135
column: 4
content: functiongetPercentageBonusForIco(uint256_currentIco)returns(uint256percentage){updateState();if(stage==Stages.PreIco){returnbonusPreIco;}if(_currentIco==1){returnbonusFirstIco;}if(_currentIco==2){returnbonusSecondIco;}return0;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 159
column: 4
content: functionbalanceOf(address_investor)constantreturns(uint256balance){returnbalances[_investor];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 171
column: 4
content: functionRICHCrowdsale(address_tokenAddress,address_creator,uint256_start,uint256_preIcoStart){richToken=Token(_tokenAddress);creator=_creator;start=_start;preIcoStart=_preIcoStart;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 183
column: 4
content: functionsetCurrentMarketRate(uint256_currentMarketRate)onlyCreatorreturns(uint256){currentMarketRate=_currentMarketRate;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 193
column: 4
content: functionsetMinimumIcoRate(uint256_minimumIcoRate)onlyCreatorreturns(uint256){minimumIcoRate=_minimumIcoRate;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 202
column: 4
content: functionsetHumanityFund(address_humanityFund)onlyCreator{humanityFund=_humanityFund;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 211
column: 4
content: functionsetBuyBackFund(address_buyBackFund)onlyCreator{buyBackFund=_buyBackFund;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 220
column: 4
content: functiongetRate()returns(uint256rate){if(currentMarketRate*12/10<minimumIcoRate){returnminimumIcoRate;}returncurrentMarketRate*12/10;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 235
column: 4
content: functiongetInvestorTokenPercentage(address_investor,uint256exeptInIco)returns(uint256percentage){uint256deductionInvestor=0;uint256deductionIco=0;if(exeptInIco>=0){deductionInvestor=tokenBalancesPerIco[_investor][exeptInIco];deductionIco=icoTokenIssued[exeptInIco];}if(totalTokenIssued-deductionIco==0){return0;}return1000000*(tokenBalances[_investor]-deductionInvestor)/(totalTokenIssued-deductionIco);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 258
column: 4
content: functiontoRICH(uint256_wei)returns(uint256amount){uint256rate=getRate();return_wei*rate*10**8/1ether;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 269
column: 4
content: functiongetCurrentIcoNumber()returns(uint256amount){uint256timeBehind=now-start;if(now<start){return0;}return1+((timeBehind-(timeBehind%(icoPeriod+noIcoPeriod)))/(icoPeriod+noIcoPeriod));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 281
column: 4
content: functionupdateState(){uint256timeBehind=now-start;uint256currentIcoNumber=getCurrentIcoNumber();if(icoTokenIssued[currentIcoNumber]>=maxIssuedTokensPerIco){stage=Stages.NoIco;return;}if(totalTokenIssued>=maxTotalSupply){stage=Stages.Ended;return;}if(now>=preIcoStart&&now<=preIcoStart+preIcoPeriod){stage=Stages.PreIco;return;}if(now<start){stage=Stages.Countdown;return;}uint256timeFromIcoStart=timeBehind-(currentIcoNumber-1)*(icoPeriod+noIcoPeriod);if(timeFromIcoStart>icoPeriod){stage=Stages.NoIco;return;}if(timeFromIcoStart>icoPeriod/2){stage=Stages.OpenIco;return;}stage=Stages.PriorityIco;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 324
column: 4
content: functionwithdraw()onlyCreator{uint256ethBalance=this.balance;uint256amountToSend=ethBalance-100000000;if(creatorWithdraw<maxCreatorWithdraw){if(amountToSend>maxCreatorWithdraw-creatorWithdraw){amountToSend=maxCreatorWithdraw-creatorWithdraw;}if(!creator.send(amountToSend)){throw;}creatorWithdraw+=amountToSend;return;}uint256ethForHumanityFund=amountToSend*percentageHumanityFund/100;uint256ethForBuyBackFund=amountToSend*percentageBuyBackFund/100;if(!humanityFund.send(ethForHumanityFund)){throw;}if(!buyBackFund.send(ethForBuyBackFund)){throw;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 358
column: 4
content: functionsendSubscriptionBonus(addressinvestorAddress)onlyCreator{uint256subscriptionBonus=tokenBalances[investorAddress]*bonusSubscription/100;if(subsriptionBonusTokensIssued[investorAddress]<subscriptionBonus){uint256toBeIssued=subscriptionBonus-subsriptionBonusTokensIssued[investorAddress];if(!richToken.issue(investorAddress,toBeIssued)){throw;}subsriptionBonusTokensIssued[investorAddress]+=toBeIssued;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 374
column: 4
content: function()payableatStage(Stages.Ico){uint256receivedEth=msg.value;if(receivedEth<minAcceptedEthAmount){throw;}uint256tokensToBeIssued=toRICH(receivedEth);uint256currentIco=getCurrentIcoNumber();tokensToBeIssued=tokensToBeIssued+(tokensToBeIssued*getPercentageBonusForIco(currentIco)/100);if(tokensToBeIssued==0||icoTokenIssued[currentIco]+tokensToBeIssued>maxIssuedTokensPerIco){throw;}if(stage==Stages.PriorityIco){uint256alreadyBoughtInIco=tokenBalancesPerIco[msg.sender][currentIco];uint256canBuyTokensInThisIco=maxIssuedTokensPerIco*getInvestorTokenPercentage(msg.sender,currentIco)/1000000;if(tokensToBeIssued>canBuyTokensInThisIco-alreadyBoughtInIco){throw;}}if(!richToken.issue(msg.sender,tokensToBeIssued)){throw;}icoTokenIssued[currentIco]+=tokensToBeIssued;totalTokenIssued+=tokensToBeIssued;balances[msg.sender]+=receivedEth;tokenBalances[msg.sender]+=tokensToBeIssued;tokenBalancesPerIco[msg.sender][currentIco]+=tokensToBeIssued;}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 61
column: 4
content: mapping(uint256=>uint256)icoTokenIssued;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 74
column: 4
content: mapping(address=>uint256)subsriptionBonusTokensIssued;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 77
column: 4
content: mapping(address=>uint256)balances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 78
column: 4
content: mapping(address=>uint256)tokenBalances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 79
column: 4
content: mapping(address=>mapping(uint256=>uint256))tokenBalancesPerIco;

SOLIDITY_VISIBILITY :24
SOLIDITY_SAFEMATH :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :17
SOLIDITY_REVERT_REQUIRE :11
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :6
SOLIDITY_SEND :3