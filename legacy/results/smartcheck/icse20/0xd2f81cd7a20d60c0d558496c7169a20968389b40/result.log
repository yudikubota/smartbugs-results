/unique_chucks/1/0xd2f81cd7a20d60c0d558496c7169a20968389b40.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 1644
column: 8
content: 0x700FeBD9360ac0A0a72F371615427Bec4E4454E5

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 1645
column: 8
content: 0x72Cc898de0A4EAC49c46ccb990379099461342f6

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 1646
column: 8
content: 0xc3cC48da3B8168154e0f14Bf0446C7a93613F0A7

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 1647
column: 8
content: 0x4cC96f2Ddf6844323ae0d8461d418a4D473b9AC3

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 1648
column: 8
content: 0xa52bFcb5FF599e29EE2B9130F1575BaBaa27de0A

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 1649
column: 8
content: 0xe503b42AabdA22974e2A8B75Fa87E010e1B13584

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 1877
column: 22
content: 0xc23F76aEa00B775AADC8504CcB22468F4fD2261A

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 1105
column: 55
content: 0xda671b9b

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 1583
column: 21
content: (msg.sender,address(0),partId)

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 385
column: 8
content: for(uinti=0;i<b.length;i++){if(b[i]>=48&&b[i]<=57){result=result*10+(uint(b[i])-48);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 455
column: 8
content: for(uinti=0;i<_tokenIds.length;i++){if(partIndexToOwner[_tokenIds[i]]!=_owner){returnfalse;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 495
column: 8
content: for(uintj=0;j<approvedBattles.length;j++){require(_to!=approvedBattles[j]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 516
column: 8
content: for(uintj=0;j<approvedBattles.length;j++){require(_to!=approvedBattles[j]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 523
column: 8
content: for(uintk=0;k<_tokenIds.length;k++){_transfer(msg.sender,_to,_tokenIds[k]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 550
column: 8
content: for(uinti=0;i<_tokenIds.length;i++){uint_tokenId=_tokenIds[i];require(owns(msg.sender,_tokenId));partIndexToApproved[_tokenId]=_to;Approval(msg.sender,_to,_tokenId);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 687
column: 8
content: for(uint32i=FIRST_LEVEL;i<=FIRST_LEVEL+_exp;i+=c*INCREMENT){c++;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 722
column: 8
content: for(uinti=0;i<_ba.length;i++)babcde[k++]=_ba[i];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 723
column: 8
content: for(i=0;i<_bb.length;i++)babcde[k++]=_bb[i];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 724
column: 8
content: for(i=0;i<_bc.length;i++)babcde[k++]=_bc[i];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 725
column: 8
content: for(i=0;i<_bd.length;i++)babcde[k++]=_bd[i];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 726
column: 8
content: for(i=0;i<_be.length;i++)babcde[k++]=_be[i];

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 846
column: 8
content: for(uint8i=_parent(_index);i>PRESTIGE_INDEX;i=_parent(i)){if(_perks[i]==0){returnfalse;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 858
column: 8
content: for(uint8i=PRESTIGE_INDEX+1;i<PERK_COUNT+1;i++){sum+=_perks[i];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 891
column: 8
content: for(uint8i=1;i<currentUser.perks.length;i++){currentUser.perks[i]=0;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1183
column: 8
content: for(uint8i=0;i<LAST_CONSIDERED;i++){sum+=lastScrapPrices[i];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1371
column: 8
content: for(uint8i=0;i<_newElement.length;i++){defenceElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1377
column: 8
content: for(uint8i=0;i<_newElement.length;i++){meleeElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1383
column: 8
content: for(uint8i=0;i<_newElement.length;i++){bodyElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1389
column: 8
content: for(uint8i=0;i<_newElement.length;i++){turretElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1516
column: 8
content: for(uinti=0;i<crates.length;i++){uintpendingBlockNumber=crates[i];require(block.number>pendingBlockNumber);varhash=block.blockhash(pendingBlockNumber);if(uint(hash)!=0){uintrand=uint(keccak256(hash,msg.sender,i));_generateRandomPart(rand,msg.sender);}else{}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 1936
column: 8
content: for(uinti=cratesMigrated[msg.sender];i<cratesMigrated[msg.sender]+max;i++){varrobot=NewCratePreSale(presale).getRobotForUserByIndex(msg.sender,i);varrobotString=uintToString(robot);_migrateRobot(robotString);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 2033
column: 8
content: for(uinti=0;i<pc.length;i++){uintcrateBlock=pc[i];require(block.number>crateBlock);varhash=block.blockhash(crateBlock);if(uint(hash)!=0){uintrand=uint(keccak256(hash,msg.sender,i))%(10**20);_migrateRobot(uintToString(rand));count++;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 2087
column: 8
content: for(uint8i=0;i<approvedBattles.length;i++){if(msg.sender==address(approvedBattles[i])){returntrue;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 2112
column: 8
content: for(uinti=0;i<partIds.length;i++){_approve(partIds[i],address(battle));}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 2139
column: 8
content: for(uinti=0;i<_exps.length;i++){sum+=_addPartExperience(_partIds[i],_exps[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 2220
column: 8
content: for(uinti=0;i<rewards.length;i++){if(rewards[i].blocknumber==0){rewards[i].blocknumber=block.number;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 2326
column: 8
content: for(uinti=0;i<partIds.length;i++){total+=getLevel(parts[partIds[i]].experience);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: k4o1l4
severity: 1
line: 1507
column: 9
content: while(user.numShards>=SHARDS_TO_PART){user.numShards-=SHARDS_TO_PART;pendingPartCrates[msg.sender].push(block.number);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 385
column: 8
content: for(uinti=0;i<b.length;i++){if(b[i]>=48&&b[i]<=57){result=result*10+(uint(b[i])-48);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 455
column: 8
content: for(uinti=0;i<_tokenIds.length;i++){if(partIndexToOwner[_tokenIds[i]]!=_owner){returnfalse;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 495
column: 8
content: for(uintj=0;j<approvedBattles.length;j++){require(_to!=approvedBattles[j]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 516
column: 8
content: for(uintj=0;j<approvedBattles.length;j++){require(_to!=approvedBattles[j]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 523
column: 8
content: for(uintk=0;k<_tokenIds.length;k++){_transfer(msg.sender,_to,_tokenIds[k]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 550
column: 8
content: for(uinti=0;i<_tokenIds.length;i++){uint_tokenId=_tokenIds[i];require(owns(msg.sender,_tokenId));partIndexToApproved[_tokenId]=_to;Approval(msg.sender,_to,_tokenId);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 722
column: 8
content: for(uinti=0;i<_ba.length;i++)babcde[k++]=_ba[i];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 723
column: 8
content: for(i=0;i<_bb.length;i++)babcde[k++]=_bb[i];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 724
column: 8
content: for(i=0;i<_bc.length;i++)babcde[k++]=_bc[i];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 725
column: 8
content: for(i=0;i<_bd.length;i++)babcde[k++]=_bd[i];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 726
column: 8
content: for(i=0;i<_be.length;i++)babcde[k++]=_be[i];

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1371
column: 8
content: for(uint8i=0;i<_newElement.length;i++){defenceElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1377
column: 8
content: for(uint8i=0;i<_newElement.length;i++){meleeElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1383
column: 8
content: for(uint8i=0;i<_newElement.length;i++){bodyElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1389
column: 8
content: for(uint8i=0;i<_newElement.length;i++){turretElementBySubtypeIndex.push(_newElement[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 1516
column: 8
content: for(uinti=0;i<crates.length;i++){uintpendingBlockNumber=crates[i];require(block.number>pendingBlockNumber);varhash=block.blockhash(pendingBlockNumber);if(uint(hash)!=0){uintrand=uint(keccak256(hash,msg.sender,i));_generateRandomPart(rand,msg.sender);}else{}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2033
column: 8
content: for(uinti=0;i<pc.length;i++){uintcrateBlock=pc[i];require(block.number>crateBlock);varhash=block.blockhash(crateBlock);if(uint(hash)!=0){uintrand=uint(keccak256(hash,msg.sender,i))%(10**20);_migrateRobot(uintToString(rand));count++;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2087
column: 8
content: for(uint8i=0;i<approvedBattles.length;i++){if(msg.sender==address(approvedBattles[i])){returntrue;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2112
column: 8
content: for(uinti=0;i<partIds.length;i++){_approve(partIds[i],address(battle));}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2139
column: 8
content: for(uinti=0;i<_exps.length;i++){sum+=_addPartExperience(_partIds[i],_exps[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2220
column: 8
content: for(uinti=0;i<rewards.length;i++){if(rewards[i].blocknumber==0){rewards[i].blocknumber=block.number;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2233
column: 8
content: for(uinti=0;i<len;i++){RewardmemoryrewardStruct=pendingRewards[msg.sender][i];require(block.number>rewardStruct.blocknumber);require(rewardStruct.blocknumber!=0);varhash=block.blockhash(rewardStruct.blocknumber);if(uint(hash)!=0){uintrand=uint(keccak256(hash,msg.sender,i));_generateBattleReward(rand,rewardStruct.exp);count++;}else{}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2326
column: 8
content: for(uinti=0;i<partIds.length;i++){total+=getLevel(parts[partIds[i]].experience);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 2338
column: 8
content: for(uinti=0;i<len;i++){if(parts[partIds[i]].partType!=i+1){returnfalse;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 1507
column: 16
content: user.numShards>=SHARDS_TO_PART

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 108
column: 0
content: contractERC721{bytes4internalconstantINTERFACE_SIGNATURE_ERC165=bytes4(keccak256("supportsInterface(bytes4)"));bytes4internalconstantINTERFACE_SIGNATURE_ERC721=bytes4(keccak256("ownerOf(uint256)"))^bytes4(keccak256("countOfDeeds()"))^bytes4(keccak256("countOfDeedsByOwner(address)"))^bytes4(keccak256("deedOfOwnerByIndex(address,uint256)"))^bytes4(keccak256("approve(address,uint256)"))^bytes4(keccak256("takeOwnership(uint256)"));functionsupportsInterface(bytes4_interfaceID)externalpurereturns(bool);functionownerOf(uint256_deedId)publicviewreturns(address_owner);functioncountOfDeeds()externalviewreturns(uint256_count);functioncountOfDeedsByOwner(address_owner)externalviewreturns(uint256_count);functiondeedOfOwnerByIndex(address_owner,uint256_index)externalviewreturns(uint256_deedId);eventTransfer(addressindexedfrom,addressindexedto,uint256indexeddeedId);eventApproval(addressindexedowner,addressindexedapproved,uint256indexeddeedId);functionapprove(address_to,uint256_deedId)externalpayable;functiontakeOwnership(uint256_deedId)externalpayable;}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 191
column: 0
content: contractERC721Original{bytes4constantINTERFACE_SIGNATURE_ERC721Original=bytes4(keccak256("totalSupply()"))^bytes4(keccak256("balanceOf(address)"))^bytes4(keccak256("ownerOf(uint256)"))^bytes4(keccak256("approve(address,uint256)"))^bytes4(keccak256("takeOwnership(uint256)"))^bytes4(keccak256("transfer(address,uint256)"));functionimplementsERC721()publicpurereturns(bool);functiontotalSupply()publicviewreturns(uint256_totalSupply);functionbalanceOf(address_owner)publicviewreturns(uint256_balance);functionownerOf(uint_tokenId)publicviewreturns(address_owner);functionapprove(address_to,uint_tokenId)externalpayable;functiontransferFrom(address_from,address_to,uint_tokenId)public;functiontransfer(address_to,uint_tokenId)publicpayable;functionname()publicpurereturns(string_name);functionsymbol()publicpurereturns(string_symbol);functiontokenOfOwnerByIndex(address_owner,uint_index)externalviewreturns(uint_tokenId);functiontokenMetadata(uint_tokenId)publicviewreturns(string_infoUrl);}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 414
column: 0
content: contractEtherbotsNFTisEtherbotsBase,ERC721Enumerable,ERC721Original{functionsupportsInterface(bytes4_interfaceID)externalpurereturns(bool){return(_interfaceID==ERC721Original.INTERFACE_SIGNATURE_ERC721Original)||(_interfaceID==ERC721.INTERFACE_SIGNATURE_ERC721)||(_interfaceID==ERC721Metadata.INTERFACE_SIGNATURE_ERC721Metadata)||(_interfaceID==ERC721Enumerable.INTERFACE_SIGNATURE_ERC721Enumerable);}functionimplementsERC721()publicpurereturns(bool){returntrue;}functionname()publicpurereturns(string_name){return"Etherbots";}functionsymbol()publicpurereturns(string_smbol){return"ETHBOT";}functiontotalSupply()publicviewreturns(uint){returnparts.length;}functioncountOfDeeds()externalviewreturns(uint256){returnparts.length;}functionowns(address_owner,uint256_tokenId)publicviewreturns(bool){return(partIndexToOwner[_tokenId]==_owner);}functionownsAll(address_owner,uint256[]_tokenIds)publicviewreturns(bool){require(_tokenIds.length>0);for(uinti=0;i<_tokenIds.length;i++){if(partIndexToOwner[_tokenIds[i]]!=_owner){returnfalse;}}returntrue;}function_approve(uint256_tokenId,address_approved)internal{partIndexToApproved[_tokenId]=_approved;}function_approvedFor(address_newOwner,uint256_tokenId)internalviewreturns(bool){return(partIndexToApproved[_tokenId]==_newOwner);}functionownerByIndex(uint256_index)externalviewreturns(address_owner){returnpartIndexToOwner[_index];}functionbalanceOf(address_owner)publicviewreturns(uint256count){returnaddressToTokensOwned[_owner];}functioncountOfDeedsByOwner(address_owner)externalviewreturns(uint256){returnbalanceOf(_owner);}functiontransfer(address_to,uint256_tokenId)publicwhenNotPausedpayable{require(msg.value==0);require(_to!=address(0));require(_to!=address(this));require(_to!=address(auction));for(uintj=0;j<approvedBattles.length;j++){require(_to!=approvedBattles[j]);}require(owns(msg.sender,_tokenId));_transfer(msg.sender,_to,_tokenId);}functiontransferAll(address_to,uint256[]_tokenIds)publicwhenNotPausedpayable{require(msg.value==0);require(_to!=address(0));require(_to!=address(this));require(_to!=address(auction));for(uintj=0;j<approvedBattles.length;j++){require(_to!=approvedBattles[j]);}require(ownsAll(msg.sender,_tokenIds));for(uintk=0;k<_tokenIds.length;k++){_transfer(msg.sender,_to,_tokenIds[k]);}}functionapprove(address_to,uint256_deedId)externalwhenNotPausedpayable{require(msg.value==0);require(owns(msg.sender,_deedId));partIndexToApproved[_deedId]=_to;Approval(msg.sender,_to,_deedId);}functionapproveMany(address_to,uint256[]_tokenIds)externalwhenNotPausedpayable{for(uinti=0;i<_tokenIds.length;i++){uint_tokenId=_tokenIds[i];require(owns(msg.sender,_tokenId));partIndexToApproved[_tokenId]=_to;Approval(msg.sender,_to,_tokenId);}}functiontransferFrom(address_from,address_to,uint256_tokenId)publicwhenNotPaused{require(_to!=address(0));require(_to!=address(this));require(partIndexToApproved[_tokenId]==msg.sender);require(owns(_from,_tokenId));_transfer(_from,_to,_tokenId);}functionownerOf(uint256_deedId)publicviewreturns(address_owner){_owner=partIndexToOwner[_deedId];require(_owner!=address(0));}functiontokensOfOwner(address_owner)externalviewreturns(uint256[]ownerTokens){uint256totalParts=totalSupply();returntokensOfOwnerWithinRange(_owner,0,totalParts);}functiontokensOfOwnerWithinRange(address_owner,uint_start,uint_numToSearch)publicviewreturns(uint256[]ownerTokens){uint256tokenCount=balanceOf(_owner);uint256[]memorytmpResult=newuint256[](tokenCount);if(tokenCount==0){returntmpResult;}uint256resultIndex=0;for(uintpartId=_start;partId<_start+_numToSearch;partId++){if(partIndexToOwner[partId]==_owner){tmpResult[resultIndex]=partId;resultIndex++;if(resultIndex==tokenCount){break;}}}uintresultLength=resultIndex;uint256[]memoryresult=newuint256[](resultLength);for(uinti=0;i<resultLength;i++){result[i]=tmpResult[i];}returnresult;}functiongetPartsOfOwner(address_owner)externalviewreturns(bytes24[]){uint256totalParts=totalSupply();returngetPartsOfOwnerWithinRange(_owner,0,totalParts);}functiongetPartsOfOwnerWithinRange(address_owner,uint_start,uint_numToSearch)publicviewreturns(bytes24[]){uint256tokenCount=balanceOf(_owner);uintresultIndex=0;bytes24[]memoryresult=newbytes24[](tokenCount);for(uintpartId=_start;partId<_start+_numToSearch;partId++){if(partIndexToOwner[partId]==_owner){result[resultIndex]=_partToBytes(parts[partId]);resultIndex++;}}returnresult;}function_partToBytes(Partp)internalpurereturns(bytes24b){b=bytes24(p.tokenId);b=b<<8;b=b|bytes24(p.partType);b=b<<8;b=b|bytes24(p.partSubType);b=b<<8;b=b|bytes24(p.rarity);b=b<<8;b=b|bytes24(p.element);b=b<<32;b=b|bytes24(p.battlesLastDay);b=b<<32;b=b|bytes24(p.experience);b=b<<32;b=b|bytes24(p.forgeTime);b=b<<32;b=b|bytes24(p.battlesLastReset);}uint32constantFIRST_LEVEL=1000;uint32constantINCREMENT=1000;functiongetLevel(uint32_exp)publicpurereturns(uint32){uint32c=0;for(uint32i=FIRST_LEVEL;i<=FIRST_LEVEL+_exp;i+=c*INCREMENT){c++;}returnc;}stringmetadataBase="https://api.etherbots.io/api/";functionsetMetadataBase(string_base)externalonlyOwner{metadataBase=_base;}function_metadata(uint256_id)internalviewreturns(string){Partmemoryp=parts[_id];returnstrConcat(strConcat(metadataBase,uintToString(uint(p.partType)),"/",uintToString(uint(p.partSubType)),"/"),uintToString(uint(p.rarity)),"","","");}functionstrConcat(string_a,string_b,string_c,string_d,string_e)internalpurereturns(string){bytesmemory_ba=bytes(_a);bytesmemory_bb=bytes(_b);bytesmemory_bc=bytes(_c);bytesmemory_bd=bytes(_d);bytesmemory_be=bytes(_e);stringmemoryabcde=newstring(_ba.length+_bb.length+_bc.length+_bd.length+_be.length);bytesmemorybabcde=bytes(abcde);uintk=0;for(uinti=0;i<_ba.length;i++)babcde[k++]=_ba[i];for(i=0;i<_bb.length;i++)babcde[k++]=_bb[i];for(i=0;i<_bc.length;i++)babcde[k++]=_bc[i];for(i=0;i<_bd.length;i++)babcde[k++]=_bd[i];for(i=0;i<_be.length;i++)babcde[k++]=_be[i];returnstring(babcde);}functiondeedUri(uint256_deedId)externalviewreturns(string_uri){return_metadata(_deedId);}functiontokenMetadata(uint256_tokenId)publicviewreturns(stringinfoUrl){return_metadata(_tokenId);}functiontakeOwnership(uint256_deedId)externalpayable{require(msg.value==0);address_from=partIndexToOwner[_deedId];require(_approvedFor(msg.sender,_deedId));_transfer(_from,msg.sender,_deedId);}functiondeedByIndex(uint256_index)externalviewreturns(uint256_deedId){return_index;}functioncountOfOwners()externalviewreturns(uint256_count){return0;}functiontokenOfOwnerByIndex(address_owner,uint_index)externalviewreturns(uint_tokenId){return_tokenOfOwnerByIndex(_owner,_index);}function_tokenOfOwnerByIndex(address_owner,uint_index)privateviewreturns(uint_tokenId){require(_index<balanceOf(_owner));uint256seen=0;uint256totalTokens=totalSupply();for(uinti=0;i<totalTokens;i++){if(partIndexToOwner[i]==_owner){if(seen==_index){returni;}seen++;}}}functiondeedOfOwnerByIndex(address_owner,uint256_index)externalviewreturns(uint256_deedId){return_tokenOfOwnerByIndex(_owner,_index);}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 2053
column: 0
content: contractBattle{functionname()externalviewreturns(string);functionplayerCount()externalviewreturns(uintcount);functioncreateBattle(address_creator,uint[]_partIds,bytes32_commit,uint_revealLength)externalpayablereturns(uint);functioncancelBattle(uintbattleID)external;functionwinnerOf(uintbattleId,uintindex)externalviewreturns(address);functionloserOf(uintbattleId,uintindex)externalviewreturns(address);eventBattleCreated(uintindexedbattleID,addressindexedstarter);eventBattleStage(uintindexedbattleID,uint8moveNumber,uint8[2]attackerMovesDefenderMoves,uint16[2]attackerDamageDefenderDamage);eventBattleEnded(uintindexedbattleID,addressindexedwinner);eventBattleConcluded(uintindexedbattleID);eventBattlePropertyChanged(stringname,uintprevious,uintvalue);}

ruleId: SOLIDITY_MSGVALUE_EQUALS_ZERO
patternId: 1df89a
severity: 1
line: 487
column: 16
content: msg.value==0

ruleId: SOLIDITY_MSGVALUE_EQUALS_ZERO
patternId: 1df89a
severity: 1
line: 508
column: 16
content: msg.value==0

ruleId: SOLIDITY_MSGVALUE_EQUALS_ZERO
patternId: 1df89a
severity: 1
line: 536
column: 16
content: msg.value==0

ruleId: SOLIDITY_MSGVALUE_EQUALS_ZERO
patternId: 1df89a
severity: 1
line: 757
column: 16
content: msg.value==0

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 696
column: 4
content: functionsetMetadataBase(string_base)externalonlyOwner{metadataBase=_base;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 986
column: 4
content: functionsetMinDuration(uint_duration)externalonlyOwner{minDuration=_duration;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 990
column: 4
content: functionsetMaxDuration(uint_duration)externalonlyOwner{maxDuration=_duration;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1230
column: 4
content: functionsetAuctionAddress(address_address)externalonlyOwner{require(_address!=address(0));DutchAuctioncandidateContract=DutchAuction(_address);auction=candidateContract;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1276
column: 4
content: functionsetScrapMinStartPrice(uint_newMinStartPrice)externalonlyOwner{scrapMinStartPrice=_newMinStartPrice;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1279
column: 4
content: functionsetScrapMinEndPrice(uint_newMinEndPrice)externalonlyOwner{scrapMinEndPrice=_newMinEndPrice;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1282
column: 4
content: functionsetScrapAuctionDuration(uint_newScrapAuctionDuration)externalonlyOwner{scrapAuctionDuration=_newScrapAuctionDuration;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1360
column: 4
content: functionsetRewardChance(uint_newChance)externalonlyOwner{require(_newChance>980);require(_newChance<=1000);PART_REWARD_CHANCE=_newChance;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1554
column: 4
content: functionsetScrapPercent(uint8_newPercent)externalonlyOwner{require((_newPercent>=50)&&(_newPercent<=90));scrapPercent=_newPercent;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1563
column: 4
content: functionsetBurnRate(uint8_rate)externalonlyOwner{burnRate=_rate;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 2174
column: 4
content: functionsetBest(uint8_newBestMultiple)externalonlyOwner{bestMultiple=_newBestMultiple;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 2177
column: 4
content: functionsetMedium(uint8_newMediumMultiple)externalonlyOwner{mediumMultiple=_newMediumMultiple;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 2180
column: 4
content: functionsetWorst(uint8_newWorstMultiple)externalonlyOwner{worstMultiple=_newWorstMultiple;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 2183
column: 4
content: functionsetMinShards(uint8_newMin)externalonlyOwner{minShards=_newMin;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 2186
column: 4
content: functionsetBestProbability(uint8_newBestProb)externalonlyOwner{bestProbability=_newBestProb;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 2189
column: 4
content: functionsetMediumProbability(uint8_newMinProb)externalonlyOwner{mediumProbability=_newMinProb;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 2280
column: 4
content: functionsetMinScaled(int8_min)externalonlyOwner{minScaled=_min;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 1885
column: 20
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 1886
column: 20
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 1887
column: 20
content: private

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 1888
column: 20
content: private

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 1984
column: 68
content: (uint8[4]body,uint8[4]melee,uint8[4]turret,uint8[4]defence)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 2164
column: 61
content: (uint8,uint8)

ruleId: SOLIDITY_UINT_CANT_BE_NEGATIVE
patternId: d48ac4
severity: 2
line: 1712
column: 31
content: i>=0

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 1526
column: 33
content: keccak256(hash,msg.sender,i)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 1720
column: 33
content: keccak256(hash,msg.sender,i)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 2041
column: 33
content: keccak256(hash,msg.sender,i)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 2245
column: 33
content: keccak256(hash,msg.sender,i)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 153
column: 41
content: stringn

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 154
column: 43
content: strings

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 211
column: 41
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 212
column: 43
content: string_symbol

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 214
column: 63
content: string_infoUrl

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 372
column: 23
content: stringstr

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 372
column: 90
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 382
column: 28
content: strings

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 393
column: 27
content: strings

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 397
column: 57
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 425
column: 41
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 429
column: 43
content: string_smbol

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 453
column: 37
content: uint256[]_tokenIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 507
column: 38
content: uint256[]_tokenIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 598
column: 106
content: uint256[]ownerTokens

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 638
column: 108
content: bytes24[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 702
column: 58
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 713
column: 23
content: string_a

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 713
column: 34
content: string_b

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 713
column: 45
content: string_c

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 713
column: 56
content: string_d

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 713
column: 67
content: string_e

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 713
column: 101
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 751
column: 66
content: stringinfoUrl

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 950
column: 30
content: Auction_auction

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 971
column: 42
content: Auction_auction

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1460
column: 47
content: uint8[]elementBySubtypeIndex

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1493
column: 25
content: uint8[]elementBySubtypeIndex

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1750
column: 66
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1948
column: 27
content: stringrobot

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1958
column: 24
content: stringoriginal

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1969
column: 25
content: stringelementString

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1974
column: 24
content: stringoriginal

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 1984
column: 31
content: stringoriginal

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 2324
column: 24
content: uint[]partIds

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 193
column: 4
content: bytes4constantINTERFACE_SIGNATURE_ERC721Original=bytes4(keccak256("totalSupply()"))^bytes4(keccak256("balanceOf(address)"))^bytes4(keccak256("ownerOf(uint256)"))^bytes4(keccak256("approve(address,uint256)"))^bytes4(keccak256("takeOwnership(uint256)"))^bytes4(keccak256("transfer(address,uint256)"));

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 262
column: 4
content: uint8constantDEFENCE=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 263
column: 4
content: uint8constantMELEE=2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 264
column: 4
content: uint8constantBODY=3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 265
column: 4
content: uint8constantTURRET=4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 268
column: 4
content: uint8constantSTANDARD=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 269
column: 4
content: uint8constantSHADOW=2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 270
column: 4
content: uint8constantGOLD=3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 311
column: 4
content: Part[]parts;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 318
column: 4
content: mapping(address=>uint256)addressToTokensOwned;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 324
column: 4
content: addressauction;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 330
column: 4
content: address[]approvedBattles;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 681
column: 4
content: uint32constantFIRST_LEVEL=1000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 682
column: 4
content: uint32constantINCREMENT=1000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 693
column: 4
content: stringmetadataBase="https://api.etherbots.io/api/";

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 835
column: 4
content: uint8constantPRESTIGE_INDEX=0;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 836
column: 4
content: uint8constantPERK_COUNT=30;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 938
column: 4
content: mapping(uint256=>Auction)tokenIdToAuction;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1105
column: 4
content: bytes4constantInterfaceSignature_ERC721=bytes4(0xda671b9b);

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1155
column: 4
content: uint8constantLAST_CONSIDERED=5;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1272
column: 4
content: uintscrapMinStartPrice=0.05ether;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1273
column: 4
content: uintscrapMinEndPrice=0.005ether;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1274
column: 4
content: uintscrapAuctionDuration=2days;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1498
column: 4
content: mapping(address=>uint[])pendingPartCrates;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1535
column: 4
content: uint32constantSHARDS_MAX=10000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1550
column: 4
content: uint32constantSHARDS_TO_PART=500;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1598
column: 4
content: uint16constantMINT_LIMIT=5000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1643
column: 4
content: address[6]migrators=[0x700FeBD9360ac0A0a72F371615427Bec4E4454E5,0x72Cc898de0A4EAC49c46ccb990379099461342f6,0xc3cC48da3B8168154e0f14Bf0446C7a93613F0A7,0x4cC96f2Ddf6844323ae0d8461d418a4D473b9AC3,0xa52bFcb5FF599e29EE2B9130F1575BaBaa27de0A,0xe503b42AabdA22974e2A8B75Fa87E010e1B13584];

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1877
column: 4
content: addresspresale=0xc23F76aEa00B775AADC8504CcB22468F4fD2261A;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1880
column: 4
content: mapping(address=>uint[])pendingCrates;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2158
column: 4
content: uint8bestMultiple=3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2159
column: 4
content: uint8mediumMultiple=2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2160
column: 4
content: uint8worstMultiple=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2161
column: 4
content: uint8minShards=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2162
column: 4
content: uint8bestProbability=97;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2163
column: 4
content: uint8mediumProbability=85;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 2284
column: 4
content: int8minScaled=25;

SOLIDITY_VISIBILITY :37
SOLIDITY_MSGVALUE_EQUALS_ZERO :4
SOLIDITY_OVERPOWERED_ROLE :17
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_LOCKED_MONEY :4
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :4
SOLIDITY_EXTRA_GAS_IN_LOOPS :29
SOLIDITY_ADDRESS_HARDCODED :9
SOLIDITY_UPGRADE_TO_050 :39
SOLIDITY_UINT_CANT_BE_NEGATIVE :1
SOLIDITY_GAS_LIMIT_IN_LOOPS :25
SOLIDITY_SHOULD_RETURN_STRUCT :2