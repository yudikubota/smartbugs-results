/unique_chucks/45/0x57f854ba5baf019ec3a77f81c2966fd0d8905a38.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 401
column: 12
content: randomClassIds.length--

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 136
column: 4
content: functiongetSizeArrayType(ArrayType_type,uint64_id)constantpublicreturns(uint);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 137
column: 4
content: functiongetElementInArrayType(ArrayType_type,uint64_id,uint_index)constantpublicreturns(uint8);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 138
column: 4
content: functiongetMonsterClass(uint32_classId)constantpublicreturns(uint32classId,uint256price,uint256returnPrice,uint32total,boolcatchable);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 139
column: 4
content: functiongetMonsterObj(uint64_objId)constantpublicreturns(uint64objId,uint32classId,addresstrainer,uint32exp,uint32createIndex,uint32lastClaimIndex,uintcreateTime);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 140
column: 4
content: functiongetMonsterName(uint64_objId)constantpublicreturns(stringname);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 141
column: 4
content: functiongetExtraBalance(address_trainer)constantpublicreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 142
column: 4
content: functiongetMonsterDexSize(address_trainer)constantpublicreturns(uint);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 143
column: 4
content: functiongetMonsterObjId(address_trainer,uintindex)constantpublicreturns(uint64);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 144
column: 4
content: functiongetExpectedBalance(address_trainer)constantpublicreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 145
column: 4
content: functiongetMonsterReturn(uint64_objId)constantpublicreturns(uint256current,uint256total);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 150
column: 4
content: functiongetHatchingEggId(address_trainer)constantexternalreturns(uint64);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 151
column: 4
content: functiongetHatchingEggData(address_trainer)constantexternalreturns(uint64,uint64,uint32,address,uint,uint64);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 152
column: 4
content: functiongetTranformedId(uint64_objId)constantexternalreturns(uint64);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 153
column: 4
content: functioncountEgg(uint64_objId)constantexternalreturns(uint);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 163
column: 4
content: functiongetGen0COnfig(uint32_classId)constantpublicreturns(uint32,uint256,uint32);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 164
column: 4
content: functiongetTrainerEarn(address_trainer)constantpublicreturns(uint256);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 165
column: 4
content: functiongetReturnFromMonster(uint64_objId)constantpublicreturns(uint256current,uint256total);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 166
column: 4
content: functiongetClassPropertyValue(uint32_classId,PropertyType_type,uintindex)constantexternalreturns(uint32);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 167
column: 4
content: functiongetClassPropertySize(uint32_classId,PropertyType_type)constantexternalreturns(uint);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 171
column: 4
content: functionisOnBattle(uint64_objId)constantexternalreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 172
column: 4
content: functiongetMonsterLevel(uint64_objId)constantpublicreturns(uint8);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 176
column: 4
content: functionisOnTrading(uint64_objId)constantexternalreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 289
column: 4
content: functiongetRandom(uint16maxRan,uint8index,addresspriAddress)constantpublicreturns(uint8){uint256genNum=uint256(block.blockhash(block.number-1))+uint256(priAddress);for(uint8i=0;i<index&&i<6;i++){genNum/=256;}returnuint8(genNum%maxRan);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 456
column: 4
content: functiongetGen0ObjInfo(uint64_objId)constantpublicreturns(uint32,uint32,uint256){EtheremonDataBasedata=EtheremonDataBase(dataContract);MonsterObjAccmemoryobj;(obj.monsterId,obj.classId,obj.trainer,obj.exp,obj.createIndex,obj.lastClaimIndex,obj.createTime)=data.getMonsterObj(_objId);Gen0Configmemorygen0=gen0Config[obj.classId];if(gen0.classId!=obj.classId){return(gen0.classId,obj.createIndex,0);}uint32totalGap=0;if(obj.createIndex<gen0.total)totalGap=gen0.total-obj.createIndex;return(obj.classId,obj.createIndex,safeMult(totalGap,gen0.returnPrice));}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 474
column: 4
content: functiongetObjClassId(uint64_objId)requireDataContractconstantpublicreturns(uint32,address,uint8){EtheremonDataBasedata=EtheremonDataBase(dataContract);MonsterObjAccmemoryobj;uint32_=0;(obj.monsterId,obj.classId,obj.trainer,obj.exp,_,_,obj.createTime)=data.getMonsterObj(_objId);return(obj.classId,obj.trainer,getLevel(obj.exp));}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 482
column: 4
content: functiongetClassCheckOwner(uint64_objId,address_trainer)requireDataContractconstantpublicreturns(uint32){EtheremonDataBasedata=EtheremonDataBase(dataContract);MonsterObjAccmemoryobj;uint32_=0;(obj.monsterId,obj.classId,obj.trainer,obj.exp,_,_,obj.createTime)=data.getMonsterObj(_objId);if(_trainer!=obj.trainer)return0;returnobj.classId;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 492
column: 4
content: functioncalculateMaxEggG0(uint64_objId)constantpublicreturns(uint){uint32classId;uint32createIndex;uint256totalEarn;(classId,createIndex,totalEarn)=getGen0ObjInfo(_objId);if(classId>GEN0_NO||classId==20||classId==21)return0;Gen0Configmemoryconfig=gen0Config[classId];if(createIndex>config.total)return0;uint256avgPrice=config.originalPrice;uintrate=config.originalPrice/config.returnPrice;if(config.total>rate){uintk=config.total-rate;avgPrice=(config.total*config.originalPrice+config.returnPrice*k*(k+1)/2)/config.total;}uint256catchPrice=config.originalPrice;if(createIndex>rate){catchPrice+=config.returnPrice*safeSubtract(createIndex,rate);}if(totalEarn>=catchPrice){return0;}returnceil((catchPrice-totalEarn)*15*1000/avgPrice,10000)/10000;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 522
column: 4
content: functioncanLayEgg(uint64_objId,uint32_classId,uint32_level)constantpublicreturns(bool){if(_classId<=GEN0_NO){EtheremonTransformDatatransformData=EtheremonTransformData(transformDataContract);if(transformData.countEgg(_objId)>=calculateMaxEggG0(_objId))returnfalse;returntrue;}else{if(layingEggLevels[_classId]==0||_level<layingEggLevels[_classId])returnfalse;returntrue;}}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 605
column: 4
content: functioncheckAncestors(uint32_classId,address_trainer,uint64_a1,uint64_a2,uint64_a3)constantpublicreturns(bool){EtheremonWorldworld=EtheremonWorld(worldContract);uintindex=0;uint32temp=0;uint32[3]memoryancestors;uint32[3]memoryrequestAncestors;index=world.getClassPropertySize(_classId,PropertyType.ANCESTOR);while(index>0){index-=1;ancestors[index]=world.getClassPropertyValue(_classId,PropertyType.ANCESTOR,index);}if(_a1>0){temp=getClassCheckOwner(_a1,_trainer);if(temp==0)returnfalse;requestAncestors[0]=temp;}if(_a2>0){temp=getClassCheckOwner(_a2,_trainer);if(temp==0)returnfalse;requestAncestors[1]=temp;}if(_a3>0){temp=getClassCheckOwner(_a3,_trainer);if(temp==0)returnfalse;requestAncestors[2]=temp;}if(requestAncestors[0]>0&&(requestAncestors[0]==requestAncestors[1]||requestAncestors[0]==requestAncestors[2]))returnfalse;if(requestAncestors[1]>0&&(requestAncestors[1]==requestAncestors[2]))returnfalse;for(index=0;index<ancestors.length;index++){temp=ancestors[index];if(temp>0&&temp!=requestAncestors[0]&&temp!=requestAncestors[1]&&temp!=requestAncestors[2])returnfalse;}returntrue;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 714
column: 4
content: functiongetBonusEgg(uint64_objId)constantpublicreturns(uint){EtheremonTransformDatatransformData=EtheremonTransformData(transformDataContract);uinttotalBonusEgg=calculateMaxEggG0(_objId);if(totalBonusEgg>0){return(totalBonusEgg-transformData.countEgg(_objId));}return0;}

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 437
column: 15
content: ((a+m-1)/m)*m

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 300
column: 8
content: for(uinti=0;i<STAT_COUNT;i+=1){uint8value=getRandom(STAT_MAX,uint8(i),lastHatchingAddress)+data.getElementInArrayType(ArrayType.STAT_START,uint64(_classId),i);data.addElementToArrayType(ArrayType.STAT_BASE,objId,value);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 382
column: 12
content: for(uintindex=0;index<randomClassIds.length;index++){if(randomClassIds[index]==_newClassId){return;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 393
column: 8
content: for(;foundIndex<randomClassIds.length;foundIndex++){if(randomClassIds[foundIndex]==_oldClassId){break;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 642
column: 8
content: for(index=0;index<ancestors.length;index++){temp=ancestors[index];if(temp>0&&temp!=requestAncestors[0]&&temp!=requestAncestors[1]&&temp!=requestAncestors[2])returnfalse;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 382
column: 12
content: for(uintindex=0;index<randomClassIds.length;index++){if(randomClassIds[index]==_newClassId){return;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 642
column: 8
content: for(index=0;index<ancestors.length;index++){temp=ancestors[index];if(temp>0&&temp!=requestAncestors[0]&&temp!=requestAncestors[1]&&temp!=requestAncestors[2])returnfalse;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 445
column: 15
content: minIndex<maxIndex

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 239
column: 12
content: private

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 350
column: 8
content: if(_amount>this.balance){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 410
column: 8
content: if(egg.eggId==0||egg.trainer!=_trainer||egg.newObjId>0)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 417
column: 8
content: if(randomClassIds.length==0){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 423
column: 8
content: if(transformData.getHatchingEggId(_trainer)>0){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 539
column: 8
content: if(transformData.getHatchingEggId(msg.sender)>0){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 548
column: 8
content: if(obj.monsterId!=_objId||obj.trainer!=msg.sender){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 555
column: 8
content: if(!canLayEgg(_objId,obj.classId,currentLevel))revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 557
column: 8
content: if(layingEggDeductions[obj.classId]>=currentLevel)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 578
column: 8
content: if(egg.eggId==0||egg.trainer!=msg.sender)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 581
column: 8
content: if(egg.newObjId>0||egg.hatchTime>block.timestamp){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 595
column: 8
content: if(egg.eggId==0||egg.trainer!=msg.sender||egg.newObjId>0)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 598
column: 8
content: if(msg.value!=removeHatchingTimeFee){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 653
column: 8
content: if(transformData.getTranformedId(_objId)>0)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 658
column: 8
content: if(battle.isOnBattle(_objId)||trade.isOnTrading(_objId))revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 666
column: 8
content: if(objInfo.classId==0||objInfo.owner!=msg.sender)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 668
column: 8
content: if(transformLevels[objInfo.classId]==0||objInfo.level<transformLevels[objInfo.classId])revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 670
column: 8
content: if(transformClass==0)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 677
column: 12
content: if(getBonusEgg(_objId)>0)revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 680
column: 12
content: if(!checkAncestors(objInfo.classId,msg.sender,_a1,_a2,_a3))revert();

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 692
column: 8
content: if(msg.value!=buyEggFee){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 696
column: 8
content: if(randomClassIds.length==0){revert();}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 702
column: 8
content: if(transformData.getHatchingEggId(msg.sender)>0){revert();}

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 122
column: 62
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 123
column: 42
content: string_name

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 140
column: 67
content: stringname

ruleId: SOLIDITY_VISIBILITY
patternId: 23rt6g
severity: 1
line: 172
column: 53
content: public

SOLIDITY_VISIBILITY :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :30
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_ARRAY_LENGTH_MANIPULATION :1
SOLIDITY_REVERT_REQUIRE :22
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :4
SOLIDITY_UPGRADE_TO_050 :3
SOLIDITY_GAS_LIMIT_IN_LOOPS :3
SOLIDITY_DIV_MUL :1