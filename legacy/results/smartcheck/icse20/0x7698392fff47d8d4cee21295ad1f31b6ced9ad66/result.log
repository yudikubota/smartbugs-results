/unique_chucks/17/0x7698392fff47d8d4cee21295ad1f31b6ced9ad66.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 44
column: 2
content: ledger.length=0

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 43ba1c
severity: 1
line: 87
column: 2
content: ledger.length++

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 225
column: 5
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 257
column: 9
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 48
column: 27
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 126
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 133
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 173
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 176
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 181
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 205
column: 14
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 214
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 217
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 222
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 231
column: 34
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 235
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 239
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 243
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 249
column: 0
content: functionCheckHash(uint8Num1,uint8Num2,uint8Num3,uint8Num4,bytes32TheRandomValue)constantreturns(bytes32TheHash){returnsha3(Num1,Num2,Num3,Num4,TheRandomValue);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 259
column: 0
content: functionMyBet(uint8DrawNumber,addressPlayerAddress)constantreturns(uint8[4]Nums){returnledger[DrawNumber].bets[PlayerAddress].Nums;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 200
column: 12
content: j<4&&playernum[j]<nums[i]

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 48
column: 2
content: if(msg.sender!=owner)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 124
column: 2
content: if(msg.value!=ledger[IndexOfCurrentDraw].PriceOfTicket||ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[3]!=0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 129
column: 2
content: if(MyNum1>=MyNum2||MyNum2>=MyNum3||MyNum3>=MyNum4)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 172
column: 2
content: if(msg.value!=0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 175
column: 2
content: if(ledger[DrawNumber].bets[msg.sender].can_withdraw==false)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 180
column: 2
content: if(ledger[DrawNumber].WinningNum4==0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 205
column: 2
content: if(hits==0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 213
column: 2
content: if(!msg.sender.send(win))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 216
column: 2
content: if(!owner.send(win/100))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 221
column: 2
content: if(msg.value!=0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 224
column: 2
content: if(sha3(ledger[DrawNumber].WinningNum1,ledger[DrawNumber].WinningNum2,ledger[DrawNumber].WinningNum3,ledger[DrawNumber].WinningNum4,ledger[DrawNumber].TheRand)==ledger[DrawNumber].TheHash)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 234
column: 2
content: if(now<ledger[DrawNumber].ExpirencyTime)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 238
column: 2
content: if(ledger[DrawNumber].bets[msg.sender].can_withdraw==false)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 242
column: 2
content: if(!msg.sender.send(ledger[DrawNumber].PriceOfTicket))throw;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 41
column: 0
content: functionTheEthereumLottery(){owner=msg.sender;ledger.length=0;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 78
column: 0
content: functionnext_draw(bytes32new_hash,uintpriceofticket,uintguess4outof4,uintguess3outof4,uintguess2outof4,uintguess1outof4)OnlyOwner{ledger.length++;IndexOfCurrentDraw=ledger.length-1;ledger[IndexOfCurrentDraw].TheHash=new_hash;ledger[IndexOfCurrentDraw].Guess4OutOf4=guess4outof4;ledger[IndexOfCurrentDraw].Guess3OutOf4=guess3outof4;ledger[IndexOfCurrentDraw].Guess2OutOf4=guess2outof4;ledger[IndexOfCurrentDraw].Guess1OutOf4=guess1outof4;ledger[IndexOfCurrentDraw].PriceOfTicket=priceofticket;ledger[IndexOfCurrentDraw].ExpirencyTime=now+2weeks;NewDrawReadyToPlay(IndexOfCurrentDraw,new_hash,priceofticket,guess4outof4);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 99
column: 0
content: functionannounce_numbers(uint8no1,uint8no2,uint8no3,uint8no4,uint32index,bytes32the_rand)OnlyOwner{ledger[index].WinningNum1=no1;ledger[index].WinningNum2=no2;ledger[index].WinningNum3=no3;ledger[index].WinningNum4=no4;ledger[index].TheRand=the_rand;DrawReadyToPayout(index,no1,no2,no3,no4,the_rand);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 118
column: 0
content: functionPlay(uint8MyNum1,uint8MyNum2,uint8MyNum3,uint8MyNum4){if(msg.value!=ledger[IndexOfCurrentDraw].PriceOfTicket||ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[3]!=0)throw;if(MyNum1>=MyNum2||MyNum2>=MyNum3||MyNum3>=MyNum4)throw;ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[0]=MyNum1;ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[1]=MyNum2;ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[2]=MyNum3;ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[3]=MyNum4;ledger[IndexOfCurrentDraw].bets[msg.sender].can_withdraw=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 170
column: 0
content: functionWithdraw(uint32DrawNumber){if(msg.value!=0)throw;if(ledger[DrawNumber].bets[msg.sender].can_withdraw==false)throw;if(ledger[DrawNumber].WinningNum4==0)throw;uint8hits=0;uint8i=0;uint8j=0;uint8[4]memoryplayernum=ledger[DrawNumber].bets[msg.sender].Nums;uint8[4]memorynums;(nums[0],nums[1],nums[2],nums[3])=(ledger[DrawNumber].WinningNum1,ledger[DrawNumber].WinningNum2,ledger[DrawNumber].WinningNum3,ledger[DrawNumber].WinningNum4);while(i<4){while(j<4&&playernum[j]<nums[i])++j;if(j==4)break;if(playernum[j]==nums[i])++hits;++i;}if(hits==0)throw;uint256win=0;if(hits==1)win=ledger[DrawNumber].Guess1OutOf4;if(hits==2)win=ledger[DrawNumber].Guess2OutOf4;if(hits==3)win=ledger[DrawNumber].Guess3OutOf4;if(hits==4)win=ledger[DrawNumber].Guess4OutOf4;ledger[DrawNumber].bets[msg.sender].can_withdraw=false;if(!msg.sender.send(win))throw;PlayerWon(win);if(!owner.send(win/100))throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 219
column: 0
content: functionRefund(uint32DrawNumber){if(msg.value!=0)throw;if(sha3(ledger[DrawNumber].WinningNum1,ledger[DrawNumber].WinningNum2,ledger[DrawNumber].WinningNum3,ledger[DrawNumber].WinningNum4,ledger[DrawNumber].TheRand)==ledger[DrawNumber].TheHash)throw;if(now<ledger[DrawNumber].ExpirencyTime)throw;if(ledger[DrawNumber].bets[msg.sender].can_withdraw==false)throw;ledger[DrawNumber].bets[msg.sender].can_withdraw=false;if(!msg.sender.send(ledger[DrawNumber].PriceOfTicket))throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 249
column: 0
content: functionCheckHash(uint8Num1,uint8Num2,uint8Num3,uint8Num4,bytes32TheRandomValue)constantreturns(bytes32TheHash){returnsha3(Num1,Num2,Num3,Num4,TheRandomValue);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 259
column: 0
content: functionMyBet(uint8DrawNumber,addressPlayerAddress)constantreturns(uint8[4]Nums){returnledger[DrawNumber].bets[PlayerAddress].Nums;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 264
column: 0
content: functionannounce(stringMSG)OnlyOwner{Announcements=MSG;}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 51
column: 0
content: addressowner;

SOLIDITY_VISIBILITY :10
SOLIDITY_DEPRECATED_CONSTRUCTIONS :18
SOLIDITY_ARRAY_LENGTH_MANIPULATION :2
SOLIDITY_REVERT_REQUIRE :14
SOLIDITY_GAS_LIMIT_IN_LOOPS :1