/unique_chucks/19/0x97e7ef310499be2f97c392b8b16ddd494af73e22.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 4
column: 2
content: functionbalanceOf(address_who)constantreturns(uintbalance);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 5
column: 2
content: functionallowance(address_owner,address_spender)constantreturns(uintremaining);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 41
column: 2
content: functionmax64(uint64a,uint64b)internalconstantreturns(uint64){returna>=b?a:b;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 45
column: 2
content: functionmin64(uint64a,uint64b)internalconstantreturns(uint64){returna<b?a:b;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 49
column: 2
content: functionmax256(uint256a,uint256b)internalconstantreturns(uint256){returna>=b?a:b;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 53
column: 2
content: functionmin256(uint256a,uint256b)internalconstantreturns(uint256){returna<b?a:b;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 120
column: 2
content: functiongetBookingCount(address_who)constantreturns(uintcount){returnbookings[_who].length;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 123
column: 2
content: functiongetBooking(address_who,uint_index)constantreturns(uint_unicornCount,VisitType_type,uint_startBlock,uint_expiresBlock,VisitState_state,uint_completedBlock,uint_completedCount){Visitstoragev=bookings[_who][_index];return(v.unicornCount,v.t,v.startBlock,v.expiresBlock,v.state,v.completedBlock,v.completedCount);}

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 200
column: 21
content: uint(birthPerHundred).mul(v.unicornCount/100)

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 202
column: 21
content: uint(birthPerTen).mul(v.unicornCount/10)

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 241
column: 22
content: uint(repossessionBountyPerHundred).mul(v.unicornCount/100)

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 243
column: 20
content: uint(repossessionBountyPerTen).mul(v.unicornCount/10)

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 59
column: 2
content: usingSafeMathforuint;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 169
column: 24
content: keccak256(msg.sender,newIndex)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 4
column: 2
content: functionbalanceOf(address_who)constantreturns(uintbalance);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 5
column: 2
content: functionallowance(address_owner,address_spender)constantreturns(uintremaining);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 6
column: 2
content: functiontransferFrom(address_from,address_to,uint_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 7
column: 2
content: functiontransfer(address_to,uint_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 103
column: 2
content: functionUnicornRanch(){visitLength[uint8(VisitType.Spa)]=720;visitLength[uint8(VisitType.Afternoon)]=1440;visitLength[uint8(VisitType.Day)]=2880;visitLength[uint8(VisitType.Overnight)]=8640;visitLength[uint8(VisitType.Week)]=60480;visitLength[uint8(VisitType.Extended)]=120960;visitCost[uint8(VisitType.Spa)]=0;visitCost[uint8(VisitType.Afternoon)]=0;visitCost[uint8(VisitType.Day)]=10szabo;visitCost[uint8(VisitType.Overnight)]=30szabo;visitCost[uint8(VisitType.Week)]=50szabo;visitCost[uint8(VisitType.Extended)]=70szabo;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 120
column: 2
content: functiongetBookingCount(address_who)constantreturns(uintcount){returnbookings[_who].length;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 123
column: 2
content: functiongetBooking(address_who,uint_index)constantreturns(uint_unicornCount,VisitType_type,uint_startBlock,uint_expiresBlock,VisitState_state,uint_completedBlock,uint_completedCount){Visitstoragev=bookings[_who][_index];return(v.unicornCount,v.t,v.startBlock,v.expiresBlock,v.state,v.completedBlock,v.completedCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 128
column: 2
content: functionbookSpaVisit(uint_unicornCount)payable{returnaddBooking(VisitType.Spa,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 131
column: 2
content: functionbookAfternoonVisit(uint_unicornCount)payable{returnaddBooking(VisitType.Afternoon,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 134
column: 2
content: functionbookDayVisit(uint_unicornCount)payable{returnaddBooking(VisitType.Day,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 137
column: 2
content: functionbookOvernightVisit(uint_unicornCount)payable{returnaddBooking(VisitType.Overnight,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 140
column: 2
content: functionbookWeekVisit(uint_unicornCount)payable{returnaddBooking(VisitType.Week,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 143
column: 2
content: functionbookExtendedVisit(uint_unicornCount)payable{returnaddBooking(VisitType.Extended,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 147
column: 2
content: functionaddBooking(VisitType_type,uint_unicornCount)payable{if(_type==VisitType.Afternoon){returndonateUnicorns(availableBalance(msg.sender));}require(msg.value>=visitCost[uint8(_type)].mul(_unicornCount));ERC20TokencardboardUnicorns=ERC20Token(cardboardUnicornTokenAddress);cardboardUnicorns.transferFrom(msg.sender,address(this),_unicornCount);visitingUnicorns=visitingUnicorns.add(_unicornCount);uintexpiresBlock=block.number.add(visitLength[uint8(_type)]);bookings[msg.sender].push(Visit(_unicornCount,_type,block.number,expiresBlock,VisitState.InProgress,0,0));uintnewIndex=bookings[msg.sender].length-1;bytes32uniqueKey=keccak256(msg.sender,newIndex);bookingMetadataForKey[uniqueKey]=VisitMeta(msg.sender,newIndex);if(groveAddress>0){GroveAPIg=GroveAPI(groveAddress);g.insert("bookingExpiration",uniqueKey,int(expiresBlock));}NewBooking(msg.sender,newIndex,_type,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 187
column: 2
content: functioncompleteBooking(uint_index){require(bookings[msg.sender].length>_index);Visitstoragev=bookings[msg.sender][_index];require(block.number>=v.expiresBlock);require(v.state==VisitState.InProgress);uintunicornsToReturn=v.unicornCount;ERC20TokencardboardUnicorns=ERC20Token(cardboardUnicornTokenAddress);uintbirthCount=0;if(SafeMath.sub(block.number,v.startBlock)>=birthBlockThreshold){if(v.unicornCount>=100){birthCount=uint(birthPerHundred).mul(v.unicornCount/100);}elseif(v.unicornCount>=10){birthCount=uint(birthPerTen).mul(v.unicornCount/10);}}if(birthCount>0){uintavailableUnicorns=cardboardUnicorns.balanceOf(address(this))-visitingUnicorns;if(availableUnicorns<birthCount){birthCount=availableUnicorns;}unicornsToReturn=unicornsToReturn.add(birthCount);}v.state=VisitState.Completed;v.completedBlock=block.number;v.completedCount=unicornsToReturn;bookings[msg.sender][_index]=v;visitingUnicorns=visitingUnicorns.sub(v.unicornCount);cardboardUnicorns.transfer(msg.sender,unicornsToReturn);BookingUpdate(msg.sender,_index,VisitState.Completed,unicornsToReturn);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 227
column: 2
content: functionrepossessBooking(address_who,uint_index){require(bookings[_who].length>_index);Visitstoragev=bookings[_who][_index];require(block.number>v.expiresBlock.add(repossessionBlocks));require(v.state==VisitState.InProgress);visitingUnicorns=visitingUnicorns.sub(v.unicornCount);BookingUpdate(_who,_index,VisitState.Repossessed,v.unicornCount);uintbountyCount=1;if(v.unicornCount>=100){bountyCount=uint(repossessionBountyPerHundred).mul(v.unicornCount/100);}elseif(v.unicornCount>=10){bountyCount=uint(repossessionBountyPerTen).mul(v.unicornCount/10);}ERC20TokencardboardUnicorns=ERC20Token(cardboardUnicornTokenAddress);cardboardUnicorns.transfer(msg.sender,bountyCount);RepossessionBounty(msg.sender,bountyCount);v.state=VisitState.Repossessed;v.completedBlock=block.number;v.completedCount=v.unicornCount-bountyCount;bookings[_who][_index]=v;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 273
column: 2
content: function()payable{if(cardboardUnicornTokenAddress==0){return;}returndonateUnicorns(availableBalance(msg.sender));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 280
column: 2
content: functiondonateUnicorns(uint_unicornCount)payable{if(_unicornCount==0){return;}ERC20TokencardboardUnicorns=ERC20Token(cardboardUnicornTokenAddress);cardboardUnicorns.transferFrom(msg.sender,address(this),_unicornCount);DonationReceived(msg.sender,_unicornCount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 292
column: 2
content: functionchangeOwner(address_newOwner)onlyOwner{owner=_newOwner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 299
column: 2
content: functionchangeCardboardUnicornTokenAddress(address_newTokenAddress)onlyOwner{cardboardUnicornTokenAddress=_newTokenAddress;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 302
column: 2
content: functionchangeGroveAddress(address_newAddress)onlyOwner{groveAddress=_newAddress;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 309
column: 2
content: functionchangeVisitLengths(uint_spa,uint_afternoon,uint_day,uint_overnight,uint_week,uint_extended)onlyOwner{visitLength[uint8(VisitType.Spa)]=_spa;visitLength[uint8(VisitType.Afternoon)]=_afternoon;visitLength[uint8(VisitType.Day)]=_day;visitLength[uint8(VisitType.Overnight)]=_overnight;visitLength[uint8(VisitType.Week)]=_week;visitLength[uint8(VisitType.Extended)]=_extended;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 321
column: 2
content: functionchangeVisitCosts(uint_spa,uint_afternoon,uint_day,uint_overnight,uint_week,uint_extended)onlyOwner{visitCost[uint8(VisitType.Spa)]=_spa;visitCost[uint8(VisitType.Afternoon)]=_afternoon;visitCost[uint8(VisitType.Day)]=_day;visitCost[uint8(VisitType.Overnight)]=_overnight;visitCost[uint8(VisitType.Week)]=_week;visitCost[uint8(VisitType.Extended)]=_extended;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 333
column: 2
content: functionchangeRepoSettings(uint_repoBlocks,uint8_repoPerTen,uint8_repoPerHundred)onlyOwner{repossessionBlocks=_repoBlocks;repossessionBountyPerTen=_repoPerTen;repossessionBountyPerHundred=_repoPerHundred;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 342
column: 2
content: functionchangeBirthSettings(uint_birthBlocks,uint8_birthPerTen,uint8_birthPerHundred)onlyOwner{birthBlockThreshold=_birthBlocks;birthPerTen=_birthPerTen;birthPerHundred=_birthPerHundred;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 348
column: 2
content: functionwithdraw()onlyOwner{owner.transfer(this.balance);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 351
column: 2
content: functionwithdrawForeignTokens(address_tokenContract)onlyOwner{ERC20Tokentoken=ERC20Token(_tokenContract);token.transfer(owner,token.balanceOf(address(this)));}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 81
column: 2
content: mapping(address=>Visit[])bookings;

SOLIDITY_VISIBILITY :28
SOLIDITY_SAFEMATH :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :8
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_UPGRADE_TO_050 :1
SOLIDITY_DIV_MUL :4