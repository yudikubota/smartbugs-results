/unique_chucks/10/0xbd897c8885b40d014fb7941b3043b21adcc9ca1c.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 110
column: 10
content: accountIndex.length=accountIndex.length-1

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 15
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 24
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 62
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 153
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 210
column: 10
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 219
column: 10
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 225
column: 40
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 226
column: 28
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 260
column: 8
content: throw

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 160
column: 1
content: functioncontracts(bytes32contractName)returns(addressaddr){}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 67
column: 2
content: functionsetUnit(uint_value)onlyOwner{unit=_value;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 71
column: 2
content: functionsetMasterContract(address_contractAddress)onlyOwner{masterContract=_contractAddress;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 192
column: 4
content: functionsetJudge(address_judgeAddress)onlyOwner{judgeAddress=_judgeAddress;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 196
column: 4
content: functionsetBeneficiary(address_beneficiaryAddress)onlyOwner{beneficiaryAddress=_beneficiaryAddress;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 200
column: 4
content: functionsetImpactRegistry(addressimpactRegistryAddress)onlyOwner{IMPACT_REGISTRY_ADDRESS=impactRegistryAddress;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 204
column: 4
content: functionsetContractProvider(address_contractProvider)onlyOwner{CONTRACT_PROVIDER_ADDRESS=_contractProvider;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 1
column: 16
content: ^

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 3
column: 16
content: ^

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 152
column: 14
content: {throw;}

ruleId: SOLIDITY_REDUNDANT_FALLBACK_REJECT
patternId: b85a32
severity: 1
line: 259
column: 16
content: {throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 14
column: 8
content: if(msg.sender!=owner)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 23
column: 4
content: if(msg.sender!=owner&&msg.sender!=masterContract)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 61
column: 4
content: if(accountBalances[_from]+_value<accountBalances[_from])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 209
column: 8
content: if(total+_value<total)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 218
column: 8
content: if(total+_value<total)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 225
column: 8
content: if(msg.sender!=judgeAddress)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 226
column: 8
content: if(total<_value)throw;

ruleId: SOLIDITY_UINT_CANT_BE_NEGATIVE
patternId: 733fdd
severity: 2
line: 85
column: 10
content: accountBalances[accountIndex[i]]>=0

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 9
column: 1
content: functionOwned(){owner=msg.sender;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 51
column: 2
content: functionImpactRegistry(address_masterContract,uint_unit){masterContract=_masterContract;unit=_unit;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 56
column: 2
content: functionregisterDonation(address_from,uint_value)onlyMaster{if(accountBalances[_from]==0){accountIndex.push(_from);}if(accountBalances[_from]+_value<accountBalances[_from])throw;accountBalances[_from]+=_value;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 67
column: 2
content: functionsetUnit(uint_value)onlyOwner{unit=_value;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 71
column: 2
content: functionsetMasterContract(address_contractAddress)onlyOwner{masterContract=_contractAddress;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 75
column: 2
content: functionregisterOutcome(string_name,uint_value)onlyMaster{impact[_name]=Impact(_value,0,0,0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 79
column: 2
content: functionlinkImpact(string_name)onlyOwner{uintleft=impact[_name].value-impact[_name].linked;if(left>0){uinti=impact[_name].accountCursor;if(accountBalances[accountIndex[i]]>=0){uintshard=accountBalances[accountIndex[i]];if(shard>left){shard=left;}if(shard>unit){shard=unit;}accountBalances[accountIndex[i]]-=shard;if(impact[_name].values[accountIndex[i]]==0){impact[_name].addresses[impact[_name].count++]=accountIndex[i];}impact[_name].values[accountIndex[i]]+=shard;impact[_name].linked+=shard;if(accountBalances[accountIndex[i]]==0){accountIndex[i]=accountIndex[accountIndex.length-1];accountIndex.length=accountIndex.length-1;i--;}}if(accountIndex.length>0){i=(i+1)%accountIndex.length;}else{i=0;}impact[_name].accountCursor=i;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 127
column: 2
content: functionpayBack(address_account)onlyMaster{accountBalances[_account]=0;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 131
column: 2
content: functiongetBalance(address_donorAddress)returns(uint){returnaccountBalances[_donorAddress];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 135
column: 2
content: functiongetImpactCount(stringoutcome)returns(uint){returnimpact[outcome].count;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 139
column: 2
content: functiongetImpactLinked(stringoutcome)returns(uint){returnimpact[outcome].linked;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 143
column: 2
content: functiongetImpactDonor(stringoutcome,uintindex)returns(address){returnimpact[outcome].addresses[index];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 147
column: 2
content: functiongetImpactValue(stringoutcome,addressaddr)returns(uint){returnimpact[outcome].values[addr];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 152
column: 2
content: function(){throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 160
column: 1
content: functioncontracts(bytes32contractName)returns(addressaddr){}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 164
column: 16
content: functiontransfer(address_to,uint256_value);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 188
column: 4
content: functionCharity(string_name){name=_name;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 192
column: 4
content: functionsetJudge(address_judgeAddress)onlyOwner{judgeAddress=_judgeAddress;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 196
column: 4
content: functionsetBeneficiary(address_beneficiaryAddress)onlyOwner{beneficiaryAddress=_beneficiaryAddress;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 200
column: 4
content: functionsetImpactRegistry(addressimpactRegistryAddress)onlyOwner{IMPACT_REGISTRY_ADDRESS=impactRegistryAddress;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 204
column: 4
content: functionsetContractProvider(address_contractProvider)onlyOwner{CONTRACT_PROVIDER_ADDRESS=_contractProvider;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 208
column: 4
content: functionnotify(address_from,uint_value)onlyOwner{if(total+_value<total)throw;total+=_value;ImpactRegistry(IMPACT_REGISTRY_ADDRESS).registerDonation(_from,_value);DonationEvent(_from,_value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 217
column: 4
content: functionfund(uint_value)onlyOwner{if(total+_value<total)throw;total+=_value;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 224
column: 4
content: functionunlockOutcome(string_name,uint_value){if(msg.sender!=judgeAddress)throw;if(total<_value)throw;addresstokenAddress=ContractProvider(CONTRACT_PROVIDER_ADDRESS).contracts("digitalGBP");Token(tokenAddress).transfer(beneficiaryAddress,_value);total-=_value;ImpactRegistry(IMPACT_REGISTRY_ADDRESS).registerOutcome(_name,_value);OutcomeEvent(_name,_value);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 237
column: 4
content: functionpayBack(addressaccount)onlyOwner{uintbalance=getBalance(account);if(balance>0){addresstokenAddress=ContractProvider(CONTRACT_PROVIDER_ADDRESS).contracts("digitalGBP");Token(tokenAddress).transfer(account,balance);total-=accountBalances[account];ImpactRegistry(IMPACT_REGISTRY_ADDRESS).payBack(account);}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 247
column: 4
content: functiongetBalance(addressdonor)returns(uint){returnImpactRegistry(IMPACT_REGISTRY_ADDRESS).getBalance(donor);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 252
column: 4
content: functionescape(addressescapeAddress)onlyOwner{addresstokenAddress=ContractProvider(CONTRACT_PROVIDER_ADDRESS).contracts("digitalGBP");Token(tokenAddress).transfer(escapeAddress,total);total=0;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 259
column: 4
content: function(){throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 7
column: 1
content: addressowner;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 31
column: 2
content: mapping(address=>uint)accountBalances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 34
column: 2
content: address[]accountIndex;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 48
column: 2
content: mapping(string=>Impact)impact;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 176
column: 4
content: mapping(address=>uint)accountBalances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 179
column: 4
content: address[]accountIndex;

SOLIDITY_VISIBILITY :34
SOLIDITY_OVERPOWERED_ROLE :6
SOLIDITY_DEPRECATED_CONSTRUCTIONS :9
SOLIDITY_PRAGMAS_VERSION :2
SOLIDITY_ARRAY_LENGTH_MANIPULATION :1
SOLIDITY_REVERT_REQUIRE :7
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :1
SOLIDITY_UINT_CANT_BE_NEGATIVE :1
SOLIDITY_REDUNDANT_FALLBACK_REJECT :2