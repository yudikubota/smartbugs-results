{
  "contract": "0x3aa927a97594c3ab7d7bf0d47c71c3877d1de4a1",
  "tool": "smartcheck",
  "start": 1563466499.42326,
  "end": 1563466512.945928,
  "duration": 13.52266812324524,
  "analysis": [
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 372,
      "column": 12,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 410,
      "column": 12,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 443,
      "column": 12,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 498,
      "column": 12,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 588,
      "column": 22,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 588,
      "column": 55,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 741,
      "column": 14,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 760,
      "column": 21,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 761,
      "column": 21,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 774,
      "column": 22,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "187b5a",
      "severity": 1,
      "line": 774,
      "column": 60,
      "content": "sha3"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 4,
      "column": 4,
      "content": "functiontotalSupply()constantreturns(uintsupply);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 5,
      "column": 4,
      "content": "functionbalanceOf(addresswho)constantreturns(uintvalue);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 6,
      "column": 4,
      "content": "functionallowance(addressowner,addressspender)constantreturns(uint_allowance);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 22,
      "column": 4,
      "content": "functionadd(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x+y)>=x);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 26,
      "column": 4,
      "content": "functionsub(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x-y)<=x);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 30,
      "column": 4,
      "content": "functionmul(uint256x,uint256y)constantinternalreturns(uint256z){z=x*y;assert(x==0||z/x==y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 35,
      "column": 4,
      "content": "functiondiv(uint256x,uint256y)constantinternalreturns(uint256z){z=x/y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 39,
      "column": 4,
      "content": "functionmin(uint256x,uint256y)constantinternalreturns(uint256z){returnx<=y?x:y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 42,
      "column": 4,
      "content": "functionmax(uint256x,uint256y)constantinternalreturns(uint256z){returnx>=y?x:y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 51,
      "column": 4,
      "content": "functionhadd(uint128x,uint128y)constantinternalreturns(uint128z){assert((z=x+y)>=x);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 55,
      "column": 4,
      "content": "functionhsub(uint128x,uint128y)constantinternalreturns(uint128z){assert((z=x-y)<=x);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 59,
      "column": 4,
      "content": "functionhmul(uint128x,uint128y)constantinternalreturns(uint128z){z=x*y;assert(x==0||z/x==y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 64,
      "column": 4,
      "content": "functionhdiv(uint128x,uint128y)constantinternalreturns(uint128z){z=x/y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 68,
      "column": 4,
      "content": "functionhmin(uint128x,uint128y)constantinternalreturns(uint128z){returnx<=y?x:y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 71,
      "column": 4,
      "content": "functionhmax(uint128x,uint128y)constantinternalreturns(uint128z){returnx>=y?x:y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 80,
      "column": 4,
      "content": "functionimin(int256x,int256y)constantinternalreturns(int256z){returnx<=y?x:y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 83,
      "column": 4,
      "content": "functionimax(int256x,int256y)constantinternalreturns(int256z){returnx>=y?x:y;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 93,
      "column": 4,
      "content": "functionwadd(uint128x,uint128y)constantinternalreturns(uint128){returnhadd(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 97,
      "column": 4,
      "content": "functionwsub(uint128x,uint128y)constantinternalreturns(uint128){returnhsub(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 101,
      "column": 4,
      "content": "functionwmul(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*y+WAD/2)/WAD);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 105,
      "column": 4,
      "content": "functionwdiv(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*WAD+y/2)/y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 109,
      "column": 4,
      "content": "functionwmin(uint128x,uint128y)constantinternalreturns(uint128){returnhmin(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 112,
      "column": 4,
      "content": "functionwmax(uint128x,uint128y)constantinternalreturns(uint128){returnhmax(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 122,
      "column": 4,
      "content": "functionradd(uint128x,uint128y)constantinternalreturns(uint128){returnhadd(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 126,
      "column": 4,
      "content": "functionrsub(uint128x,uint128y)constantinternalreturns(uint128){returnhsub(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 130,
      "column": 4,
      "content": "functionrmul(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*y+RAY/2)/RAY);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 134,
      "column": 4,
      "content": "functionrdiv(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*RAY+y/2)/y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 138,
      "column": 4,
      "content": "functionrpow(uint128x,uint64n)constantinternalreturns(uint128z){z=n%2!=0?x:RAY;for(n/=2;n!=0;n/=2){x=rmul(x,x);if(n%2!=0){z=rmul(z,x);}}}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 165,
      "column": 4,
      "content": "functionrmin(uint128x,uint128y)constantinternalreturns(uint128){returnhmin(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 168,
      "column": 4,
      "content": "functionrmax(uint128x,uint128y)constantinternalreturns(uint128){returnhmax(x,y);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 172,
      "column": 4,
      "content": "functioncast(uint256x)constantinternalreturns(uint128z){assert((z=uint128(x))==x);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 204,
      "column": 4,
      "content": "functioncanCall(addresssrc,addressdst,bytes4sig)constantreturns(bool);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 350,
      "column": 4,
      "content": "functionisActive(uintid)constantreturns(boolactive){returnoffers[id].active;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 354,
      "column": 4,
      "content": "functiongetOwner(uintid)constantreturns(addressowner){returnoffers[id].owner;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 358,
      "column": 4,
      "content": "functiongetOffer(uintid)constantreturns(uint,ERC20,uint,ERC20){varoffer=offers[id];return(offer.pay_amt,offer.pay_gem,offer.buy_amt,offer.buy_gem);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 547,
      "column": 4,
      "content": "functionisClosed()constantreturns(boolclosed){returnstopped||getTime()>close_time;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 766,
      "column": 4,
      "content": "functionisTokenPairWhitelisted(ERC20baseToken,ERC20quoteToken)publicconstantreturns(bool){return(_menu[sha3(baseToken,quoteToken)]||_menu[sha3(quoteToken,baseToken)]);}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 796,
      "column": 4,
      "content": "functiongetMinSell(ERC20pay_gem)constantreturns(uint){return_dust[pay_gem];}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 827,
      "column": 4,
      "content": "functiongetBestOffer(ERC20sell_gem,ERC20buy_gem)constantreturns(uint){return_best[sell_gem][buy_gem];}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 834,
      "column": 4,
      "content": "functiongetWorseOffer(uintid)constantreturns(uint){return_rank[id].prev;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 841,
      "column": 4,
      "content": "functiongetBetterOffer(uintid)constantreturns(uint){return_rank[id].next;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 846,
      "column": 4,
      "content": "functiongetOfferCount(ERC20sell_gem,ERC20buy_gem)constantreturns(uint){return_span[sell_gem][buy_gem];}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 855,
      "column": 4,
      "content": "functiongetFirstUnsortedOffer()constantreturns(uint){return_head;}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 861,
      "column": 4,
      "content": "functiongetNextUnsortedOffer(uintid)constantreturns(uint){return_near[id];}"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 865,
      "column": 4,
      "content": "functionisOfferSorted(uintid)constantreturns(bool){addressbuy_gem=address(offers[id].buy_gem);addresspay_gem=address(offers[id].pay_gem);return(_rank[id].next!=0||_rank[id].prev!=0||_best[pay_gem][buy_gem]==id)?true:false;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "k4o1l4",
      "severity": 1,
      "line": 946,
      "column": 8,
      "content": "while(_best[t_buy_gem][t_pay_gem]>0){best_maker_id=_best[t_buy_gem][t_pay_gem];m_buy_amt=offers[best_maker_id].buy_amt;m_pay_amt=offers[best_maker_id].pay_amt;if(mul(m_buy_amt,t_buy_amt)>mul(t_pay_amt,m_pay_amt)+(rounding?m_buy_amt+t_buy_amt+t_pay_amt+m_pay_amt:0)){break;}buy(best_maker_id,min(m_pay_amt,t_buy_amt));t_buy_amt_old=t_buy_amt;t_buy_amt=sub(t_buy_amt,min(m_pay_amt,t_buy_amt));t_pay_amt=mul(t_buy_amt,t_pay_amt)/t_buy_amt_old;if(t_pay_amt==0||t_buy_amt==0){break;}}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 1104,
      "column": 15,
      "content": "uid>0&&uid!=id"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "38f6c7",
      "severity": 2,
      "line": 902,
      "column": 8,
      "content": "while(top!=0&&_isLtOrEq(id,top)){old_top=top;top=_rank[top].prev;}"
    },
    {
      "name": "SOLIDITY_PRAGMAS_VERSION",
      "patternId": "23fc32",
      "severity": 1,
      "line": 1,
      "column": 16,
      "content": "^"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 255,
      "column": 8,
      "content": "if(!x)revert();"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 192,
      "column": 8,
      "content": "assembly{foo:=calldataload(4)bar:=calldataload(36)}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 4,
      "column": 4,
      "content": "functiontotalSupply()constantreturns(uintsupply);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 5,
      "column": 4,
      "content": "functionbalanceOf(addresswho)constantreturns(uintvalue);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 6,
      "column": 4,
      "content": "functionallowance(addressowner,addressspender)constantreturns(uint_allowance);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 8,
      "column": 4,
      "content": "functiontransfer(addressto,uintvalue)returns(boolok);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 9,
      "column": 4,
      "content": "functiontransferFrom(addressfrom,addressto,uintvalue)returns(boolok);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 10,
      "column": 4,
      "content": "functionapprove(addressspender,uintvalue)returns(boolok);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 204,
      "column": 4,
      "content": "functioncanCall(addresssrc,addressdst,bytes4sig)constantreturns(bool);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 218,
      "column": 4,
      "content": "functionDSAuth(){owner=msg.sender;LogSetOwner(msg.sender);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 223,
      "column": 4,
      "content": "functionsetOwner(addressowner_)auth{owner=owner_;LogSetOwner(owner);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 230,
      "column": 4,
      "content": "functionsetAuthority(DSAuthorityauthority_)auth{authority=authority_;LogSetAuthority(authority);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 350,
      "column": 4,
      "content": "functionisActive(uintid)constantreturns(boolactive){returnoffers[id].active;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 354,
      "column": 4,
      "content": "functiongetOwner(uintid)constantreturns(addressowner){returnoffers[id].owner;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 358,
      "column": 4,
      "content": "functiongetOffer(uintid)constantreturns(uint,ERC20,uint,ERC20){varoffer=offers[id];return(offer.pay_amt,offer.pay_gem,offer.buy_amt,offer.buy_gem);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 366,
      "column": 4,
      "content": "functionbump(bytes32id_)can_buy(uint256(id_)){varid=uint256(id_);LogBump(id_,sha3(offers[id].pay_gem,offers[id].buy_gem),offers[id].owner,offers[id].pay_gem,offers[id].buy_gem,uint128(offers[id].pay_amt),uint128(offers[id].buy_amt),offers[id].timestamp);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 384,
      "column": 4,
      "content": "functionbuy(uintid,uintquantity)can_buy(id)synchronizedreturns(bool){OfferInfomemoryoffer=offers[id];uintspend=mul(quantity,offer.buy_amt)/offer.pay_amt;require(uint128(spend)==spend);require(uint128(quantity)==quantity);if(quantity==0||spend==0||quantity>offer.pay_amt||spend>offer.buy_amt){returnfalse;}offers[id].pay_amt=sub(offer.pay_amt,quantity);offers[id].buy_amt=sub(offer.buy_amt,spend);assert(offer.buy_gem.transferFrom(msg.sender,offer.owner,spend));assert(offer.pay_gem.transfer(msg.sender,quantity));LogItemUpdate(id);LogTake(bytes32(id),sha3(offer.pay_gem,offer.buy_gem),offer.owner,offer.pay_gem,offer.buy_gem,msg.sender,uint128(quantity),uint128(spend),uint64(now));LogTrade(quantity,offer.pay_gem,spend,offer.buy_gem);if(offers[id].pay_amt==0){deleteoffers[id];}returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 429,
      "column": 4,
      "content": "functioncancel(uintid)can_cancel(id)synchronizedreturns(boolsuccess){OfferInfomemoryoffer=offers[id];deleteoffers[id];assert(offer.pay_gem.transfer(offer.owner,offer.pay_amt));LogItemUpdate(id);LogKill(bytes32(id),sha3(offer.pay_gem,offer.buy_gem),offer.owner,offer.pay_gem,offer.buy_gem,uint128(offer.pay_amt),uint128(offer.buy_amt),uint64(now));success=true;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 455,
      "column": 4,
      "content": "functionkill(bytes32id){assert(cancel(uint256(id)));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 459,
      "column": 4,
      "content": "functionmake(ERC20pay_gem,ERC20buy_gem,uint128pay_amt,uint128buy_amt)returns(bytes32id){returnbytes32(offer(pay_amt,pay_gem,buy_amt,buy_gem));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 469,
      "column": 4,
      "content": "functionoffer(uintpay_amt,ERC20pay_gem,uintbuy_amt,ERC20buy_gem)can_offersynchronizedreturns(uintid){require(uint128(pay_amt)==pay_amt);require(uint128(buy_amt)==buy_amt);require(pay_amt>0);require(pay_gem!=ERC20(0x0));require(buy_amt>0);require(buy_gem!=ERC20(0x0));require(pay_gem!=buy_gem);OfferInfomemoryinfo;info.pay_amt=pay_amt;info.pay_gem=pay_gem;info.buy_amt=buy_amt;info.buy_gem=buy_gem;info.owner=msg.sender;info.active=true;info.timestamp=uint64(now);id=_next_id();offers[id]=info;assert(pay_gem.transferFrom(msg.sender,this,pay_amt));LogItemUpdate(id);LogMake(bytes32(id),sha3(pay_gem,buy_gem),msg.sender,pay_gem,buy_gem,uint128(pay_amt),uint128(buy_amt),uint64(now));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 508,
      "column": 4,
      "content": "functiontake(bytes32id,uint128maxTakeAmount){assert(buy(uint256(id),maxTakeAmount));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 543,
      "column": 4,
      "content": "functionExpiringMarket(uint64_close_time){close_time=_close_time;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 547,
      "column": 4,
      "content": "functionisClosed()constantreturns(boolclosed){returnstopped||getTime()>close_time;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 551,
      "column": 4,
      "content": "functiongetTime()returns(uint64){returnuint64(now);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 555,
      "column": 4,
      "content": "functionstop()auth{stopped=true;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 592,
      "column": 4,
      "content": "functionMatchingMarket(uint64close_time)ExpiringMarket(close_time){}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 597,
      "column": 4,
      "content": "functionmake(ERC20pay_gem,ERC20buy_gem,uint128pay_amt,uint128buy_amt)returns(bytes32){returnbytes32(offer(pay_amt,pay_gem,buy_amt,buy_gem));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 607,
      "column": 4,
      "content": "functiontake(bytes32id,uint128maxTakeAmount){assert(buy(uint256(id),maxTakeAmount));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 611,
      "column": 4,
      "content": "functionkill(bytes32id){assert(cancel(uint256(id)));}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 629,
      "column": 4,
      "content": "functionoffer(uintpay_amt,ERC20pay_gem,uintbuy_amt,ERC20buy_gem)isWhitelist(pay_gem,buy_gem)returns(uint){varfn=matchingEnabled?_offeru:super.offer;returnfn(pay_amt,pay_gem,buy_amt,buy_gem);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 644,
      "column": 4,
      "content": "functionoffer(uintpay_amt,ERC20pay_gem,uintbuy_amt,ERC20buy_gem,uintpos)isWhitelist(pay_gem,buy_gem)can_offerreturns(uint){returnoffer(pay_amt,pay_gem,buy_amt,buy_gem,pos,false);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 659,
      "column": 4,
      "content": "functionoffer(uintpay_amt,ERC20pay_gem,uintbuy_amt,ERC20buy_gem,uintpos,boolrounding)isWhitelist(pay_gem,buy_gem)can_offerreturns(uint){require(_dust[pay_gem]<=pay_amt);if(matchingEnabled){return_matcho(pay_amt,pay_gem,buy_amt,buy_gem,pos,rounding);}returnsuper.offer(pay_amt,pay_gem,buy_amt,buy_gem);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 681,
      "column": 4,
      "content": "functionbuy(uintid,uintamount)can_buy(id)returns(bool){varfn=matchingEnabled?_buys:super.buy;returnfn(id,amount);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 691,
      "column": 4,
      "content": "functioncancel(uintid)can_cancel(id)returns(boolsuccess){if(matchingEnabled){if(isOfferSorted(id)){assert(_unsort(id));}else{assert(_hide(id));}}returnsuper.cancel(id);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 708,
      "column": 4,
      "content": "functioninsert(uintid,uintpos)returns(bool){addressbuy_gem=address(offers[id].buy_gem);addresspay_gem=address(offers[id].pay_gem);require(!isOfferSorted(id));require(isActive(id));require(pos==0||isActive(pos));require(_hide(id));_sort(id,pos);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 782,
      "column": 4,
      "content": "functionsetMinSell(ERC20pay_gem,uintdust)authnotereturns(bool){_dust[pay_gem]=dust;LogMinSell(pay_gem,dust);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 796,
      "column": 4,
      "content": "functiongetMinSell(ERC20pay_gem)constantreturns(uint){return_dust[pay_gem];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 805,
      "column": 4,
      "content": "functionsetBuyEnabled(boolbuyEnabled_)authreturns(bool){buyEnabled=buyEnabled_;LogBuyEnabled(buyEnabled);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 818,
      "column": 4,
      "content": "functionsetMatchingEnabled(boolmatchingEnabled_)authreturns(bool){matchingEnabled=matchingEnabled_;LogMatchingEnabled(matchingEnabled);returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 827,
      "column": 4,
      "content": "functiongetBestOffer(ERC20sell_gem,ERC20buy_gem)constantreturns(uint){return_best[sell_gem][buy_gem];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 834,
      "column": 4,
      "content": "functiongetWorseOffer(uintid)constantreturns(uint){return_rank[id].prev;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 841,
      "column": 4,
      "content": "functiongetBetterOffer(uintid)constantreturns(uint){return_rank[id].next;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 846,
      "column": 4,
      "content": "functiongetOfferCount(ERC20sell_gem,ERC20buy_gem)constantreturns(uint){return_span[sell_gem][buy_gem];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 855,
      "column": 4,
      "content": "functiongetFirstUnsortedOffer()constantreturns(uint){return_head;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 861,
      "column": 4,
      "content": "functiongetNextUnsortedOffer(uintid)constantreturns(uint){return_near[id];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 865,
      "column": 4,
      "content": "functionisOfferSorted(uintid)constantreturns(bool){addressbuy_gem=address(offers[id].buy_gem);addresspay_gem=address(offers[id].pay_gem);return(_rank[id].next!=0||_rank[id].prev!=0||_best[pay_gem][buy_gem]==id)?true:false;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 91,
      "column": 4,
      "content": "uint128constantWAD=10**18;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 120,
      "column": 4,
      "content": "uint128constantRAY=10**27;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 316,
      "column": 4,
      "content": "boollocked;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 584,
      "column": 4,
      "content": "uint_head;"
    }
  ]
}