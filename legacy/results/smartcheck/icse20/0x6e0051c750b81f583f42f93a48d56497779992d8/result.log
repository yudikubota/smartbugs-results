/unique_contracts/0x6e0051c750b81f583f42f93a48d56497779992d8.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 742
column: 27
content: 0x5b5e139f

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 743
column: 27
content: 0x6466353c

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 744
column: 27
content: 0x780e9d63

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 513
column: 8
content: approved[id]=address(0)

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 581
column: 17
content: (msg.sender,address(0),id)

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: a91b18
severity: 1
line: 664
column: 24
content: (address(0),to,ids[i])

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 139
column: 8
content: mythic.length=0

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 140
column: 8
content: legendary.length=0

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 141
column: 8
content: epic.length=0

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 142
column: 8
content: rare.length=0

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 143
column: 8
content: common.length=0

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 712
column: 8
content: ownedTokens[from].length--

ruleId: SOLIDITY_DIV_MUL
patternId: 09hhh1
severity: 2
line: 1160
column: 19
content: (base-(((20-numDays)*base)/100))*packCount

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 191
column: 8
content: for(uinti=0;i<externalIDs.length;i++){ProtoCardmemorycard=ProtoCard({exists:true,god:gods[i],season:currentSeason,cardType:cardTypes[i],rarity:rarities[i],mana:manas[i],attack:attacks[i],health:healths[i],tribe:tribes[i]});_addProto(externalIDs[i],card,packable[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 350
column: 12
content: for(uinti=0;i<mythic.length;i++){id=mythic[(random+i)%mythic.length];(limit,set)=getLimit(id);if(set&&limit>0){returnid;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 536
column: 8
content: for(uinti=0;i<ids.length;i++){transfer(to,ids[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 547
column: 8
content: for(uinti=0;i<ids.length;i++){if(!owns(proposed,ids[i])){returnfalse;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 588
column: 8
content: for(uinti=0;i<ids.length;i++){burn(ids[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 609
column: 8
content: for(uinti=0;i<ids.length;i++){approve(to,ids[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 663
column: 8
content: for(uinti=0;i<ids.length;i++){transferFrom(address(0),to,ids[i]);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 793
column: 8
content: for(uinti=0;i<packs.length;i++){if(msg.sender==address(packs[i])){returntrue;}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 187
column: 4
content: functionaddProtos(uint16[]externalIDs,uint8[]gods,Rarity[]rarities,uint8[]manas,uint8[]attacks,uint8[]healths,uint8[]cardTypes,uint8[]tribes,bool[]packable)publiconlyGovernorreturns(uint16){for(uinti=0;i<externalIDs.length;i++){ProtoCardmemorycard=ProtoCard({exists:true,god:gods[i],season:currentSeason,cardType:cardTypes[i],rarity:rarities[i],mana:manas[i],attack:attacks[i],health:healths[i],tribe:tribes[i]});_addProto(externalIDs[i],card,packable[i]);}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 210
column: 4
content: functionaddProto(uint16externalID,uint8god,Rarityrarity,uint8mana,uint8attack,uint8health,uint8cardType,uint8tribe,boolpackable)publiconlyGovernorreturns(uint16){ProtoCardmemorycard=ProtoCard({exists:true,god:god,season:currentSeason,cardType:cardType,rarity:rarity,mana:mana,attack:attack,health:health,tribe:tribe});_addProto(externalID,card,packable);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 228
column: 4
content: functionaddWeapon(uint16externalID,uint8god,Rarityrarity,uint8mana,uint8attack,uint8durability,boolpackable)publiconlyGovernorreturns(uint16){ProtoCardmemorycard=ProtoCard({exists:true,god:god,season:currentSeason,cardType:WEAPON,rarity:rarity,mana:mana,attack:attack,health:durability,tribe:0});_addProto(externalID,card,packable);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 247
column: 4
content: functionaddSpell(uint16externalID,uint8god,Rarityrarity,uint8mana,boolpackable)publiconlyGovernorreturns(uint16){ProtoCardmemorycard=ProtoCard({exists:true,god:god,season:currentSeason,cardType:SPELL,rarity:rarity,mana:mana,attack:0,health:0,tribe:0});_addProto(externalID,card,packable);}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 264
column: 4
content: functionaddMinion(uint16externalID,uint8god,Rarityrarity,uint8mana,uint8attack,uint8health,uint8tribe,boolpackable)publiconlyGovernorreturns(uint16){ProtoCardmemorycard=ProtoCard({exists:true,god:god,season:currentSeason,cardType:MINION,rarity:rarity,mana:mana,attack:attack,health:health,tribe:tribe});_addProto(externalID,card,packable);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 191
column: 8
content: for(uinti=0;i<externalIDs.length;i++){ProtoCardmemorycard=ProtoCard({exists:true,god:gods[i],season:currentSeason,cardType:cardTypes[i],rarity:rarities[i],mana:manas[i],attack:attacks[i],health:healths[i],tribe:tribes[i]});_addProto(externalIDs[i],card,packable[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 350
column: 12
content: for(uinti=0;i<mythic.length;i++){id=mythic[(random+i)%mythic.length];(limit,set)=getLimit(id);if(set&&limit>0){returnid;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 536
column: 8
content: for(uinti=0;i<ids.length;i++){transfer(to,ids[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 547
column: 8
content: for(uinti=0;i<ids.length;i++){if(!owns(proposed,ids[i])){returnfalse;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 588
column: 8
content: for(uinti=0;i<ids.length;i++){burn(ids[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 609
column: 8
content: for(uinti=0;i<ids.length;i++){approve(to,ids[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 663
column: 8
content: for(uinti=0;i<ids.length;i++){transferFrom(address(0),to,ids[i]);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 793
column: 8
content: for(uinti=0;i<packs.length;i++){if(msg.sender==address(packs[i])){returntrue;}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 434
column: 0
content: contractERC721{eventTransfer(addressindexed_from,addressindexed_to,uint256_tokenId);eventApproval(addressindexed_owner,addressindexed_approved,uint256_tokenId);eventApprovalForAll(addressindexed_owner,addressindexed_operator,bool_approved);functionbalanceOf(address_owner)publicviewreturns(uint256_balance);functionownerOf(uint256_tokenId)publicviewreturns(address_owner);functionsafeTransferFrom(address_from,address_to,uint256_tokenId,bytesdata)publicpayable;functionsafeTransferFrom(address_from,address_to,uint256_tokenId)publicpayable;functiontransfer(address_to,uint256_tokenId)publicpayable;functiontransferFrom(address_from,address_to,uint256_tokenId)publicpayable;functionapprove(address_to,uint256_tokenId)publicpayable;functionsetApprovalForAll(address_to,bool_approved)public;functiongetApproved(uint256_tokenId)publicviewreturns(address);functionisApprovedForAll(address_owner,address_operator)publicviewreturns(bool);}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 860
column: 0
content: contractCardPack{CardIntegrationpublicintegration;uintpubliccreationBlock;constructor(CardIntegration_integration)publicpayable{integration=_integration;creationBlock=block.number;}eventReferral(addressindexedreferrer,uintvalue,addresspurchaser);functionpurchase(uint16packCount,addressreferrer)publicpayable;function_getPurity(uint16randOne,uint16randTwo)internalpurereturns(uint16){if(randOne>=998){return3000+randTwo;}elseif(randOne>=988){return2000+randTwo;}elseif(randOne>=938){return1000+randTwo;}else{returnrandTwo;}}}

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 1234
column: 0
content: contractEpicPackisPresalePack{constructor(CardIntegrationintegration,CappedVault_vault)publicpayablePresalePack(integration,_vault){}functionbasePrice()publicreturns(uint){return300finney;}functiongetCardDetails(uint16packIndex,uint8cardIndex,uintresult)publicviewreturns(uint16proto,uint16purity){uintrandom;uint32rarityRandom;uint16protoRandom;uint16purityOne;uint16purityTwo;CardProto.Rarityrarity;(random,rarityRandom,purityOne,purityTwo,protoRandom)=getComponents(packIndex,cardIndex,result);if(cardIndex==4){rarity=_getEpicPlusRarity(rarityRandom);}else{rarity=_getCommonPlusRarity(rarityRandom);}purity=_getPurity(purityOne,purityTwo);proto=integration.getRandomCard(rarity,protoRandom);return(proto,purity);}}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 900
column: 3
content: functionsetOwner(address_owner)publiconlyOwner{owner=_owner;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 1211
column: 4
content: functionsetCanClaim(boolclaim)publiconlyOwner{canClaim=claim;}

ruleId: SOLIDITY_SHOULD_NOT_BE_VIEW
patternId: 189abf
severity: 1
line: 719
column: 4
content: function_isContract(addresstest)internalviewreturns(bool){uintsize;assembly{size:=extcodesize(test)}return(size>0);}

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 1217
column: 23
content: (uintrandom,uint32rarityRandom,uint16purityOne,uint16purityTwo,uint16protoRandom)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 913
column: 15
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 91h3sa
severity: 1
line: 940
column: 16
content: public

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 8
content: uint16[]externalIDs

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 30
content: uint8[]gods

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 44
content: Rarity[]rarities

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 63
content: uint8[]manas

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 78
content: uint8[]attacks

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 95
content: uint8[]healths

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 112
content: uint8[]cardTypes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 131
content: uint8[]tribes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 188
column: 147
content: bool[]packable

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 441
column: 76
content: bytesdata

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 477
column: 41
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 484
column: 43
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 535
column: 37
content: uint[]ids

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 546
column: 39
content: uint[]ids

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 587
column: 21
content: uint[]ids

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 608
column: 36
content: uint[]ids

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 662
column: 41
content: uint[]ids

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 687
column: 65
content: bytesdata

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 727
column: 52
content: string

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 752
column: 63
content: uint40[]

ruleId: SOLIDITY_VISIBILITY
patternId: 23rt6g
severity: 1
line: 405
column: 27
content: public

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 154
column: 4
content: uint8constantSPELL=1;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 155
column: 4
content: uint8constantMINION=2;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 156
column: 4
content: uint8constantWEAPON=3;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 157
column: 4
content: uint8constantHERO=4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 179
column: 4
content: mapping(uint16=>ProtoCard)protos;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 459
column: 4
content: mapping(uint=>address)owners;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 460
column: 4
content: mapping(uint=>address)approved;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 462
column: 4
content: mapping(address=>mapping(address=>bool))operators;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 467
column: 4
content: mapping(uint=>string)uris;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 470
column: 4
content: uint24[]indices;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 685
column: 4
content: bytes4constantmagic=bytes4(keccak256("onERC721Received(address,uint256,bytes)"));

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 779
column: 4
content: CardPack[]packs;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 934
column: 4
content: uintwithdrawn=0;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 1002
column: 4
content: Purchase[]purchases;

SOLIDITY_VISIBILITY :15
SOLIDITY_OVERPOWERED_ROLE :2
SOLIDITY_ARRAY_LENGTH_MANIPULATION :6
SOLIDITY_LOCKED_MONEY :3
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :5
SOLIDITY_EXTRA_GAS_IN_LOOPS :8
SOLIDITY_ADDRESS_HARDCODED :6
SOLIDITY_UPGRADE_TO_050 :22
SOLIDITY_GAS_LIMIT_IN_LOOPS :8
SOLIDITY_DIV_MUL :1
SOLIDITY_SHOULD_RETURN_STRUCT :1
SOLIDITY_SHOULD_NOT_BE_VIEW :1