{
  "contract": "0x502fa71c990d5447325d0a8b3f96a95a199f3053",
  "tool": "smartcheck",
  "start": 1563715847.3426936,
  "end": 1563715860.6270695,
  "duration": 13.2843759059906,
  "analysis": [
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 183,
      "column": 43,
      "content": "referrerAddress=address(0)"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 202,
      "column": 43,
      "content": "referrerAddress=address(0)"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 214,
      "column": 8,
      "content": "tokens[address(0)]"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 214,
      "column": 49,
      "content": "tokens[address(0)]"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 239,
      "column": 8,
      "content": "tokens[address(0)]"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 241,
      "column": 8,
      "content": "tokens[address(0)]"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 241,
      "column": 49,
      "content": "tokens[address(0)]"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 551,
      "column": 8,
      "content": "tokens[address(0)]"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 551,
      "column": 57,
      "content": "tokens[address(0)]"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "c67a09",
      "severity": 1,
      "line": 184,
      "column": 44,
      "content": "0x0"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "c67a09",
      "severity": 1,
      "line": 185,
      "column": 43,
      "content": "0x0"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "c67a09",
      "severity": 1,
      "line": 203,
      "column": 44,
      "content": "0x0"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "c67a09",
      "severity": 1,
      "line": 204,
      "column": 43,
      "content": "0x0"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "c67a09",
      "severity": 1,
      "line": 239,
      "column": 58,
      "content": "0x0"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "c67a09",
      "severity": 1,
      "line": 386,
      "column": 40,
      "content": "0x0"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "c67a09",
      "severity": 1,
      "line": 387,
      "column": 40,
      "content": "0x0"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 41,
      "column": 24,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 75,
      "column": 40,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 134,
      "column": 30,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 173,
      "column": 56,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 178,
      "column": 8,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 197,
      "column": 66,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 220,
      "column": 96,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 221,
      "column": 48,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 224,
      "column": 42,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 226,
      "column": 60,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 233,
      "column": 29,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 235,
      "column": 93,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 237,
      "column": 42,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 245,
      "column": 36,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "49bd2a",
      "severity": 1,
      "line": 247,
      "column": 54,
      "content": "throw"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 35,
      "column": 4,
      "content": "functionisTokenInList(addresstokenAddress)publicconstantreturns(bool);"
    },
    {
      "name": "SOLIDITY_DEPRECATED_CONSTRUCTIONS",
      "patternId": "28fa69",
      "severity": 1,
      "line": 253,
      "column": 4,
      "content": "functionbalanceOf(addresstoken,addressuser)constantreturns(uint256){returntokens[token][user];}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 485,
      "column": 8,
      "content": "for(uinti=0;i<tradeAddresses.length;i++){trade(v[i],rs[i],tradeValues[i],tradeAddresses[i]);}"
    },
    {
      "name": "SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN",
      "patternId": "58bdd3",
      "severity": 1,
      "line": 219,
      "column": 4,
      "content": "functionwithdraw(addresstoken,uint256amount)returns(boolsuccess){if(safeSub(block.number,lastActiveTransaction[msg.sender])<inactivityReleasePeriod)throw;if(tokens[token][msg.sender]<amount)throw;tokens[token][msg.sender]=safeSub(tokens[token][msg.sender],amount);if(token==address(0)){if(!msg.sender.send(amount))throw;}else{if(!Token(token).transfer(msg.sender,amount))throw;}Withdraw(token,msg.sender,amount,tokens[token][msg.sender],0);}"
    },
    {
      "name": "SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN",
      "patternId": "58bdd3",
      "severity": 1,
      "line": 231,
      "column": 4,
      "content": "functionadminWithdraw(addresstoken,uint256amount,addressuser,uint256nonce,uint8v,bytes32r,bytes32s,uint256feeWithdrawal)onlyAdminreturns(boolsuccess){bytes32hash=keccak256(this,token,amount,user,nonce);if(withdrawn[hash])throw;withdrawn[hash]=true;if(ecrecover(keccak256(\"\\x19Ethereum Signed Message:\\n32\",hash),v,r,s)!=user)throw;if(feeWithdrawal>50finney)feeWithdrawal=50finney;if(tokens[token][user]<amount)throw;tokens[token][user]=safeSub(tokens[token][user],amount);tokens[address(0)][user]=safeSub(tokens[address(0x0)][user],feeWithdrawal);tokens[address(0)][feeAccount]=safeAdd(tokens[address(0)][feeAccount],feeWithdrawal);if(token==address(0)){if(!user.send(amount))throw;}else{if(!Token(token).transfer(user,amount))throw;}lastActiveTransaction[user]=block.number;Withdraw(token,user,amount,tokens[token][user],feeWithdrawal);}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 485,
      "column": 8,
      "content": "for(uinti=0;i<tradeAddresses.length;i++){trade(v[i],rs[i],tradeValues[i],tradeAddresses[i]);}"
    },
    {
      "name": "SOLIDITY_OVERPOWERED_ROLE",
      "patternId": "j83hf7",
      "severity": 2,
      "line": 67,
      "column": 4,
      "content": "functionsetOwner(addressnewOwner)onlyOwner{SetOwner(owner,newOwner);owner=newOwner;}"
    },
    {
      "name": "SOLIDITY_OVERPOWERED_ROLE",
      "patternId": "j83hf7",
      "severity": 2,
      "line": 156,
      "column": 4,
      "content": "functionsetFees(uint256makerFee_,uint256takerFee_,uint256affiliateFee_)onlyOwner{require(makerFee_<10finney&&takerFee_<10finney);require(affiliateFee_>affiliateFee);makerFee=makerFee_;takerFee=takerFee_;affiliateFee=affiliateFee_;makerAffiliateFee=safeMul(makerFee,affiliateFee_)/(1ether);takerAffiliateFee=safeMul(takerFee,affiliateFee_)/(1ether);FeeChange(makerFee,takerFee,affiliateFee_);}"
    },
    {
      "name": "SOLIDITY_OVERPOWERED_ROLE",
      "patternId": "j83hf7",
      "severity": 2,
      "line": 168,
      "column": 4,
      "content": "functionsetAdmin(addressadmin,boolisAdmin)onlyOwner{admins[admin]=isAdmin;}"
    },
    {
      "name": "SOLIDITY_PRAGMAS_VERSION",
      "patternId": "23fc32",
      "severity": 1,
      "line": 1,
      "column": 16,
      "content": "^"
    },
    {
      "name": "SOLIDITY_REDUNDANT_FALLBACK_REJECT",
      "patternId": "b85a32",
      "severity": 1,
      "line": 177,
      "column": 24,
      "content": "{throw;}"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 41,
      "column": 8,
      "content": "if(!assertion)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 75,
      "column": 8,
      "content": "if(nonce<invalidOrder[user])throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 134,
      "column": 8,
      "content": "if(expiry>1000000)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 173,
      "column": 8,
      "content": "if(msg.sender!=owner&&!admins[msg.sender])throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 197,
      "column": 8,
      "content": "if(!Token(token).transferFrom(msg.sender,this,amount))throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 220,
      "column": 8,
      "content": "if(safeSub(block.number,lastActiveTransaction[msg.sender])<inactivityReleasePeriod)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 221,
      "column": 8,
      "content": "if(tokens[token][msg.sender]<amount)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 224,
      "column": 12,
      "content": "if(!msg.sender.send(amount))throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 226,
      "column": 12,
      "content": "if(!Token(token).transfer(msg.sender,amount))throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 233,
      "column": 8,
      "content": "if(withdrawn[hash])throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 235,
      "column": 8,
      "content": "if(ecrecover(keccak256(\"\\x19Ethereum Signed Message:\\n32\",hash),v,r,s)!=user)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 237,
      "column": 8,
      "content": "if(tokens[token][user]<amount)throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 245,
      "column": 12,
      "content": "if(!user.send(amount))throw;"
    },
    {
      "name": "SOLIDITY_REVERT_REQUIRE",
      "patternId": "c56b12",
      "severity": 1,
      "line": 247,
      "column": 12,
      "content": "if(!Token(token).transfer(user,amount))throw;"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 232,
      "column": 23,
      "content": "keccak256(this,token,amount,user,nonce)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 235,
      "column": 22,
      "content": "keccak256(\"\\x19Ethereum Signed Message:\\n32\",hash)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 334,
      "column": 30,
      "content": "keccak256(this,tradeAddresses[0],tradeValues[0],tradeAddresses[1],tradeValues[1],tradeValues[2],tradeAddresses[2])"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 335,
      "column": 30,
      "content": "keccak256(this,tradeAddresses[3],tradeValues[3],tradeAddresses[4],tradeValues[4],tradeValues[5],tradeAddresses[5])"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 340,
      "column": 22,
      "content": "keccak256(\"\\x19Ethereum Signed Message:\\n32\",t.makerOrderHash)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 347,
      "column": 22,
      "content": "keccak256(\"\\x19Ethereum Signed Message:\\n32\",t.takerOrderHash)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 528,
      "column": 28,
      "content": "keccak256(this,cancelAddresses[0],cancelValues[0],cancelAddresses[1],cancelValues[1],cancelValues[2],cancelAddresses[2])"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 532,
      "column": 26,
      "content": "keccak256(\"\\x19Ethereum Signed Message:\\n32\",orderHash)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 535,
      "column": 29,
      "content": "keccak256(this,orderHash,cancelAddresses[3],cancelValues[3])"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "901eae",
      "severity": 1,
      "line": 536,
      "column": 26,
      "content": "keccak256(\"\\x19Ethereum Signed Message:\\n32\",cancelHash)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 31,
      "column": 61,
      "content": "address[]"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 12,
      "column": 4,
      "content": "functiontransfer(address_to,uint256_value)returns(boolsuccess);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 13,
      "column": 4,
      "content": "functionapproveAndCall(address_spender,uint256_value,bytes_extraData)returns(boolsuccess);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 14,
      "column": 4,
      "content": "functionapprove(address_spender,uint256_value)returns(boolsuccess);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 15,
      "column": 4,
      "content": "functiontransferFrom(address_from,address_to,uint256_value)returns(boolsuccess);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 25,
      "column": 4,
      "content": "functionsetOwner(addressnewOwner);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 29,
      "column": 4,
      "content": "functiongetAffiliateCount()returns(uint);"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 40,
      "column": 4,
      "content": "functionassert(boolassertion){if(!assertion)throw;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 43,
      "column": 4,
      "content": "functionsafeMul(uinta,uintb)returns(uint){uintc=a*b;assert(a==0||c/a==b);returnc;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 49,
      "column": 4,
      "content": "functionsafeSub(uinta,uintb)returns(uint){assert(b<=a);returna-b;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 54,
      "column": 4,
      "content": "functionsafeAdd(uinta,uintb)returns(uint){uintc=a+b;assert(c>=a&&c>=b);returnc;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 67,
      "column": 4,
      "content": "functionsetOwner(addressnewOwner)onlyOwner{SetOwner(owner,newOwner);owner=newOwner;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 71,
      "column": 4,
      "content": "functiongetOwner()returns(addressout){returnowner;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 74,
      "column": 4,
      "content": "functioninvalidateOrdersBefore(addressuser,uint256nonce)onlyAdmin{if(nonce<invalidOrder[user])throw;invalidOrder[user]=nonce;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 133,
      "column": 4,
      "content": "functionsetInactivityReleasePeriod(uint256expiry)onlyAdminreturns(boolsuccess){if(expiry>1000000)throw;inactivityReleasePeriod=expiry;returntrue;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 139,
      "column": 4,
      "content": "functionExchange(addressfeeAccount_,uint256makerFee_,uint256takerFee_,uint256affiliateFee_,addressaffiliateContract_,addresstokenListContract_){owner=msg.sender;feeAccount=feeAccount_;inactivityReleasePeriod=100000;makerFee=makerFee_;takerFee=takerFee_;affiliateFee=affiliateFee_;makerAffiliateFee=safeMul(makerFee,affiliateFee_)/(1ether);takerAffiliateFee=safeMul(takerFee,affiliateFee_)/(1ether);affiliateContract=affiliateContract_;tokenListContract=tokenListContract_;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 156,
      "column": 4,
      "content": "functionsetFees(uint256makerFee_,uint256takerFee_,uint256affiliateFee_)onlyOwner{require(makerFee_<10finney&&takerFee_<10finney);require(affiliateFee_>affiliateFee);makerFee=makerFee_;takerFee=takerFee_;affiliateFee=affiliateFee_;makerAffiliateFee=safeMul(makerFee,affiliateFee_)/(1ether);takerAffiliateFee=safeMul(takerFee,affiliateFee_)/(1ether);FeeChange(makerFee,takerFee,affiliateFee_);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 168,
      "column": 4,
      "content": "functionsetAdmin(addressadmin,boolisAdmin)onlyOwner{admins[admin]=isAdmin;}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 181,
      "column": 4,
      "content": "functiondepositToken(addresstoken,uint256amount,addressreferrerAddress){if(referrerAddress==msg.sender)referrerAddress=address(0);if(referrer[msg.sender]==address(0x0)){if(referrerAddress!=address(0x0)&&EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender)==address(0)){referrer[msg.sender]=referrerAddress;EthermiumAffiliates(affiliateContract).assignReferral(referrerAddress,msg.sender);}else{referrer[msg.sender]=EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender);}}tokens[token][msg.sender]=safeAdd(tokens[token][msg.sender],amount);lastActiveTransaction[msg.sender]=block.number;if(!Token(token).transferFrom(msg.sender,this,amount))throw;Deposit(token,msg.sender,amount,tokens[token][msg.sender],referrer[msg.sender]);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 201,
      "column": 4,
      "content": "functiondeposit(addressreferrerAddress)payable{if(referrerAddress==msg.sender)referrerAddress=address(0);if(referrer[msg.sender]==address(0x0)){if(referrerAddress!=address(0x0)&&EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender)==address(0)){referrer[msg.sender]=referrerAddress;EthermiumAffiliates(affiliateContract).assignReferral(referrerAddress,msg.sender);}else{referrer[msg.sender]=EthermiumAffiliates(affiliateContract).getAffiliate(msg.sender);}}tokens[address(0)][msg.sender]=safeAdd(tokens[address(0)][msg.sender],msg.value);lastActiveTransaction[msg.sender]=block.number;Deposit(address(0),msg.sender,msg.value,tokens[address(0)][msg.sender],referrer[msg.sender]);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 219,
      "column": 4,
      "content": "functionwithdraw(addresstoken,uint256amount)returns(boolsuccess){if(safeSub(block.number,lastActiveTransaction[msg.sender])<inactivityReleasePeriod)throw;if(tokens[token][msg.sender]<amount)throw;tokens[token][msg.sender]=safeSub(tokens[token][msg.sender],amount);if(token==address(0)){if(!msg.sender.send(amount))throw;}else{if(!Token(token).transfer(msg.sender,amount))throw;}Withdraw(token,msg.sender,amount,tokens[token][msg.sender],0);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 231,
      "column": 4,
      "content": "functionadminWithdraw(addresstoken,uint256amount,addressuser,uint256nonce,uint8v,bytes32r,bytes32s,uint256feeWithdrawal)onlyAdminreturns(boolsuccess){bytes32hash=keccak256(this,token,amount,user,nonce);if(withdrawn[hash])throw;withdrawn[hash]=true;if(ecrecover(keccak256(\"\\x19Ethereum Signed Message:\\n32\",hash),v,r,s)!=user)throw;if(feeWithdrawal>50finney)feeWithdrawal=50finney;if(tokens[token][user]<amount)throw;tokens[token][user]=safeSub(tokens[token][user],amount);tokens[address(0)][user]=safeSub(tokens[address(0x0)][user],feeWithdrawal);tokens[address(0)][feeAccount]=safeAdd(tokens[address(0)][feeAccount],feeWithdrawal);if(token==address(0)){if(!user.send(amount))throw;}else{if(!Token(token).transfer(user,amount))throw;}lastActiveTransaction[user]=block.number;Withdraw(token,user,amount,tokens[token][user],feeWithdrawal);}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 253,
      "column": 4,
      "content": "functionbalanceOf(addresstoken,addressuser)constantreturns(uint256){returntokens[token][user];}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 290,
      "column": 4,
      "content": "functiontrade(uint8[2]v,bytes32[4]rs,uint256[8]tradeValues,address[6]tradeAddresses)onlyAdminreturns(uintfilledTakerTokenAmount){OrderPairmemoryt=OrderPair({makerAmountBuy:tradeValues[0],makerAmountSell:tradeValues[1],makerNonce:tradeValues[2],takerAmountBuy:tradeValues[3],takerAmountSell:tradeValues[4],takerNonce:tradeValues[5],takerGasFee:tradeValues[6],takerIsBuying:tradeValues[7],makerTokenBuy:tradeAddresses[0],makerTokenSell:tradeAddresses[1],maker:tradeAddresses[2],takerTokenBuy:tradeAddresses[3],takerTokenSell:tradeAddresses[4],taker:tradeAddresses[5],makerOrderHash:keccak256(this,tradeAddresses[0],tradeValues[0],tradeAddresses[1],tradeValues[1],tradeValues[2],tradeAddresses[2]),takerOrderHash:keccak256(this,tradeAddresses[3],tradeValues[3],tradeAddresses[4],tradeValues[4],tradeValues[5],tradeAddresses[5])});if(ecrecover(keccak256(\"\\x19Ethereum Signed Message:\\n32\",t.makerOrderHash),v[0],rs[0],rs[1])!=t.maker){LogError(uint8(Errors.INVLID_SIGNATURE),t.makerOrderHash,t.takerOrderHash);return0;}if(ecrecover(keccak256(\"\\x19Ethereum Signed Message:\\n32\",t.takerOrderHash),v[1],rs[2],rs[3])!=t.taker){LogError(uint8(Errors.INVLID_SIGNATURE),t.makerOrderHash,t.takerOrderHash);return0;}if(t.makerTokenBuy!=t.takerTokenSell||t.makerTokenSell!=t.takerTokenBuy){LogError(uint8(Errors.TOKENS_DONT_MATCH),t.makerOrderHash,t.takerOrderHash);return0;}if(t.takerGasFee>100finney){LogError(uint8(Errors.GAS_TOO_HIGH),t.makerOrderHash,t.takerOrderHash);return0;}if(!((t.takerIsBuying==0&&safeMul(t.makerAmountSell,1ether)/t.makerAmountBuy>=safeMul(t.takerAmountBuy,1ether)/t.takerAmountSell)||(t.takerIsBuying>0&&safeMul(t.makerAmountBuy,1ether)/t.makerAmountSell<=safeMul(t.takerAmountSell,1ether)/t.takerAmountBuy))){LogError(uint8(Errors.INVLID_PRICE),t.makerOrderHash,t.takerOrderHash);return0;}TradeValuesmemorytv=TradeValues({qty:0,invQty:0,makerAmountTaken:0,takerAmountTaken:0,makerReferrer:referrer[t.maker],takerReferrer:referrer[t.taker]});if(tv.makerReferrer==address(0x0))tv.makerReferrer=feeAccount;if(tv.takerReferrer==address(0x0))tv.takerReferrer=feeAccount;if(t.takerIsBuying==0){tv.qty=min(safeSub(t.makerAmountBuy,orderFills[t.makerOrderHash]),safeSub(t.takerAmountSell,safeMul(orderFills[t.takerOrderHash],t.takerAmountSell)/t.takerAmountBuy));if(tv.qty==0){LogError(uint8(Errors.ORDER_ALREADY_FILLED),t.makerOrderHash,t.takerOrderHash);return0;}tv.invQty=safeMul(tv.qty,t.makerAmountSell)/t.makerAmountBuy;tokens[t.makerTokenSell][t.maker]=safeSub(tokens[t.makerTokenSell][t.maker],tv.invQty);tv.makerAmountTaken=safeSub(tv.qty,safeMul(tv.qty,makerFee)/(1ether));tokens[t.makerTokenBuy][t.maker]=safeAdd(tokens[t.makerTokenBuy][t.maker],tv.makerAmountTaken);tokens[t.makerTokenBuy][tv.makerReferrer]=safeAdd(tokens[t.makerTokenBuy][tv.makerReferrer],safeMul(tv.qty,makerAffiliateFee)/(1ether));tokens[t.takerTokenSell][t.taker]=safeSub(tokens[t.takerTokenSell][t.taker],tv.qty);tv.takerAmountTaken=safeSub(safeSub(tv.invQty,safeMul(tv.invQty,takerFee)/(1ether)),safeMul(tv.invQty,t.takerGasFee)/(1ether));tokens[t.takerTokenBuy][t.taker]=safeAdd(tokens[t.takerTokenBuy][t.taker],tv.takerAmountTaken);tokens[t.takerTokenBuy][tv.takerReferrer]=safeAdd(tokens[t.takerTokenBuy][tv.takerReferrer],safeMul(tv.invQty,takerAffiliateFee)/(1ether));tokens[t.makerTokenBuy][feeAccount]=safeAdd(tokens[t.makerTokenBuy][feeAccount],safeMul(tv.qty,safeSub(makerFee,makerAffiliateFee))/(1ether));tokens[t.takerTokenBuy][feeAccount]=safeAdd(tokens[t.takerTokenBuy][feeAccount],safeAdd(safeMul(tv.invQty,safeSub(takerFee,takerAffiliateFee))/(1ether),safeMul(tv.invQty,t.takerGasFee)/(1ether)));orderFills[t.makerOrderHash]=safeAdd(orderFills[t.makerOrderHash],tv.qty);orderFills[t.takerOrderHash]=safeAdd(orderFills[t.takerOrderHash],safeMul(tv.qty,t.takerAmountBuy)/t.takerAmountSell);lastActiveTransaction[t.maker]=block.number;lastActiveTransaction[t.taker]=block.number;Trade(t.takerTokenBuy,tv.qty,t.takerTokenSell,tv.invQty,t.maker,t.taker,makerFee,takerFee,tv.makerAmountTaken,tv.takerAmountTaken,t.makerOrderHash,t.takerOrderHash);returntv.qty;}else{tv.qty=min(safeSub(t.makerAmountSell,safeMul(orderFills[t.makerOrderHash],t.makerAmountSell)/t.makerAmountBuy),safeSub(t.takerAmountBuy,orderFills[t.takerOrderHash]));if(tv.qty==0){LogError(uint8(Errors.ORDER_ALREADY_FILLED),t.makerOrderHash,t.takerOrderHash);return0;}tv.invQty=safeMul(tv.qty,t.makerAmountBuy)/t.makerAmountSell;tokens[t.makerTokenSell][t.maker]=safeSub(tokens[t.makerTokenSell][t.maker],tv.qty);tv.makerAmountTaken=safeSub(tv.invQty,safeMul(tv.invQty,makerFee)/(1ether));tokens[t.makerTokenBuy][t.maker]=safeAdd(tokens[t.makerTokenBuy][t.maker],tv.makerAmountTaken);tokens[t.makerTokenBuy][tv.makerReferrer]=safeAdd(tokens[t.makerTokenBuy][tv.makerReferrer],safeMul(tv.invQty,makerAffiliateFee)/(1ether));tokens[t.takerTokenSell][t.taker]=safeSub(tokens[t.takerTokenSell][t.taker],tv.invQty);tv.takerAmountTaken=safeSub(safeSub(tv.qty,safeMul(tv.qty,takerFee)/(1ether)),safeMul(tv.qty,t.takerGasFee)/(1ether));tokens[t.takerTokenBuy][t.taker]=safeAdd(tokens[t.takerTokenBuy][t.taker],tv.takerAmountTaken);tokens[t.takerTokenBuy][tv.takerReferrer]=safeAdd(tokens[t.takerTokenBuy][tv.takerReferrer],safeMul(tv.qty,takerAffiliateFee)/(1ether));tokens[t.makerTokenBuy][feeAccount]=safeAdd(tokens[t.makerTokenBuy][feeAccount],safeMul(tv.invQty,safeSub(makerFee,makerAffiliateFee))/(1ether));tokens[t.takerTokenBuy][feeAccount]=safeAdd(tokens[t.takerTokenBuy][feeAccount],safeAdd(safeMul(tv.qty,safeSub(takerFee,takerAffiliateFee))/(1ether),safeMul(tv.qty,t.takerGasFee)/(1ether)));orderFills[t.makerOrderHash]=safeAdd(orderFills[t.makerOrderHash],tv.invQty);orderFills[t.takerOrderHash]=safeAdd(orderFills[t.takerOrderHash],tv.qty);lastActiveTransaction[t.maker]=block.number;lastActiveTransaction[t.taker]=block.number;Trade(t.takerTokenBuy,tv.qty,t.takerTokenSell,tv.invQty,t.maker,t.taker,makerFee,takerFee,tv.makerAmountTaken,tv.takerAmountTaken,t.makerOrderHash,t.takerOrderHash);returntv.qty;}}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": 910067,
      "severity": 1,
      "line": 478,
      "column": 4,
      "content": "functionbatchOrderTrade(uint8[2][]v,bytes32[4][]rs,uint256[8][]tradeValues,address[6][]tradeAddresses){for(uinti=0;i<tradeAddresses.length;i++){trade(v[i],rs[i],tradeValues[i],tradeAddresses[i]);}}"
    }
  ]
}