/unique_chucks/9/0x30bda231dbfa0f79b3b3678b2c6d4bae31055ad1.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 3
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 10
column: 18
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 30
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 251
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 254
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 264
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 268
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 271
column: 12
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 17
column: 4
content: functiontotalSupply()constantreturns(uint);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 18
column: 4
content: functionbalanceOf(addresswho)constantreturns(uint);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 19
column: 4
content: functionallowance(addressowner,addressspender)constantreturns(uint);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 74
column: 4
content: functionisActive(uintid)constantreturns(boolactive){returnoffers[id].active;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 77
column: 4
content: functiongetOwner(uintid)constantreturns(addressowner){returnoffers[id].owner;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 80
column: 4
content: functiongetOffer(uintid)constantreturns(uint,ERC20,uint,ERC20){varoffer=offers[id];return(offer.sell_how_much,offer.sell_which_token,offer.buy_how_much,offer.buy_which_token);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 204
column: 4
content: functiongetTime()constantreturns(uint){returnblock.timestamp;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 207
column: 4
content: functionisClosed()constantreturns(boolclosed){return(getTime()>close_time);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 243
column: 4
content: functiontotalSupply()constantreturns(uintsupply){return_supply;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 246
column: 4
content: functionbalanceOf(addresswho)constantreturns(uintvalue){return_balances[who];}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 285
column: 4
content: functionallowance(addressowner,addressspender)constantreturns(uint_allowance){return_approvals[owner][spender];}

ruleId: SOLIDITY_ERC20_APPROVE
patternId: af782c
severity: 2
line: 280
column: 4
content: functionapprove(addressspender,uintvalue)returns(boolok){_approvals[msg.sender][spender]=value;Approval(msg.sender,spender,value);returntrue;}

ruleId: SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA
patternId: 5616b2
severity: 1
line: 8
column: 9
content: private

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 3
column: 8
content: if(!assertion)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 10
column: 8
content: if(lock)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 250
column: 8
content: if(_balances[msg.sender]<value){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 253
column: 8
content: if(!safeToAdd(_balances[to],value)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 263
column: 8
content: if(_balances[from]<value){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 267
column: 8
content: if(_approvals[from][msg.sender]<value){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 270
column: 8
content: if(!safeToAdd(_balances[to],value)){throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 17
column: 4
content: functiontotalSupply()constantreturns(uint);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 18
column: 4
content: functionbalanceOf(addresswho)constantreturns(uint);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 19
column: 4
content: functionallowance(addressowner,addressspender)constantreturns(uint);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 21
column: 4
content: functiontransfer(addressto,uintvalue)returns(boolok);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 22
column: 4
content: functiontransferFrom(addressfrom,addressto,uintvalue)returns(boolok);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 23
column: 4
content: functionapprove(addressspender,uintvalue)returns(boolok);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 29
column: 2
content: function(){throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 74
column: 4
content: functionisActive(uintid)constantreturns(boolactive){returnoffers[id].active;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 77
column: 4
content: functiongetOwner(uintid)constantreturns(addressowner){returnoffers[id].owner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 80
column: 4
content: functiongetOffer(uintid)constantreturns(uint,ERC20,uint,ERC20){varoffer=offers[id];return(offer.sell_how_much,offer.sell_which_token,offer.buy_how_much,offer.buy_which_token);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 111
column: 4
content: functionoffer(uintsell_how_much,ERC20sell_which_token,uintbuy_how_much,ERC20buy_which_token)can_offerexclusivereturns(uintid){assert(sell_how_much>0);assert(sell_which_token!=ERC20(0x0));assert(buy_how_much>0);assert(buy_which_token!=ERC20(0x0));assert(sell_which_token!=buy_which_token);OfferInfomemoryinfo;info.sell_how_much=sell_how_much;info.sell_which_token=sell_which_token;info.buy_how_much=buy_how_much;info.buy_which_token=buy_which_token;info.owner=msg.sender;info.active=true;id=next_id();offers[id]=info;varseller_paid=sell_which_token.transferFrom(msg.sender,this,sell_how_much);assert(seller_paid);ItemUpdate(id);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 140
column: 4
content: functionbuy(uintid,uintquantity)can_buy(id)exclusivereturns(boolsuccess){OfferInfomemoryoffer=offers[id];uintspend=safeMul(quantity,offer.buy_how_much)/offer.sell_how_much;if(spend>offer.buy_how_much||quantity>offer.sell_how_much){success=false;}elseif(spend==offer.buy_how_much&&quantity==offer.sell_how_much){deleteoffers[id];trade(offer.owner,quantity,offer.sell_which_token,msg.sender,spend,offer.buy_which_token);ItemUpdate(id);success=true;}elseif(spend>0&&quantity>0){offers[id].sell_how_much=safeSub(offer.sell_how_much,quantity);offers[id].buy_how_much=safeSub(offer.buy_how_much,spend);trade(offer.owner,quantity,offer.sell_which_token,msg.sender,spend,offer.buy_which_token);ItemUpdate(id);success=true;}else{success=false;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 179
column: 4
content: functioncancel(uintid)can_cancel(id)exclusivereturns(boolsuccess){OfferInfomemoryoffer=offers[id];deleteoffers[id];varseller_refunded=offer.sell_which_token.transfer(offer.owner,offer.sell_how_much);assert(seller_refunded);ItemUpdate(id);success=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 201
column: 4
content: functionExpiringMarket(uintlifetime){close_time=getTime()+lifetime;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 204
column: 4
content: functiongetTime()constantreturns(uint){returnblock.timestamp;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 207
column: 4
content: functionisClosed()constantreturns(boolclosed){return(getTime()>close_time);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 239
column: 4
content: functionERC20Base(uintinitial_balance){_balances[msg.sender]=initial_balance;_supply=initial_balance;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 243
column: 4
content: functiontotalSupply()constantreturns(uintsupply){return_supply;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 246
column: 4
content: functionbalanceOf(addresswho)constantreturns(uintvalue){return_balances[who];}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 249
column: 4
content: functiontransfer(addressto,uintvalue)returns(boolok){if(_balances[msg.sender]<value){throw;}if(!safeToAdd(_balances[to],value)){throw;}_balances[msg.sender]-=value;_balances[to]+=value;Transfer(msg.sender,to,value);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 261
column: 4
content: functiontransferFrom(addressfrom,addressto,uintvalue)returns(boolok){if(_balances[from]<value){throw;}if(_approvals[from][msg.sender]<value){throw;}if(!safeToAdd(_balances[to],value)){throw;}_approvals[from][msg.sender]-=value;_balances[from]-=value;_balances[to]+=value;Transfer(from,to,value);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 280
column: 4
content: functionapprove(addressspender,uintvalue)returns(boolok){_approvals[msg.sender][spender]=value;Approval(msg.sender,spender,value);returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 285
column: 4
content: functionallowance(addressowner,addressspender)constantreturns(uint_allowance){return_approvals[owner][spender];}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 236
column: 4
content: mapping(address=>uint)_balances;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 237
column: 4
content: mapping(address=>mapping(address=>uint))_approvals;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 238
column: 4
content: uint_supply;

SOLIDITY_VISIBILITY :26
SOLIDITY_DEPRECATED_CONSTRUCTIONS :19
SOLIDITY_REVERT_REQUIRE :7
SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA :1
SOLIDITY_ERC20_APPROVE :1