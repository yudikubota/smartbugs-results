/unique_chucks/26/0x30d5f039375a1c6977b32225ad8c9a409d5dd31f.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 289
column: 26
content: 0x1

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: b140cd
severity: 1
line: 291
column: 24
content: 0x1

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: c67a09
severity: 1
line: 621
column: 34
content: 0x0

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 74
column: 16
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 301
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 303
column: 43
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 315
column: 25
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 320
column: 26
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 18
column: 4
content: functioncanCall(addresssrc,addressdst,bytes4sig)constantreturns(bool);

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 109
column: 4
content: functionadd(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x+y)>=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 113
column: 4
content: functionsub(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x-y)<=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 117
column: 4
content: functionmul(uint256x,uint256y)constantinternalreturns(uint256z){assert((z=x*y)>=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 121
column: 4
content: functiondiv(uint256x,uint256y)constantinternalreturns(uint256z){z=x/y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 125
column: 4
content: functionmin(uint256x,uint256y)constantinternalreturns(uint256z){returnx<=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 128
column: 4
content: functionmax(uint256x,uint256y)constantinternalreturns(uint256z){returnx>=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 137
column: 4
content: functionhadd(uint128x,uint128y)constantinternalreturns(uint128z){assert((z=x+y)>=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 141
column: 4
content: functionhsub(uint128x,uint128y)constantinternalreturns(uint128z){assert((z=x-y)<=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 145
column: 4
content: functionhmul(uint128x,uint128y)constantinternalreturns(uint128z){assert((z=x*y)>=x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 149
column: 4
content: functionhdiv(uint128x,uint128y)constantinternalreturns(uint128z){z=x/y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 153
column: 4
content: functionhmin(uint128x,uint128y)constantinternalreturns(uint128z){returnx<=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 156
column: 4
content: functionhmax(uint128x,uint128y)constantinternalreturns(uint128z){returnx>=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 165
column: 4
content: functionimin(int256x,int256y)constantinternalreturns(int256z){returnx<=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 168
column: 4
content: functionimax(int256x,int256y)constantinternalreturns(int256z){returnx>=y?x:y;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 178
column: 4
content: functionwadd(uint128x,uint128y)constantinternalreturns(uint128){returnhadd(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 182
column: 4
content: functionwsub(uint128x,uint128y)constantinternalreturns(uint128){returnhsub(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 186
column: 4
content: functionwmul(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*y+WAD/2)/WAD);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 190
column: 4
content: functionwdiv(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*WAD+y/2)/y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 194
column: 4
content: functionwmin(uint128x,uint128y)constantinternalreturns(uint128){returnhmin(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 197
column: 4
content: functionwmax(uint128x,uint128y)constantinternalreturns(uint128){returnhmax(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 207
column: 4
content: functionradd(uint128x,uint128y)constantinternalreturns(uint128){returnhadd(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 211
column: 4
content: functionrsub(uint128x,uint128y)constantinternalreturns(uint128){returnhsub(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 215
column: 4
content: functionrmul(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*y+RAY/2)/RAY);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 219
column: 4
content: functionrdiv(uint128x,uint128y)constantinternalreturns(uint128z){z=cast((uint256(x)*RAY+y/2)/y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 223
column: 4
content: functionrpow(uint128x,uint64n)constantinternalreturns(uint128z){z=n%2!=0?x:RAY;for(n/=2;n!=0;n/=2){x=rmul(x,x);if(n%2!=0){z=rmul(z,x);}}}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 250
column: 4
content: functionrmin(uint128x,uint128y)constantinternalreturns(uint128){returnhmin(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 253
column: 4
content: functionrmax(uint128x,uint128y)constantinternalreturns(uint128){returnhmax(x,y);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 257
column: 4
content: functioncast(uint256x)constantinternalreturns(uint128z){assert((z=uint128(x))==x);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 269
column: 4
content: functionpeek()constantreturns(bytes32,bool){return(val,has);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 272
column: 4
content: functionread()constantreturns(bytes32){var(wut,has)=peek();assert(has);returnwut;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 340
column: 4
content: functioncompute()constantreturns(bytes32,bool){bytes32[]memorywuts=newbytes32[](uint96(next)-1);uint96ctr=0;for(uint96i=1;i<uint96(next);i++){if(values[bytes12(i)]!=0){var(wut,wuz)=DSValue(values[bytes12(i)]).peek();if(wuz){if(ctr==0||wut>=wuts[ctr-1]){wuts[ctr]=wut;}else{uint96j=0;while(wut>=wuts[j]){j++;}for(uint96k=ctr;k>j;k--){wuts[k]=wuts[k-1];}wuts[j]=wut;}ctr++;}}}if(ctr<min)return(val,false);bytes32value;if(ctr%2==0){uint128val1=uint128(wuts[(ctr/2)-1]);uint128val2=uint128(wuts[ctr/2]);value=bytes32(wdiv(hadd(val1,val2),2ether));}else{value=wuts[(ctr-1)/2];}return(value,true);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 343
column: 8
content: for(uint96i=1;i<uint96(next);i++){if(values[bytes12(i)]!=0){var(wut,wuz)=DSValue(values[bytes12(i)]).peek();if(wuz){if(ctr==0||wut>=wuts[ctr-1]){wuts[ctr]=wut;}else{uint96j=0;while(wut>=wuts[j]){j++;}for(uint96k=ctr;k>j;k--){wuts[k]=wuts[k-1];}wuts[j]=wut;}ctr++;}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 454
column: 8
content: for(uinti=0;i<b.length;i++){number=number+uint(b[i])*(2**(8*(b.length-(i+1))));}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 562
column: 4
content: functionpurchasePackage(uint256_id)publicpayablereturns(boolsuccess){require(started==true);require(packages[_id].isActive==true);require(msg.sender!=owner);require(msg.value==priceOf(packages[_id].price));addressToCoinsPurchased[msg.sender]+=packages[_id].coinsAmount;totalCoinsSold+=packages[_id].coinsAmount;emitLogPurchase(msg.sender,msg.value,packages[_id].packageReference);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 454
column: 8
content: for(uinti=0;i<b.length;i++){number=number+uint(b[i])*(2**(8*(b.length-(i+1))));}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 351
column: 31
content: wut>=wuts[j]

ruleId: SOLIDITY_LOCKED_MONEY
patternId: 30281d
severity: 3
line: 510
column: 0
content: contractChainmonstersShop{usingSafeMathforuint256;addresspublicowner;boolstarted;uint256publictotalCoinsSold;addressmedianizer;uint256shiftValue=100;uint256multiplier=10000;structPackage{uint256price;stringpackageReference;boolisActive;uint256coinsAmount;}eventLogPurchase(address_from,uint256_price,string_packageReference);mapping(address=>uint256)publicaddressToCoinsPurchased;Package[]packages;constructor()public{owner=msg.sender;started=false;}functionstartShop()publiconlyOwner{require(started==false);}functionpauseShop()publiconlyOwner{require(started==true);}functionisStarted()publicviewreturns(boolsuccess){returnstarted;}functionpurchasePackage(uint256_id)publicpayablereturns(boolsuccess){require(started==true);require(packages[_id].isActive==true);require(msg.sender!=owner);require(msg.value==priceOf(packages[_id].price));addressToCoinsPurchased[msg.sender]+=packages[_id].coinsAmount;totalCoinsSold+=packages[_id].coinsAmount;emitLogPurchase(msg.sender,msg.value,packages[_id].packageReference);}functionaddPackage(uint256_price,string_packageReference,bool_isActive,uint256_coinsAmount)externalonlyOwner{require(_price>0);Packagememory_package=Package({price:uint256(_price),packageReference:string(_packageReference),isActive:bool(_isActive),coinsAmount:uint256(_coinsAmount)});uint256newPackageId=packages.push(_package);}functionsetPrice(uint256_packageId,uint256_newPrice)externalonlyOwner{require(packages[_packageId].price>0);packages[_packageId].price=_newPrice;}functiongetPackage(uint256_id)externalviewreturns(uint256priceInETH,uint256priceInUSD,stringpackageReference,uint256coinsAmount){Packagestoragepackage=packages[_id];priceInETH=priceOf(_id);priceInUSD=package.price;packageReference=package.packageReference;coinsAmount=package.coinsAmount;}functionpriceOf(uint256_packageId)publicviewreturns(uint256){if(medianizer==address(0x0)){returnpackages[_packageId].price;}else{uint256USDinWei=ChainmonstersMedianizer(medianizer).getUSDPrice();uint256multValue=(packages[_packageId].price.mul(multiplier)).div(USDinWei.div(1ether));uint256inWei=multValue.mul(1ether);uint256result=inWei.div(shiftValue.mul(multiplier));returnresult;}}functiongetPackagesCount()publicviewreturns(uint256){returnpackages.length;}functionsetMedianizer(ChainmonstersMedianizer_medianizer)publiconlyOwner{require(_medianizer.isMedianizer(),"given address is not a medianizer contract!");medianizer=_medianizer;}modifieronlyOwner{require(msg.sender==owner);_;}}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 592
column: 4
content: functionsetPrice(uint256_packageId,uint256_newPrice)externalonlyOwner{require(packages[_packageId].price>0);packages[_packageId].price=_newPrice;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 644
column: 2
content: functionsetMedianizer(ChainmonstersMedianizer_medianizer)publiconlyOwner{require(_medianizer.isMedianizer(),"given address is not a medianizer contract!");medianizer=_medianizer;}

ruleId: SOLIDITY_PRAGMAS_VERSION
patternId: 23fc32
severity: 1
line: 14
column: 16
content: ^

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 74
column: 8
content: if(!x)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 301
column: 8
content: if(pos==0x0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 303
column: 8
content: if(wat!=0&&indexes[wat]!=0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 315
column: 8
content: if(min_==0x0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 320
column: 8
content: if(next_==0x0)throw;

ruleId: SOLIDITY_SAFEMATH
patternId: 837cac
severity: 1
line: 511
column: 4
content: usingSafeMathforuint256;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 448
column: 57
content: bytes

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 452
column: 25
content: bytesb

ruleId: SOLIDITY_USING_INLINE_ASSEMBLY
patternId: 109cd5
severity: 1
line: 92
column: 8
content: assembly{foo:=calldataload(4)bar:=calldataload(36)}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 18
column: 4
content: functioncanCall(addresssrc,addressdst,bytes4sig)constantreturns(bool);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 32
column: 4
content: functionDSAuth(){owner=msg.sender;LogSetOwner(msg.sender);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 37
column: 4
content: functionsetOwner(addressowner_)auth{owner=owner_;LogSetOwner(owner);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 44
column: 4
content: functionsetAuthority(DSAuthorityauthority_)auth{authority=authority_;LogSetAuthority(authority);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 269
column: 4
content: functionpeek()constantreturns(bytes32,bool){return(val,has);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 272
column: 4
content: functionread()constantreturns(bytes32){var(wut,has)=peek();assert(has);returnwut;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 277
column: 4
content: functionpoke(bytes32wut)noteauth{val=wut;has=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 281
column: 4
content: functionvoid()noteauth{has=false;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 293
column: 4
content: functionset(addresswat)auth{bytes12nextId=bytes12(uint96(next)+1);assert(nextId!=0x0);set(next,wat);next=nextId;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 300
column: 4
content: functionset(bytes12pos,addresswat)noteauth{if(pos==0x0)throw;if(wat!=0&&indexes[wat]!=0)throw;indexes[values[pos]]=0;if(wat!=0){indexes[wat]=pos;}values[pos]=wat;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 314
column: 4
content: functionsetMin(uint96min_)noteauth{if(min_==0x0)throw;min=min_;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 319
column: 4
content: functionsetNext(bytes12next_)noteauth{if(next_==0x0)throw;next=next_;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 324
column: 4
content: functionunset(bytes12pos){set(pos,0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 328
column: 4
content: functionunset(addresswat){set(indexes[wat],0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 332
column: 4
content: functionpoke(){poke(0);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 336
column: 4
content: functionpoke(bytes32)note{(val,has)=compute();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 340
column: 4
content: functioncompute()constantreturns(bytes32,bool){bytes32[]memorywuts=newbytes32[](uint96(next)-1);uint96ctr=0;for(uint96i=1;i<uint96(next);i++){if(values[bytes12(i)]!=0){var(wut,wuz)=DSValue(values[bytes12(i)]).peek();if(wuz){if(ctr==0||wut>=wuts[ctr-1]){wuts[ctr]=wut;}else{uint96j=0;while(wut>=wuts[j]){j++;}for(uint96k=ctr;k>j;k--){wuts[k]=wuts[k-1];}wuts[j]=wut;}ctr++;}}}if(ctr<min)return(val,false);bytes32value;if(ctr%2==0){uint128val1=uint128(wuts[(ctr/2)-1]);uint128val2=uint128(wuts[ctr/2]);value=bytes32(wdiv(hadd(val1,val2),2ether));}else{value=wuts[(ctr-1)/2];}return(value,true);}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 176
column: 4
content: uint128constantWAD=10**18;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 205
column: 4
content: uint128constantRAY=10**27;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 267
column: 4
content: boolhas;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 268
column: 4
content: bytes32val;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 422
column: 4
content: addressmedianizerBase;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 423
column: 4
content: MedianizermakerMed;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 517
column: 4
content: boolstarted;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 521
column: 4
content: addressmedianizer;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 522
column: 4
content: uint256shiftValue=100;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 523
column: 4
content: uint256multiplier=10000;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 540
column: 4
content: Package[]packages;

SOLIDITY_VISIBILITY :28
SOLIDITY_OVERPOWERED_ROLE :2
SOLIDITY_PRAGMAS_VERSION :1
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :1
SOLIDITY_EXTRA_GAS_IN_LOOPS :2
SOLIDITY_ADDRESS_HARDCODED :3
SOLIDITY_UPGRADE_TO_050 :2
SOLIDITY_GAS_LIMIT_IN_LOOPS :2
SOLIDITY_SAFEMATH :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :37
SOLIDITY_REVERT_REQUIRE :5
SOLIDITY_LOCKED_MONEY :1
SOLIDITY_USING_INLINE_ASSEMBLY :1