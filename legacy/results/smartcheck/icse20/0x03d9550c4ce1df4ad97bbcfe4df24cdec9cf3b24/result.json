{
  "contract": "0x03d9550c4ce1df4ad97bbcfe4df24cdec9cf3b24",
  "tool": "smartcheck",
  "start": 1563635018.8527813,
  "end": 1563635040.7211227,
  "duration": 21.86834144592285,
  "analysis": [
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 138,
      "column": 4,
      "content": "owner=address(0)"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 1767,
      "column": 12,
      "content": "(position.owner!=msg.sender)?msg.sender:address(0)"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 1773,
      "column": 12,
      "content": "(position.lender!=loanPayer)?loanPayer:address(0)"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 2788,
      "column": 90,
      "content": "(state,positionId,requestedCloseAmount,payoutRecipient,address(0),true,true)"
    },
    {
      "name": "SOLIDITY_ADDRESS_HARDCODED",
      "patternId": "a91b18",
      "severity": 1,
      "line": 6224,
      "column": 50,
      "content": "(state,positionId,requestedCloseAmount,payoutRecipient,address(0),true,newbytes(0))"
    },
    {
      "name": "SOLIDITY_DIV_MUL",
      "patternId": "09hhh1",
      "severity": 2,
      "line": 1064,
      "column": 20,
      "content": "Xtemp.mul(Xcopy.div(uint128(i)))"
    },
    {
      "name": "SOLIDITY_DIV_MUL",
      "patternId": "09hhh1",
      "severity": 2,
      "line": 1964,
      "column": 22,
      "content": "elapsed.div(period).mul(period)"
    },
    {
      "name": "SOLIDITY_EXACT_TIME",
      "patternId": "1955d9",
      "severity": 2,
      "line": 1670,
      "column": 15,
      "content": "uint256(uint32(block.timestamp))==block.timestamp"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 6879,
      "column": 8,
      "content": "for(i=0;i<trustedMarginCallers.length;i++){TRUSTED_MARGIN_CALLERS[trustedMarginCallers[i]]=true;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 6882,
      "column": 8,
      "content": "for(i=0;i<trustedWithdrawers.length;i++){TRUSTED_WITHDRAWERS[trustedWithdrawers[i]]=true;}"
    },
    {
      "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
      "patternId": "d3j11j",
      "severity": 1,
      "line": 7366,
      "column": 8,
      "content": "for(uint256i=0;i<buckets.length;i++){uint256bucket=buckets[i];if((bucket!=0)&&(bucket==lockedBucket)){continue;}(uint256owedTokenForBucket,uint256heldTokenForBucket)=withdrawSingleBucket(onBehalfOf,bucket,maxWeights[i],maxHeldToken);results[0]=results[0].add(owedTokenForBucket);results[1]=results[1].add(heldTokenForBucket);}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 6879,
      "column": 8,
      "content": "for(i=0;i<trustedMarginCallers.length;i++){TRUSTED_MARGIN_CALLERS[trustedMarginCallers[i]]=true;}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 6882,
      "column": 8,
      "content": "for(i=0;i<trustedWithdrawers.length;i++){TRUSTED_WITHDRAWERS[trustedWithdrawers[i]]=true;}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "f6f853",
      "severity": 2,
      "line": 7366,
      "column": 8,
      "content": "for(uint256i=0;i<buckets.length;i++){uint256bucket=buckets[i];if((bucket!=0)&&(bucket==lockedBucket)){continue;}(uint256owedTokenForBucket,uint256heldTokenForBucket)=withdrawSingleBucket(onBehalfOf,bucket,maxWeights[i],maxHeldToken);results[0]=results[0].add(owedTokenForBucket);results[1]=results[1].add(heldTokenForBucket);}"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 983,
      "column": 15,
      "content": "integerX>=NUM_PRECOMPUTED_INTEGERS"
    },
    {
      "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
      "patternId": "17f23a",
      "severity": 1,
      "line": 1303,
      "column": 15,
      "content": "first<last"
    },
    {
      "name": "SOLIDITY_OVERPOWERED_ROLE",
      "patternId": "j83hf7",
      "severity": 2,
      "line": 4798,
      "column": 4,
      "content": "functionsetOperationState(uint8newState)externalonlyOwner{require(newState<OPERATION_STATE_INVALID,\"MarginAdmin#setOperationState: newState is not a valid operation state\");if(newState!=operationState){emitOperationStateChanged(operationState,newState);operationState=newState;}}"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 679,
      "column": 12,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 3167,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 3168,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 3169,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 3170,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 3173,
      "column": 19,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 3176,
      "column": 19,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 4724,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 4728,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 4732,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 4735,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
      "patternId": "5616b2",
      "severity": 1,
      "line": 4738,
      "column": 10,
      "content": "private"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 205,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 436,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 512,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 745,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 746,
      "column": 4,
      "content": "usingSafeMathforuint128;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 929,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 1196,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 1326,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 1687,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 2137,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 2538,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 2758,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 2879,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 3046,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 3314,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 3804,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 4444,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 4963,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 5425,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 5927,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SAFEMATH",
      "patternId": "837cac",
      "severity": 1,
      "line": 6704,
      "column": 4,
      "content": "usingSafeMathforuint256;"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_PURE",
      "patternId": "11314f",
      "severity": 1,
      "line": 392,
      "column": 4,
      "content": "functioncheckSuccess()privatepurereturns(bool){uint256returnValue=0;assembly{switchreturndatasizecase0x0{returnValue:=1}case0x20{returndatacopy(0x0,0x0,0x20)returnValue:=mload(0x0)}default{}}returnreturnValue!=0;}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_PURE",
      "patternId": "11314f",
      "severity": 1,
      "line": 3185,
      "column": 4,
      "content": "functionrecover(bytes32hash,bytessignatureWithType)internalpurereturns(address){require(signatureWithType.length==66,\"SignatureValidator#validateSignature: invalid signature length\");uint8sigType=uint8(signatureWithType[0]);require(sigType>uint8(SIGTYPE_INVALID),\"SignatureValidator#validateSignature: invalid signature type\");require(sigType<uint8(SIGTYPE_UNSUPPORTED),\"SignatureValidator#validateSignature: unsupported signature type\");uint8v=uint8(signatureWithType[1]);bytes32r;bytes32s;assembly{r:=mload(add(signatureWithType,34))s:=mload(add(signatureWithType,66))}bytes32signedHash;if(sigType==SIGTYPE_ECRECOVER_DEC){signedHash=keccak256(abi.encodePacked(PREPEND_DEC,hash));}else{assert(sigType==SIGTYPE_ECRECOVER_HEX);signedHash=keccak256(abi.encodePacked(PREPEND_HEX,hash));}returnecrecover(signedHash,v,r,s);}"
    },
    {
      "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
      "patternId": "189abf",
      "severity": 1,
      "line": 706,
      "column": 2,
      "content": "functionisContract(address_addr)internalviewreturns(bool){uint256size;assembly{size:=extcodesize(_addr)}returnsize>0;}"
    },
    {
      "name": "SOLIDITY_SHOULD_RETURN_STRUCT",
      "patternId": "7d54ca",
      "severity": 1,
      "line": 2620,
      "column": 16,
      "content": "(uint256,uint256)"
    },
    {
      "name": "SOLIDITY_SHOULD_RETURN_STRUCT",
      "patternId": "7d54ca",
      "severity": 1,
      "line": 2676,
      "column": 16,
      "content": "(uint256,uint256)"
    },
    {
      "name": "SOLIDITY_SHOULD_RETURN_STRUCT",
      "patternId": "7d54ca",
      "severity": 1,
      "line": 7675,
      "column": 16,
      "content": "(uint256,uint256)"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 3187,
      "column": 8,
      "content": "bytessignatureWithType"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 3456,
      "column": 8,
      "content": "bytesorderData"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 3581,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 3835,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 3836,
      "column": 8,
      "content": "bytesorderData"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 3941,
      "column": 8,
      "content": "bytesorderData"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 3993,
      "column": 8,
      "content": "bytesorderData"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 4188,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 4230,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 4995,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 4996,
      "column": 8,
      "content": "bytesorderData"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 5034,
      "column": 8,
      "content": "bytesorderData"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 5113,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 5144,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 6535,
      "column": 8,
      "content": "bytessignature"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 6855,
      "column": 8,
      "content": "address[]trustedMarginCallers"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 6856,
      "column": 8,
      "content": "address[]trustedWithdrawers"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 7910,
      "column": 8,
      "content": "address[]trustedMarginCallers"
    },
    {
      "name": "SOLIDITY_UPGRADE_TO_050",
      "patternId": "341gim",
      "severity": 1,
      "line": 7911,
      "column": 8,
      "content": "address[]trustedWithdrawers"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 401,
      "column": 8,
      "content": "assembly{switchreturndatasizecase0x0{returnValue:=1}case0x20{returndatacopy(0x0,0x0,0x20)returnValue:=mload(0x0)}default{}}"
    },
    {
      "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
      "patternId": "109cd5",
      "severity": 1,
      "line": 3214,
      "column": 8,
      "content": "assembly{r:=mload(add(signatureWithType,34))s:=mload(add(signatureWithType,66))}"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1331,
      "column": 4,
      "content": "uint256constantDEFAULT_PRECOMPUTE_PRECISION=11;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1333,
      "column": 4,
      "content": "uint256constantDEFAULT_MACLAURIN_PRECISION=5;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1335,
      "column": 4,
      "content": "uint256constantMAXIMUM_EXPONENT=80;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 1337,
      "column": 4,
      "content": "uint128constantE_TO_MAXIUMUM_EXPONENT=55406223843935100525711733958316613;"
    },
    {
      "name": "SOLIDITY_VISIBILITY",
      "patternId": "b51ce0",
      "severity": 1,
      "line": 4292,
      "column": 4,
      "content": "MarginState.Statestate;"
    }
  ]
}