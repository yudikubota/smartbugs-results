/unique_chucks/18/0x89b3efa63648b65bc2999bbb4f82bfed5f83f178.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 161
column: 8
content: for(uintround=0;round<TOTAL_ROUNDS;round++){for(uintmatchIndex=0;matchIndex<MATCHES_PER_ROUND;matchIndex++){uinthome=(round+matchIndex)%(TEAMS_TOTAL-1);uintaway=(TEAMS_TOTAL-1-matchIndex+round)%(TEAMS_TOTAL-1);if(matchIndex==0){away=TEAMS_TOTAL-1;}Matchmemory_match;_match.homeTeamId=uint8(home);_match.awayTeamId=uint8(away);roundIdToMatches[round].push(_match);}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 162
column: 12
content: for(uintmatchIndex=0;matchIndex<MATCHES_PER_ROUND;matchIndex++){uinthome=(round+matchIndex)%(TEAMS_TOTAL-1);uintaway=(TEAMS_TOTAL-1-matchIndex+round)%(TEAMS_TOTAL-1);if(matchIndex==0){away=TEAMS_TOTAL-1;}Matchmemory_match;_match.homeTeamId=uint8(home);_match.awayTeamId=uint8(away);roundIdToMatches[round].push(_match);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 185
column: 8
content: for(uinti=0;i<prizeStructure.length;i++){allocationTotal+=prizeStructure[i];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 230
column: 8
content: for(uinti=0;i<matches.length;i++){Matchmemory_match=matches[i];var(homeScorers,awayScorers)=calculateScorersForTeamIds(_match.homeTeamId,_match.awayTeamId);updateTeamsTableAttributes(_match.homeTeamId,homeScorers.length,_match.awayTeamId,awayScorers.length);roundIdToMatches[uint(roundId)][i].isFinished=true;roundIdToMatches[uint(roundId)][i].homeScorerIds=homeScorers;roundIdToMatches[uint(roundId)][i].awayScorerIds=awayScorers;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 274
column: 8
content: for(uinti=0;i<matches.length;i++){_homeTeamIds[i]=matches[i].homeTeamId;_awayTeamIds[i]=matches[i].awayTeamId;matchStates[i]=matches[i].isFinished;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 317
column: 8
content: for(uinti=0;i<cardIds.length;i++){cardIdToEntryStatus[cardIds[i]]=true;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 333
column: 8
content: for(uinti=0;i<cardIds.length;i++){uintcardId=cardIds[i];boolhasEnteredCardPreviously=cardIdToEntryStatus[cardId];if(hasEnteredCardPreviously){returntrue;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 380
column: 8
content: for(uinti=0;i<homeScorers.length;i++){homeScorers[i]=determineGoalScoringCardIds(teams[homeTeamId].cardIds,homeCardsShootingAttributes,i);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 385
column: 8
content: for(i=0;i<awayScorers.length;i++){awayScorers[i]=determineGoalScoringCardIds(teams[awayTeamId].cardIds,awayCardsShootingAttributes,i);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 465
column: 8
content: for(uinti=0;i<SQUAD_SIZE;i++){var(overall,pace,shooting,passing,dribbling,defending,physical,,,,)=mainContract.getPlayerForCard(_team.cardIds[i]);if(_team.cardIds[i]==_team.gkCardId&&_team.gkCardId>0){totals[5]+=(overall*5);totals[6]+=overall;cardsShootingAttributes[i]=1;}else{totals[0]+=overall;totals[1]+=pace;totals[2]+=shooting;totals[3]+=passing;totals[4]+=dribbling;totals[5]+=defending;totals[6]+=physical;cardsShootingAttributes[i]=shooting+dribbling;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 505
column: 8
content: for(uinti=0;i<shootingAttributes.length;i++){max+=shootingAttributes[i];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 512
column: 8
content: for(i=0;i<cardIds.length;i++){uintcardId=cardIds[i];randValue-=shootingAttributes[i];if(randValue<=0||randValue>=max){returncardId;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 542
column: 8
content: for(uinti=0;i<teams.length;i++){Teammemory_team=teams[i];uintcurrPoints=(_team.wins*3)+_team.draws;for(uintx=0;x<winningTeamPoints.length;x++){isReplacementWinner=false;if(currPoints>winningTeamPoints[x]){isReplacementWinner=true;}elseif(currPoints==winningTeamPoints[x]){Teammemory_comparisonTeam=teams[winningTeamIds[x]];intgdTeam=_team.goalsFor-_team.goalsAgainst;intgdComparedTeam=_comparisonTeam.goalsFor-_comparisonTeam.goalsAgainst;if(gdTeam>gdComparedTeam){isReplacementWinner=true;}elseif(gdTeam==gdComparedTeam){if(_team.goalsFor>_comparisonTeam.goalsFor){isReplacementWinner=true;}elseif(_team.goalsFor==_comparisonTeam.goalsFor){if(_team.wins>_comparisonTeam.wins){isReplacementWinner=true;}elseif(_team.wins==_comparisonTeam.wins){if(i<winningTeamIds[x]){isReplacementWinner=true;}}}}}if(isReplacementWinner){for(uinty=winningAddresses.length-1;y>x;y--){winningAddresses[y]=winningAddresses[y-1];winningTeamPoints[y]=winningTeamPoints[y-1];winningTeamIds[y]=winningTeamIds[y-1];}winningAddresses[x]=_team.manager;winningTeamPoints[x]=currPoints;winningTeamIds[x]=i;break;}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 549
column: 12
content: for(uintx=0;x<winningTeamPoints.length;x++){isReplacementWinner=false;if(currPoints>winningTeamPoints[x]){isReplacementWinner=true;}elseif(currPoints==winningTeamPoints[x]){Teammemory_comparisonTeam=teams[winningTeamIds[x]];intgdTeam=_team.goalsFor-_team.goalsAgainst;intgdComparedTeam=_comparisonTeam.goalsFor-_comparisonTeam.goalsAgainst;if(gdTeam>gdComparedTeam){isReplacementWinner=true;}elseif(gdTeam==gdComparedTeam){if(_team.goalsFor>_comparisonTeam.goalsFor){isReplacementWinner=true;}elseif(_team.goalsFor==_comparisonTeam.goalsFor){if(_team.wins>_comparisonTeam.wins){isReplacementWinner=true;}elseif(_team.wins==_comparisonTeam.wins){if(i<winningTeamIds[x]){isReplacementWinner=true;}}}}}if(isReplacementWinner){for(uinty=winningAddresses.length-1;y>x;y--){winningAddresses[y]=winningAddresses[y-1];winningTeamPoints[y]=winningTeamPoints[y-1];winningTeamIds[y]=winningTeamIds[y-1];}winningAddresses[x]=_team.manager;winningTeamPoints[x]=currPoints;winningTeamIds[x]=i;break;}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 621
column: 8
content: for(uinti=0;i<winners.length;i++){addresswinner=winners[i];uintpercentageCut=prizeBreakdown[i];uintwinningAmount=calculateWinnerCut(prizePool,percentageCut);winner.transfer(winningAmount);}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 653
column: 8
content: for(uinti=0;i<teams.length;i++){if(teams[i].manager==winners[0]){winningTeamId=i;break;}}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 47
column: 4
content: functionisOwnerOfAllPlayerCards(uint256[],address)publicpurereturns(bool){}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 48
column: 4
content: functionimplementsERC721()publicpurereturns(bool){}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 47acc2
severity: 1
line: 49
column: 4
content: functiongetPlayerForCard(uint)externalpurereturns(uint8,uint8,uint8,uint8,uint8,uint8,uint8,uint8,bytes,string,uint8){}

ruleId: SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN
patternId: 58bdd3
severity: 1
line: 392
column: 4
content: functioncalculateGoalsFromAttributeTotals(uinthomeTeamId,uintawayTeamId,uint[]homeTotals,uint[]awayTotals,uintstartSeed)internalviewreturns(uint_homeGoals,uint_awayGoals){uint[]memoryatkAttributes=newuint[](3);uint[]memorydefAttributes=newuint[](3);uintattackingTeamId=0;uintdefendingTeamId=0;uintoutcome=0;uintseed=startSeed*homeTotals[0]*awayTotals[0];for(uinti=0;i<45;i++){attackingTeamId=determineAttackingOrDefendingOutcomeForAttributes(homeTeamId,awayTeamId,homeTotals[0],awayTotals[0],seed+now);seed++;if(attackingTeamId==homeTeamId){defendingTeamId=awayTeamId;atkAttributes[0]=homeTotals[3];atkAttributes[1]=homeTotals[4];atkAttributes[2]=homeTotals[2];defAttributes[0]=awayTotals[1];defAttributes[1]=awayTotals[6];defAttributes[2]=awayTotals[5];}else{defendingTeamId=homeTeamId;atkAttributes[0]=awayTotals[3];atkAttributes[1]=awayTotals[4];atkAttributes[2]=awayTotals[2];defAttributes[0]=homeTotals[1];defAttributes[1]=homeTotals[6];defAttributes[2]=homeTotals[5];}outcome=determineAttackingOrDefendingOutcomeForAttributes(attackingTeamId,defendingTeamId,atkAttributes[0],defAttributes[0],seed);if(outcome==defendingTeamId){continue;}seed++;outcome=determineAttackingOrDefendingOutcomeForAttributes(attackingTeamId,defendingTeamId,atkAttributes[1],defAttributes[1],seed);if(outcome==defendingTeamId){continue;}seed++;outcome=determineAttackingOrDefendingOutcomeForAttributes(attackingTeamId,defendingTeamId,atkAttributes[2],defAttributes[2],seed);if(outcome==defendingTeamId){continue;}if(attackingTeamId==homeTeamId){_homeGoals+=1;}else{_awayGoals+=1;}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 185
column: 8
content: for(uinti=0;i<prizeStructure.length;i++){allocationTotal+=prizeStructure[i];}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 230
column: 8
content: for(uinti=0;i<matches.length;i++){Matchmemory_match=matches[i];var(homeScorers,awayScorers)=calculateScorersForTeamIds(_match.homeTeamId,_match.awayTeamId);updateTeamsTableAttributes(_match.homeTeamId,homeScorers.length,_match.awayTeamId,awayScorers.length);roundIdToMatches[uint(roundId)][i].isFinished=true;roundIdToMatches[uint(roundId)][i].homeScorerIds=homeScorers;roundIdToMatches[uint(roundId)][i].awayScorerIds=awayScorers;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 274
column: 8
content: for(uinti=0;i<matches.length;i++){_homeTeamIds[i]=matches[i].homeTeamId;_awayTeamIds[i]=matches[i].awayTeamId;matchStates[i]=matches[i].isFinished;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 317
column: 8
content: for(uinti=0;i<cardIds.length;i++){cardIdToEntryStatus[cardIds[i]]=true;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 333
column: 8
content: for(uinti=0;i<cardIds.length;i++){uintcardId=cardIds[i];boolhasEnteredCardPreviously=cardIdToEntryStatus[cardId];if(hasEnteredCardPreviously){returntrue;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 380
column: 8
content: for(uinti=0;i<homeScorers.length;i++){homeScorers[i]=determineGoalScoringCardIds(teams[homeTeamId].cardIds,homeCardsShootingAttributes,i);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 385
column: 8
content: for(i=0;i<awayScorers.length;i++){awayScorers[i]=determineGoalScoringCardIds(teams[awayTeamId].cardIds,awayCardsShootingAttributes,i);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 505
column: 8
content: for(uinti=0;i<shootingAttributes.length;i++){max+=shootingAttributes[i];}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 512
column: 8
content: for(i=0;i<cardIds.length;i++){uintcardId=cardIds[i];randValue-=shootingAttributes[i];if(randValue<=0||randValue>=max){returncardId;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 542
column: 8
content: for(uinti=0;i<teams.length;i++){Teammemory_team=teams[i];uintcurrPoints=(_team.wins*3)+_team.draws;for(uintx=0;x<winningTeamPoints.length;x++){isReplacementWinner=false;if(currPoints>winningTeamPoints[x]){isReplacementWinner=true;}elseif(currPoints==winningTeamPoints[x]){Teammemory_comparisonTeam=teams[winningTeamIds[x]];intgdTeam=_team.goalsFor-_team.goalsAgainst;intgdComparedTeam=_comparisonTeam.goalsFor-_comparisonTeam.goalsAgainst;if(gdTeam>gdComparedTeam){isReplacementWinner=true;}elseif(gdTeam==gdComparedTeam){if(_team.goalsFor>_comparisonTeam.goalsFor){isReplacementWinner=true;}elseif(_team.goalsFor==_comparisonTeam.goalsFor){if(_team.wins>_comparisonTeam.wins){isReplacementWinner=true;}elseif(_team.wins==_comparisonTeam.wins){if(i<winningTeamIds[x]){isReplacementWinner=true;}}}}}if(isReplacementWinner){for(uinty=winningAddresses.length-1;y>x;y--){winningAddresses[y]=winningAddresses[y-1];winningTeamPoints[y]=winningTeamPoints[y-1];winningTeamIds[y]=winningTeamIds[y-1];}winningAddresses[x]=_team.manager;winningTeamPoints[x]=currPoints;winningTeamIds[x]=i;break;}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 549
column: 12
content: for(uintx=0;x<winningTeamPoints.length;x++){isReplacementWinner=false;if(currPoints>winningTeamPoints[x]){isReplacementWinner=true;}elseif(currPoints==winningTeamPoints[x]){Teammemory_comparisonTeam=teams[winningTeamIds[x]];intgdTeam=_team.goalsFor-_team.goalsAgainst;intgdComparedTeam=_comparisonTeam.goalsFor-_comparisonTeam.goalsAgainst;if(gdTeam>gdComparedTeam){isReplacementWinner=true;}elseif(gdTeam==gdComparedTeam){if(_team.goalsFor>_comparisonTeam.goalsFor){isReplacementWinner=true;}elseif(_team.goalsFor==_comparisonTeam.goalsFor){if(_team.wins>_comparisonTeam.wins){isReplacementWinner=true;}elseif(_team.wins==_comparisonTeam.wins){if(i<winningTeamIds[x]){isReplacementWinner=true;}}}}}if(isReplacementWinner){for(uinty=winningAddresses.length-1;y>x;y--){winningAddresses[y]=winningAddresses[y-1];winningTeamPoints[y]=winningTeamPoints[y-1];winningTeamIds[y]=winningTeamIds[y-1];}winningAddresses[x]=_team.manager;winningTeamPoints[x]=currPoints;winningTeamIds[x]=i;break;}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 621
column: 8
content: for(uinti=0;i<winners.length;i++){addresswinner=winners[i];uintpercentageCut=prizeBreakdown[i];uintwinningAmount=calculateWinnerCut(prizePool,percentageCut);winner.transfer(winningAmount);}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 653
column: 8
content: for(uinti=0;i<teams.length;i++){if(teams[i].manager==winners[0]){winningTeamId=i;break;}}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 17
column: 4
content: functionsetOwner(addressnewOwner)publiconlyOwner{require(newOwner!=address(0));owner=newOwner;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 22
column: 4
content: functionsetReferee(addressnewReferee)publiconlyOwner{require(newReferee!=address(0));referee=newReferee;}

ruleId: SOLIDITY_OVERPOWERED_ROLE
patternId: j83hf7
severity: 2
line: 361
column: 4
content: functionsetMainContract(address_address)externalonlyOwner{BCFMaincandidateContract=BCFMain(_address);require(candidateContract.implementsERC721());mainContract=candidateContract;}

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 368
column: 96
content: (uint[],uint[])

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 392
column: 157
content: (uint_homeGoals,uint_awayGoals)

ruleId: SOLIDITY_SHOULD_RETURN_STRUCT
patternId: 7d54ca
severity: 1
line: 456
column: 73
content: (uint[],uint[])

ruleId: SOLIDITY_TRANSFER_IN_LOOP
patternId: 8jdj43
severity: 2
line: 621
column: 8
content: for(uinti=0;i<winners.length;i++){addresswinner=winners[i];uintpercentageCut=prizeBreakdown[i];uintwinningAmount=calculateWinnerCut(prizePool,percentageCut);winner.transfer(winningAmount);}

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 492
column: 30
content: keccak256(block.blockhash(block.number-1),seed)

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 509
column: 27
content: keccak256(seed,now,block.blockhash(block.number-1))

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 47
column: 37
content: uint256[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 267
column: 72
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 267
column: 80
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 267
column: 88
content: bool[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 283
column: 97
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 283
column: 105
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 289
column: 71
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 294
column: 25
content: uint[]cardIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 294
column: 56
content: bytesteamName

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 327
column: 41
content: uint[]cardIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 368
column: 97
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 368
column: 105
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 392
column: 81
content: uint[]homeTotals

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 392
column: 100
content: uint[]awayTotals

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 456
column: 74
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 456
column: 82
content: uint[]

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 501
column: 41
content: uint[]cardIds

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 341gim
severity: 1
line: 501
column: 57
content: uint[]shootingAttributes

SOLIDITY_OVERPOWERED_ROLE :3
SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN :4
SOLIDITY_EXTRA_GAS_IN_LOOPS :16
SOLIDITY_UPGRADE_TO_050 :20
SOLIDITY_GAS_LIMIT_IN_LOOPS :13
SOLIDITY_SHOULD_RETURN_STRUCT :3
SOLIDITY_TRANSFER_IN_LOOP :1