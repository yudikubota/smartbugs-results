/unique_chucks/16/0xb9ecee3caa88e1864b8264b18d74a267c79aa2d1.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 43ba1c
severity: 1
line: 120
column: 4
content: spins.length++

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 43ba1c
severity: 1
line: 122
column: 4
content: spins.length++

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 43ba1c
severity: 1
line: 201
column: 20
content: spins.length++

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 210
column: 10
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 187b5a
severity: 1
line: 280
column: 11
content: sha3

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 106
column: 47
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 108
column: 39
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 110
column: 46
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 134
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 149
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 156
column: 10
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 167
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 172
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 188
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 197
column: 4
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 211
column: 8
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 227
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 236
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 243
column: 6
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 252
column: 2
content: functionseconds_left()constantreturns(int){Spins=spins[spins.length-1];if(s.time_of_latest_reveal==0){return-1;}if(now>s.time_of_latest_reveal){return0;}returnint(s.time_of_latest_reveal-now);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 264
column: 2
content: functionreserved_funds()constantreturns(uint){uinttotal=locked_funds_for_revealed_spins;Spinfirst_unrevealed_spin=spins[spins.length-2];if(!first_unrevealed_spin.owner_took_too_long){total+=first_unrevealed_spin.total_payout;}Spinsecond_unrevealed_spin=spins[spins.length-1];if(!second_unrevealed_spin.owner_took_too_long){total+=second_unrevealed_spin.total_payout;}returntotal;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 279
column: 2
content: functionget_hash(uint8number,bytes32nonce)constantreturns(bytes32){returnsha3(number,nonce);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 283
column: 2
content: functionbet_this_spin()constantreturns(bool){Spins=spins[spins.length-1];returns.time_of_latest_reveal!=0;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 289
column: 2
content: functioncheck_bet(uintspin_num,addressplayer_addr,uint8spin_result)constantreturns(uint){Spins=spins[spin_num];Betb=s.bets[player_addr][spin_result];returnb.amount;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 297
column: 2
content: functioncurrent_spin_number()constantreturns(uint){returnspins.length-1;}

ruleId: SOLIDITY_MSGVALUE_EQUALS_ZERO
patternId: 1df89a
severity: 1
line: 110
column: 30
content: msg.value==0

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 106
column: 22
content: if(msg.sender!=owner)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 108
column: 20
content: if(msg.value>0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 110
column: 26
content: if(msg.value==0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 129
column: 4
content: if(second_unrevealed_spin.owner_took_too_long||spin_result>37||msg.value+second_unrevealed_spin.total_bet_on_number[spin_result]>max_bet_this_spin||msg.value*36+reserved_funds()>address(this).balance){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 148
column: 4
content: if(spin_num>=spins.length-2){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 155
column: 8
content: if(messed_up_bet.already_paid){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 165
column: 6
content: if(!at_least_one_number_paid){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 171
column: 6
content: if(b.already_paid||b.amount==0){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 187
column: 4
content: if(!(first_spin_too_long||second_spin_too_long)){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 210
column: 6
content: if(sha3(spin_result,nonce)!=first_unrevealed_spin.commit_hash||spin_result>37){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 224
column: 4
content: if(new_time_limit>2weeks){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 235
column: 4
content: if(amount>address(this).balance-reserved_funds()){throw;}

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 242
column: 4
content: if(_fraction==0){throw;}

ruleId: SOLIDITY_UNCHECKED_CALL
patternId: f39eed
severity: 3
line: 238
column: 10
content: send(amount)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 62
column: 2
content: functionplayer_make_bet(uint8spin_result)etherRequired;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 65
column: 2
content: functionplayer_collect_winnings(uintspin_num)noEther;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 70
column: 2
content: functionplayer_declare_taking_too_long()noEther;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 82
column: 2
content: functionowner_reveal_and_commit(uint8spin_result,bytes32nonce,bytes32commit_hash)onlyOwnernoEther;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 85
column: 2
content: functionowner_set_time_limit(uintnew_time_limit)onlyOwnernoEther;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 88
column: 2
content: functionowner_deposit()onlyOwneretherRequired;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 92
column: 2
content: functionowner_withdraw(uintamount)onlyOwnernoEther;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 95
column: 2
content: functionowner_set_fraction(uint_fraction)onlyOwnernoEther;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 97
column: 2
content: functionowner_transfer_ownership(addressnew_owner)onlyOwnernoEther;

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 112
column: 2
content: functionEthereumRoulette(){owner=msg.sender;fraction=800;owner_time_limit=7days;bytes32first_num_hash=0x3c81cf7279de81901303687979a6b62fdf04ec93480108d2ef38090d6135ad9f;bytes32second_num_hash=0xb1540f17822cbe4daef5f1d96662b2dc92c5f9a2411429faaf73555d3149b68e;spins.length++;spins[spins.length-1].commit_hash=first_num_hash;spins.length++;spins[spins.length-1].commit_hash=second_num_hash;max_bet_this_spin=address(this).balance/fraction;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 127
column: 2
content: functionplayer_make_bet(uint8spin_result)etherRequired{Spinsecond_unrevealed_spin=spins[spins.length-1];if(second_unrevealed_spin.owner_took_too_long||spin_result>37||msg.value+second_unrevealed_spin.total_bet_on_number[spin_result]>max_bet_this_spin||msg.value*36+reserved_funds()>address(this).balance){throw;}Betb=second_unrevealed_spin.bets[msg.sender][spin_result];b.amount+=msg.value;second_unrevealed_spin.total_bet_on_number[spin_result]+=msg.value;second_unrevealed_spin.total_payout+=msg.value*36;if(second_unrevealed_spin.time_of_latest_reveal==0){second_unrevealed_spin.time_of_latest_reveal=now+owner_time_limit;}MadeBet(msg.value,spin_result,msg.sender);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 146
column: 2
content: functionplayer_collect_winnings(uintspin_num)noEther{Spins=spins[spin_num];if(spin_num>=spins.length-2){throw;}if(s.owner_took_too_long){boolat_least_one_number_paid=false;for(uint8roulette_num=0;roulette_num<38;roulette_num++){Betmessed_up_bet=s.bets[msg.sender][roulette_num];if(messed_up_bet.already_paid){throw;}if(messed_up_bet.amount>0){msg.sender.send(messed_up_bet.amount*36);locked_funds_for_revealed_spins-=messed_up_bet.amount*36;messed_up_bet.already_paid=true;at_least_one_number_paid=true;}}if(!at_least_one_number_paid){throw;}}else{Betb=s.bets[msg.sender][s.spin_result];if(b.already_paid||b.amount==0){throw;}msg.sender.send(b.amount*36);locked_funds_for_revealed_spins-=b.amount*36;b.already_paid=true;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 180
column: 2
content: functionplayer_declare_taking_too_long()noEther{Spinfirst_unrevealed_spin=spins[spins.length-2];boolfirst_spin_too_long=first_unrevealed_spin.time_of_latest_reveal!=0&&now>first_unrevealed_spin.time_of_latest_reveal;Spinsecond_unrevealed_spin=spins[spins.length-1];boolsecond_spin_too_long=second_unrevealed_spin.time_of_latest_reveal!=0&&now>second_unrevealed_spin.time_of_latest_reveal;if(!(first_spin_too_long||second_spin_too_long)){throw;}first_unrevealed_spin.owner_took_too_long=true;second_unrevealed_spin.owner_took_too_long=true;locked_funds_for_revealed_spins+=(first_unrevealed_spin.total_payout+second_unrevealed_spin.total_payout);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 195
column: 2
content: function(){throw;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 207
column: 2
content: functionowner_reveal_and_commit(uint8spin_result,bytes32nonce,bytes32commit_hash)onlyOwnernoEther{Spinfirst_unrevealed_spin=spins[spins.length-2];if(!first_unrevealed_spin.owner_took_too_long){if(sha3(spin_result,nonce)!=first_unrevealed_spin.commit_hash||spin_result>37){throw;}first_unrevealed_spin.spin_result=spin_result;first_unrevealed_spin.nonce=nonce;locked_funds_for_revealed_spins+=first_unrevealed_spin.total_bet_on_number[spin_result]*36;Revealed(spins.length-2,spin_result);}commit(commit_hash);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 223
column: 2
content: functionowner_set_time_limit(uintnew_time_limit)onlyOwnernoEther{if(new_time_limit>2weeks){throw;}owner_time_limit=new_time_limit;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 232
column: 2
content: functionowner_deposit()onlyOwneretherRequired{}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 234
column: 2
content: functionowner_withdraw(uintamount)onlyOwnernoEther{if(amount>address(this).balance-reserved_funds()){throw;}owner.send(amount);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 241
column: 2
content: functionowner_set_fraction(uint_fraction)onlyOwnernoEther{if(_fraction==0){throw;}fraction=_fraction;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 248
column: 2
content: functionowner_transfer_ownership(addressnew_owner)onlyOwnernoEther{owner=new_owner;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 252
column: 2
content: functionseconds_left()constantreturns(int){Spins=spins[spins.length-1];if(s.time_of_latest_reveal==0){return-1;}if(now>s.time_of_latest_reveal){return0;}returnint(s.time_of_latest_reveal-now);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 264
column: 2
content: functionreserved_funds()constantreturns(uint){uinttotal=locked_funds_for_revealed_spins;Spinfirst_unrevealed_spin=spins[spins.length-2];if(!first_unrevealed_spin.owner_took_too_long){total+=first_unrevealed_spin.total_payout;}Spinsecond_unrevealed_spin=spins[spins.length-1];if(!second_unrevealed_spin.owner_took_too_long){total+=second_unrevealed_spin.total_payout;}returntotal;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 279
column: 2
content: functionget_hash(uint8number,bytes32nonce)constantreturns(bytes32){returnsha3(number,nonce);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 283
column: 2
content: functionbet_this_spin()constantreturns(bool){Spins=spins[spins.length-1];returns.time_of_latest_reveal!=0;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 289
column: 2
content: functioncheck_bet(uintspin_num,addressplayer_addr,uint8spin_result)constantreturns(uint){Spins=spins[spin_num];Betb=s.bets[player_addr][spin_result];returnb.amount;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 297
column: 2
content: functioncurrent_spin_number()constantreturns(uint){returnspins.length-1;}

SOLIDITY_VISIBILITY :26
SOLIDITY_MSGVALUE_EQUALS_ZERO :1
SOLIDITY_DEPRECATED_CONSTRUCTIONS :22
SOLIDITY_ARRAY_LENGTH_MANIPULATION :3
SOLIDITY_REVERT_REQUIRE :13
SOLIDITY_UNCHECKED_CALL :1